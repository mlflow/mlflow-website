
  

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>MLflow LangChain Flavor &mdash; MLflow 2.9.3.dev0 documentation</title>
  
   
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <link rel="canonical" href="https://mlflow.org/docs/latest/llms/langchain/index.html">
  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    

    

  
    

  

  
  
    

  

  
  
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/cards.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/grids.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/mobile.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/simple-cards.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/tabs.css" type="text/css" />
    
  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="MLflow 2.9.3.dev0 documentation" href="../../index.html"/>
        <link rel="up" title="LLMs" href="../index.html"/>
        <link rel="next" title="Introduction to Using LangChain with MLflow" href="/notebooks/langchain-quickstart.html"/>
        <link rel="prev" title="Sentence Transformers within MLflow" href="/../sentence-transformers/guide/index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>
<script type="text/javascript" src="../../_static/jquery.js"></script>
<script type="text/javascript" src="../../_static/underscore.js"></script>
<script type="text/javascript" src="../../_static/doctools.js"></script>
<script type="text/javascript" src="../../_static/languagesections.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>

<body class="wy-body-for-nav" role="document">
  

  
  <nav class="wy-nav-top header" role="navigation" aria-label="top navigation">
    <ul>
  <li class="menu-toggle">
    <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
    <a href="../../index.html" class="wy-nav-top-logo"
      ><img src="../../_static/MLflow-logo-final-black.png" alt="MLflow"
    /></a>
    <span class="version">2.9.3.dev0</span>
  </li>
</ul>
  </nav>
  <page>
    

    <nav data-toggle="wy-nav-shift" class="wy-nav-side relative">
      <div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
  </form>
</div>


    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../../index.html" class="main-navigation-home"><img src="../../_static/icons/nav-home.svg"> MLflow</a>
    

    
      

      
        <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">What is MLflow?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../getting-started/index.html">Getting Started with MLflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../new-features/index.html">New Features</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">LLMs</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#id1">MLflow Deployments Server for LLMs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#id2">LLM Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#id3">Prompt Engineering UI</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#native-mlflow-flavors-for-llms">Native MLflow Flavors for LLMs</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="../index.html#explore-the-native-llm-flavors">Explore the Native LLM Flavors</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="../transformers/index.html">MLflow Transformers Flavor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../openai/index.html">MLflow OpenAI Flavor</a></li>
<li class="toctree-l4"><a class="reference internal" href="../sentence-transformers/index.html">MLflow Sentence-Transformers Flavor</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">MLflow LangChain Flavor</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#id4">LLM Tracking in MLflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#tutorials-and-use-case-guides-for-llms-in-mlflow">Tutorials and Use Case Guides for LLMs in MLflow</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../model-evaluation/index.html">Model Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deep-learning/index.html">Deep Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../traditional-ml/index.html">Traditional ML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deployment/index.html">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tracking.html">MLflow Tracking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../system-metrics/index.html">System Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../projects.html">MLflow Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../models.html">MLflow Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../model-registry.html">MLflow Model Registry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../recipes.html">MLflow Recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plugins.html">MLflow Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auth/index.html">MLflow Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cli.html">Command-Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../search-runs.html">Search Runs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../search-experiments.html">Search Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python_api/index.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../R-api.html">R API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../java_api/index.html">Java API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rest-api.html">REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docker.html">Official MLflow Docker Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community-model-flavors.html">Community Model Flavors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials-and-examples/index.html">Tutorials and Examples</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    

    <p>
      <a id='feedbacklink' href="https://github.com/mlflow/mlflow/blob/master/CONTRIBUTING.md" target="_blank">Contribute</a>
    </p>
  </div>
</div>
    </nav>

    <main class="wy-grid-for-nav">
      <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
        <div class="wy-nav-content">
          <div class="rst-content">
            










<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
        <li><a href="../index.html">LLMs</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>MLflow LangChain Flavor</li>
    
    
    <!-- <li class="wy-breadcrumbs-aside">
      <a href="https://github.com/mlflow/mlflow/blob/master/docs/source/llms/langchain/index.rst" class="fa fa-github"> Edit on GitHub</a>
    </li> -->
    
  </ul>
</div>
            <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
              <div itemprop="articleBody">
                
  <div class="section" id="mlflow-langchain-flavor">
<h1>MLflow LangChain Flavor<a class="headerlink" href="#mlflow-langchain-flavor" title="Permalink to this headline"> </a></h1>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>The <code class="docutils literal notranslate"><span class="pre">langchain</span></code> flavor is under active development and is marked as Experimental. Public APIs are
subject to change, and new features may be added as the flavor evolves.</p>
</div>
<p>Welcome to the developer guide for the integration of <a class="reference external" href="https://www.langchain.com/">LangChain</a> with MLflow. This guide serves as a comprehensive
resource for understanding and leveraging the combined capabilities of LangChain and MLflow in developing advanced language model applications.</p>
<div class="section" id="what-is-langchain">
<h2>What is LangChain?<a class="headerlink" href="#what-is-langchain" title="Permalink to this headline"> </a></h2>
<p>LangChain is a versatile framework designed for building applications powered by language models. It excels in creating context-aware applications
that utilize language models for reasoning and generating responses, enabling the development of sophisticated NLP applications.</p>
</div>
<div class="section" id="supported-elements-in-mlflow-langchain-integration">
<h2>Supported Elements in MLflow LangChain Integration<a class="headerlink" href="#supported-elements-in-mlflow-langchain-integration" title="Permalink to this headline"> </a></h2>
<ul class="simple">
<li><p><a class="reference external" href="https://python.langchain.com/docs/modules/chains/foundational/llm_chain">LLMChain</a></p></li>
<li><p><a class="reference external" href="https://python.langchain.com/docs/modules/agents/">Agents</a></p></li>
<li><p><a class="reference external" href="https://js.langchain.com/docs/modules/chains/popular/vector_db_qa">RetrievalQA</a></p></li>
<li><p><a class="reference external" href="https://python.langchain.com/docs/modules/data_connection/retrievers/">Retrievers</a></p></li>
</ul>
</div>
<div class="section" id="why-use-mlflow-with-langchain">
<h2>Why use MLflow with LangChain?<a class="headerlink" href="#why-use-mlflow-with-langchain" title="Permalink to this headline"> </a></h2>
<p>Aside from the benefits of using MLflow for managing and deploying machine learning models, the integration of LangChain with MLflow provides a number of
benefits that are associated with using LangChain within the broader MLflow ecosystem.</p>
<ul class="simple">
<li><p><strong>MLflow Evaluate</strong>: With the native capabilities within MLflow to evaluate language models, you can easily utilize automated evaluation algorithms on the results of your LangChain application’s inference results. This integration facilitates the efficient assessment of inference results from your LangChain application, ensuring robust performance analytics.</p></li>
<li><p><strong>Simplified Experimentation</strong>: LangChain’s flexibility in experimenting with various agents, tools, and retrievers becomes even more powerful when paired with MLflow. This combination allows for rapid experimentation and iteration. You can effortlessly compare runs, making it easier to refine models and accelerate the journey from development to production deployment.</p></li>
<li><p><strong>Robust Dependency Management</strong>: Deploy your LangChain application with confidence, leveraging MLflow’s ability to manage and record all external dependencies. This ensures consistency between development and deployment environments, reducing deployment risks and simplifying the process.</p></li>
</ul>
</div>
<div class="section" id="capabilities-of-langchain-and-mlflow">
<h2>Capabilities of LangChain and MLflow<a class="headerlink" href="#capabilities-of-langchain-and-mlflow" title="Permalink to this headline"> </a></h2>
<ul class="simple">
<li><p><strong>Efficient Development</strong>: Streamline the development of NLP applications with LangChain’s modular components and MLflow’s robust tracking features.</p></li>
<li><p><strong>Flexible Integration</strong>: Leverage the versatility of LangChain within the MLflow ecosystem for a range of NLP tasks, from simple text generation to complex data retrieval and analysis.</p></li>
<li><p><strong>Advanced Functionality</strong>: Utilize LangChain’s advanced features like context-aware reasoning and dynamic action selection in agents, all within MLflow’s scalable platform.</p></li>
</ul>
</div>
<div class="section" id="overview-of-chains-agents-and-retrievers">
<h2>Overview of Chains, Agents, and Retrievers<a class="headerlink" href="#overview-of-chains-agents-and-retrievers" title="Permalink to this headline"> </a></h2>
<ul class="simple">
<li><p><strong>Chains</strong>: Sequences of actions or steps hardcoded in code. Chains in LangChain combine various components like prompts, models, and output parsers to create a flow of processing steps.</p></li>
</ul>
<p>The figure below shows an example of interfacing directly with a SaaS LLM via API calls with no context to the history of the conversation in the top portion. The
bottom portion shows the same queries being submitted to a LangChain chain that incorporates a conversation history state such that the entire conversation’s history
is included with each subsequent input. Preserving conversational context in this manner is key to creating a “chat bot”.</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="../../_images/stateful-chains.png"><img alt="The importance of stateful storage of conversation history for chat applications" src="../../_images/stateful-chains.png" style="width: 90%;" /></a>
</div>
<ul class="simple">
<li><p><strong>Agents</strong>: Dynamic constructs that use language models to choose a sequence of actions. Unlike chains, agents decide the order of actions based on inputs, tools available, and intermediate outcomes.</p></li>
</ul>
<div class="figure align-center">
<a class="reference internal image-reference" href="../../_images/langchain-agents.png"><img alt="Complex LLM queries with LangChain agents" src="../../_images/langchain-agents.png" style="width: 90%;" /></a>
</div>
<ul class="simple">
<li><p><strong>Retrievers</strong>: Components in RetrievalQA chains responsible for sourcing relevant documents or data. Retrievers are key in applications where LLMs need to reference specific external information for accurate responses.</p></li>
</ul>
<div class="figure align-center">
<a class="reference internal image-reference" href="../../_images/langchain-retrievalqa.png"><img alt="MLflow LangChain RetrievalQA architecture" src="../../_images/langchain-retrievalqa.png" style="width: 80%;" /></a>
</div>
</div>
<div class="section" id="getting-started-with-the-mlflow-langchain-flavor-tutorials-and-guides">
<h2>Getting Started with the MLflow LangChain Flavor - Tutorials and Guides<a class="headerlink" href="#getting-started-with-the-mlflow-langchain-flavor-tutorials-and-guides" title="Permalink to this headline"> </a></h2>
<div class="section" id="introductory-tutorial">
<h3>Introductory Tutorial<a class="headerlink" href="#introductory-tutorial" title="Permalink to this headline"> </a></h3>
<p>In this introductory tutorial, you will learn the most fundamental components of LangChain and how to leverage the integration with MLflow to store, retrieve, and
use a chain.</p>
<section>
    <article class="simple-grid">
        <div class="simple-card">
            <a href="notebooks/langchain-quickstart.html">
                <div class="header">
                    LangChain Quickstart
                </div>
                <p>
                    Get started with MLflow and LangChain by exploring the simplest possible chain configuration of a prompt and model chained to create
                    a single-purpose utility application.
                </p>
            </a>
        </div>
    </article>
</section><a href="https://raw.githubusercontent.com/mlflow/mlflow/master/docs/source/llms/langchain/notebooks/langchain-quickstart.ipynb" class="notebook-download-btn">Download the Introductory Notebook</a><br></div>
<div class="section" id="advanced-tutorials">
<h3>Advanced Tutorials<a class="headerlink" href="#advanced-tutorials" title="Permalink to this headline"> </a></h3>
<p>In these tutorials, you can learn about more complex usages of LangChain with MLflow. It is highly advised to read through the introductory tutorial prior to
exploring these more advanced use cases.</p>
<section>
    <article class="simple-grid">
        <div class="simple-card">
            <a href="notebooks/langchain-agent.html">
                <div class="header">
                    LangChain Agents
                </div>
                <p>
                    Learn how to build a LangChain agent that can query a web search engine and perform calculations based on complex questions using MLflow.
                </p>
            </a>
        </div>
        <div class="simple-card">
            <a href="notebooks/langchain-retriever.html">
                <div class="header">
                    RAG tutorial with LangChain
                </div>
                <p>
                    Learn how to build a LangChain RAG with MLflow integration to answer highly specific questions about the legality of business ventures.
                </p>
            </a>
        </div>
    </article>
</section><a href="https://raw.githubusercontent.com/mlflow/mlflow/master/docs/source/llms/langchain/notebooks/langchain-agent.ipynb" class="notebook-download-btn">Download the LangChain Agents Notebook</a><br>
<a href="https://raw.githubusercontent.com/mlflow/mlflow/master/docs/source/llms/langchain/notebooks/langchain-retriever.ipynb" class="notebook-download-btn">Download the LangChain Retriever Notebook</a><br><div class="toctree-wrapper compound">
</div>
</div>
</div>
<div class="section" id="id1">
<h2><a class="reference external" href="guide/index.html">Detailed Documentation</a><a class="headerlink" href="#id1" title="Permalink to this headline"> </a></h2>
<p>To learn more about the details of the MLflow LangChain flavor, read the detailed guide below.</p>
<a href="guide/index.html" class="download-btn">View the Comprehensive Guide</a><div class="toctree-wrapper compound">
</div>
</div>
<div class="section" id="faq">
<h2>FAQ<a class="headerlink" href="#faq" title="Permalink to this headline"> </a></h2>
<div class="section" id="i-can-t-save-my-chain-agent-or-retriever-with-mlflow">
<h3>I can’t save my chain, agent, or retriever with MLflow.<a class="headerlink" href="#i-can-t-save-my-chain-agent-or-retriever-with-mlflow" title="Permalink to this headline"> </a></h3>
<ul>
<li><p><strong>Serialization Challenges with Cloudpickle</strong>: Serialization with cloudpickle can encounter limitations depending on the complexity of the objects.</p>
<blockquote>
<div><p>Some objects, especially those with intricate internal states or dependencies on external system resources, are not inherently pickleable. This limitation
arises because serialization essentially requires converting an object to a byte stream, which can be complex for objects tightly coupled with system states
or those having external I/O operations.</p>
</div></blockquote>
</li>
<li><p><strong>Verifying Native Serialization Support</strong>: Ensure that the langchain object (chain, agent, or retriever) is serializable natively using langchain APIs if saving or logging with MLflow doesn’t work.</p>
<blockquote>
<div><p>Due to their complex structures, not all langchain components are readily serializable. If native serialization
is not supported and MLflow doesn’t support saving the model, you can file an issue <a class="reference external" href="https://github.com/langchain-ai/langchain/issues">in the LangChain repository</a> or
ask for guidance in the <a class="reference external" href="https://github.com/langchain-ai/langchain/discussions">LangChain Discussions board</a>.</p>
</div></blockquote>
</li>
<li><p><strong>Keeping Up with New Features in MLflow</strong>: MLflow might not immediately support the latest LangChain features immediately.</p>
<blockquote>
<div><p>If a new feature is not supported in MLflow, consider <a class="reference external" href="https://github.com/mlflow/mlflow/issues">filing a feature request on the MLflow GitHub issues page</a>.</p>
</div></blockquote>
</li>
</ul>
</div>
<div class="section" id="i-m-getting-an-attributeerror-when-saving-my-model">
<h3>I’m getting an AttributeError when saving my model<a class="headerlink" href="#i-m-getting-an-attributeerror-when-saving-my-model" title="Permalink to this headline"> </a></h3>
<ul>
<li><p><strong>Handling Dependency Installation in LangChain and MLflow</strong>: LangChain and MLflow do not automatically install all dependencies.</p>
<blockquote>
<div><p>Other packages that might be required for specific agents, retrievers, or tools may need to be explicitly defined when saving or logging your model.
If your model relies on these external component libraries (particularly for tools) that not included in the standard LangChain package, these dependencies
will not be automatically logged as part of the model at all times (see below for guidance on how to include them).</p>
</div></blockquote>
</li>
<li><p><strong>Declaring Extra Dependencies</strong>: Use the <code class="docutils literal notranslate"><span class="pre">extra_pip_requirements</span></code> parameter when saving and logging.</p>
<blockquote>
<div><p>When saving or logging your model that contains external dependencies that are not part of the core langchain installation, you will need these additional
dependencies. The model flavor contains two options for declaring these dependencies: <code class="docutils literal notranslate"><span class="pre">extra_pip_requirements</span></code> and <code class="docutils literal notranslate"><span class="pre">pip_requirements</span></code>. While specifying
<code class="docutils literal notranslate"><span class="pre">pip_requirements</span></code> is entirely valid, we recommend using <code class="docutils literal notranslate"><span class="pre">extra_pip_requirements</span></code> as it does not rely on defining all of the core dependent packages that
are required to use the langchain model for inference (the other core dependencies will be inferred automatically).</p>
</div></blockquote>
</li>
</ul>
</div>
</div>
</div>


              </div>
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../sentence-transformers/guide/index.html" class="btn btn-neutral" title="Sentence Transformers within MLflow" accesskey="p"><span class="db-icon db-icon-chevron-left"></span> Previous</a>
      
      
        <a href="notebooks/langchain-quickstart.html" class="btn btn-neutral" title="Introduction to Using LangChain with MLflow" accesskey="n">Next <span class="db-icon db-icon-chevron-right"></span></a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
      <p class="copyright">
          &copy; MLflow Project, a Series of LF Projects, LLC. All rights reserved.
      </p>

  </div> 

</footer>
          </div>
        </div>
      </section>
    </main>
  </page>

  


  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT:'../../',
      VERSION:'2.9.3.dev0',
      COLLAPSE_INDEX:false,
      FILE_SUFFIX:'.html',
      LINK_SUFFIX: '.html',
      HAS_SOURCE:  true
    };
  </script>

  

  <script type="text/javascript" src="../../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../../_static/js/jquery.waypoints.min.js"></script>

  
  
  
  <script type="text/javascript">var CLIPPY_SVG_PATH = "../../_static/clippy.svg";</script>
  <script type="text/javascript" src="../../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  

  
  <script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
        function copyToClipboard(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
        }
        // Get the code block designator class entries
        const allHighlights = document.querySelectorAll('.highlight');
        // Disable copyable links for notebook cell numbering and for cell outputs
        const highlights = Array.from(allHighlights).filter(highlight => !highlight.closest('.highlight-none') && 
            !highlight.closest('.nboutput'));
    
        highlights.forEach(function(highlight) {
            const copyIcon = document.createElement('span');
            copyIcon.classList.add('copy-icon');
            copyIcon.innerHTML = '&#xf0ea;';

            copyIcon.addEventListener('click', function() {
                const code = highlight.querySelector('pre').textContent;
                copyToClipboard(code);

                // Flash effect on click
                this.style.color = '#0194E2';
                setTimeout(() => {
                    this.style.color = ''; 
                }, 100);

                // Display "Code copied to clipboard" near the clicked icon
                const message = document.createElement('span');
                message.textContent = "Copied!";
                message.classList.add('copy-message'); 

                // Append the message to the icon
                this.appendChild(message);

                setTimeout(() => {
                    this.removeChild(message);
                }, 500);
            });

            highlight.appendChild(copyIcon);
        });
    });
  </script>


<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
        // Force download for notebook-download-btn
        const downloadButtons = document.querySelectorAll('.notebook-download-btn');
        downloadButtons.forEach(function(button) {
            button.addEventListener('click', function(event) {
                event.preventDefault(); // Prevent default behavior

                // Fetch the raw content of the notebook from GitHub
                fetch(button.href)
                    .then(response => response.blob())
                    .then(blob => {
                        const url = window.URL.createObjectURL(blob);
                        const link = document.createElement('a');
                        link.style.display = 'none';
                        link.href = url;
                        const filename = button.href.split('/').pop();
                        link.download = filename; 

                        document.body.appendChild(link);
                        link.click();

                        window.URL.revokeObjectURL(url);
                        document.body.removeChild(link);
                    })
                    .catch(err => console.error('Error fetching the notebook:', err));
            });
        });
    });
</script> 
</body>
</html>