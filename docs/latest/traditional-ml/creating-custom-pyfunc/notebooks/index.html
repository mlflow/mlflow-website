<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-traditional-ml/creating-custom-pyfunc/notebooks/index" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Custom PyFuncs with MLflow - Notebooks | MLflow</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mlflow.org/docs/latest/traditional-ml/creating-custom-pyfunc/notebooks/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Custom PyFuncs with MLflow - Notebooks | MLflow"><meta data-rh="true" name="description" content="If you would like to view the notebooks in this guide in their entirety, each notebook can viewed or downloaded directly below."><meta data-rh="true" property="og:description" content="If you would like to view the notebooks in this guide in their entirety, each notebook can viewed or downloaded directly below."><link data-rh="true" rel="icon" href="/docs/latest/images/favicon.ico"><link data-rh="true" rel="canonical" href="https://mlflow.org/docs/latest/traditional-ml/creating-custom-pyfunc/notebooks/"><link data-rh="true" rel="alternate" href="https://mlflow.org/docs/latest/traditional-ml/creating-custom-pyfunc/notebooks/" hreflang="en"><link data-rh="true" rel="alternate" href="https://mlflow.org/docs/latest/traditional-ml/creating-custom-pyfunc/notebooks/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://XKVLO8P882-dsn.algolia.net" crossorigin="anonymous"><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=GTM-N6WMTTJ"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","GTM-N6WMTTJ",{anonymize_ip:!0}),gtag("config","AW-16857946923",{anonymize_ip:!0})</script>
<link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var g=t.getElementsByTagName(a)[0],m=t.createElement(a);m.async=!0,m.src="https://www.googletagmanager.com/gtm.js?id=GTM-N6WMTTJ",g.parentNode.insertBefore(m,g)}(window,document,"script","dataLayer")</script>



<link rel="search" type="application/opensearchdescription+xml" title="MLflow" href="/docs/latest/opensearch.xml">

<script src="/docs/latest/js/runllm.js" defer="defer"></script><link rel="stylesheet" href="/docs/latest/assets/css/styles.504e3d8b.css">
<script src="/docs/latest/assets/js/runtime~main.5af5e8cd.js" defer="defer"></script>
<script src="/docs/latest/assets/js/main.8cf08d89.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-N6WMTTJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>


<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/latest/"><div class="navbar__logo"><img src="/docs/latest/images/logo-light.svg" alt="MLflow Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docs/latest/images/logo-dark.svg" alt="MLflow Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/latest/">Docs</a><a href="https://mlflow.org/docs/latest/api_reference/index.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API Reference</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/mlflow/mlflow" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-top-level-category"><a class="menu__link" href="/docs/latest/">MLflow</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/latest/mlflow-3/">MLflow 3.0</a><button aria-label="Expand sidebar category &#x27;MLflow 3.0&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/latest/getting-started/">Getting Started</a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item sidebar-top-level-category"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/docs/latest/llms/">Machine Learning 🧠</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/latest/llms/">LLM / GenAI</a><button aria-label="Expand sidebar category &#x27;LLM / GenAI&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/latest/deep-learning/">Deep Learning</a><button aria-label="Expand sidebar category &#x27;Deep Learning&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/latest/traditional-ml/">Traditional ML</a><button aria-label="Collapse sidebar category &#x27;Traditional ML&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/latest/traditional-ml/">Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/latest/traditional-ml/hyperparameter-tuning-with-child-runs/">Hyperparameter Tuning with MLflow and Optuna</a><button aria-label="Expand sidebar category &#x27;Hyperparameter Tuning with MLflow and Optuna&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/latest/traditional-ml/creating-custom-pyfunc/">Building Custom Python Function Models with MLflow</a><button aria-label="Collapse sidebar category &#x27;Building Custom Python Function Models with MLflow&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/latest/traditional-ml/creating-custom-pyfunc/part1-named-flavors/">Models, Flavors, and PyFuncs in MLflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/latest/traditional-ml/creating-custom-pyfunc/part2-pyfunc-components/">Understanding PyFunc in MLflow</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible menu__list-item-collapsible--active"><a class="menu__link menu__link--sublist menu__link--active" aria-current="page" tabindex="0" href="/docs/latest/traditional-ml/creating-custom-pyfunc/notebooks/">Full Notebooks</a><button aria-label="Collapse sidebar category &#x27;Full Notebooks&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/latest/traditional-ml/creating-custom-pyfunc/notebooks/basic-pyfunc">Introduction to MLflow Custom Pyfunc</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/latest/traditional-ml/creating-custom-pyfunc/notebooks/introduction">Creating a Custom Model: &quot;Add N&quot; Model</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/latest/traditional-ml/creating-custom-pyfunc/notebooks/override-predict">Customizing a Model&#x27;s predict method</a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/latest/traditional-ml/serving-multiple-models-with-pyfunc/">Serving Multiple Models on a Single Endpoint with a Custom PyFunc Model</a><button aria-label="Expand sidebar category &#x27;Serving Multiple Models on a Single Endpoint with a Custom PyFunc Model&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item sidebar-top-level-category"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/docs/latest/tracking/">Build 🔨 </a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/latest/tracking/">MLflow Tracking</a><button aria-label="Expand sidebar category &#x27;MLflow Tracking&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/latest/model/">MLflow Model</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/latest/prompts/">MLflow Prompts 🆕</a></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item sidebar-top-level-category"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/docs/latest/model-evaluation/">Evaluate &amp; Monitor 📊</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/latest/model-evaluation/">MLflow Evaluation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/latest/tracing/">MLflow Tracing (Observability)</a><button aria-label="Expand sidebar category &#x27;MLflow Tracing (Observability)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/latest/dataset/">MLflow Dataset</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item sidebar-top-level-category"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/docs/latest/model-registry/">Deploy 🚀</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/latest/model-registry/">MLflow Model Registry</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/latest/deployment/">MLflow Serving</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/docs/latest/llms/deployments/">MLflow AI Gateway</a><button aria-label="Expand sidebar category &#x27;MLflow AI Gateway&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/latest/tracking/#tracking-setup">Team Collaboration 👥</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class="menu__list-item-collapsible"><a href="https://mlflow.org/docs/latest/api_reference/python_api/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false">API References</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class="menu__list-item-collapsible"><a href="https://github.com/mlflow/mlflow/blob/master/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false">More</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/latest/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Machine Learning 🧠</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/latest/traditional-ml/"><span itemprop="name">Traditional ML</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/latest/traditional-ml/creating-custom-pyfunc/"><span itemprop="name">Building Custom Python Function Models with MLflow</span></a><meta itemprop="position" content="3"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Full Notebooks</span><meta itemprop="position" content="4"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Custom PyFuncs with MLflow - Notebooks</h1></header>
<p>If you would like to view the notebooks in this guide in their entirety, each notebook can viewed or downloaded directly below.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="basics-of-creating-a-custom-python-model-with-mlflows-pyfunc">Basics of Creating a Custom Python Model with MLflow&#x27;s Pyfunc<a href="#basics-of-creating-a-custom-python-model-with-mlflows-pyfunc" class="hash-link" aria-label="Direct link to Basics of Creating a Custom Python Model with MLflow&#x27;s Pyfunc" title="Direct link to Basics of Creating a Custom Python Model with MLflow&#x27;s Pyfunc">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="introduction">Introduction<a href="#introduction" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h3>
<p>In this initial tutorial, we&#x27;ll introduce you to the foundational concepts of MLflow&#x27;s <em>pyfunc</em>. We&#x27;ll illustrate the simplicity and
adaptability of creating, saving, and invoking a custom Python function model within the MLflow ecosystem. By the end, you&#x27;ll have a
hands-on understanding of a model that adds a specified numeric value to DataFrame columns, highlighting the innate flexibility
of the <em>pyfunc</em> flavor.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-you-will-learn">What you will learn<a href="#what-you-will-learn" class="hash-link" aria-label="Direct link to What you will learn" title="Direct link to What you will learn">​</a></h3>
<ul>
<li><strong>Simplicity of Custom PyFunc Models</strong>: Grasp the basic structure of the <em>PythonModel</em> class and how it forms the backbone of custom models in MLflow.</li>
<li><strong>Model Persistence</strong>: Understand the straightforward process of saving and retrieving custom models.</li>
<li><strong>Invoking Predictions</strong>: Learn the mechanics of how to use a loaded custom <em>pyfunc</em> model for predictions.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-by-step-guide">Step-by-step Guide<a href="#step-by-step-guide" class="hash-link" aria-label="Direct link to Step-by-step Guide" title="Direct link to Step-by-step Guide">​</a></h3>
<ol>
<li><strong>Model Definition</strong>: Begin by crafting a Python class encapsulating the logic for our straightforward &quot;Add N&quot; model.</li>
<li><strong>Persisting the Model</strong>: Use MLflow&#x27;s capabilities to save the defined model, ensuring it can be retrieved later.</li>
<li><strong>Model Retrieval</strong>: Load the model from its saved location and prepare it for predictions.</li>
<li><strong>Model Evaluation</strong>: Use the retrieved model on sample data to witness its functionality.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="wrap-up">Wrap Up<a href="#wrap-up" class="hash-link" aria-label="Direct link to Wrap Up" title="Direct link to Wrap Up">​</a></h3>
<p>By the conclusion of this tutorial, you&#x27;ll appreciate the ease and consistency that MLflow&#x27;s custom <em>pyfunc</em> offers, even for the simplest of models. It sets the stage for more advanced functionalities and use-cases you might explore in subsequent tutorials.</p>
<a class="button button--primary" href="/docs/latest/traditional-ml/creating-custom-pyfunc/notebooks/introduction"><span>View the Notebook</span></a>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="building-a-basic-custom-python-model">Building a Basic Custom Python Model<a href="#building-a-basic-custom-python-model" class="hash-link" aria-label="Direct link to Building a Basic Custom Python Model" title="Direct link to Building a Basic Custom Python Model">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="introduction-1">Introduction<a href="#introduction-1" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h3>
<p>In this tutorial, we deepen our understanding of MLflow&#x27;s Custom Pyfunc. The <code>PythonModel</code> class serves as the cornerstone, allowing
you to define, save, load, and predict using custom PyFunc models.
We&#x27;ll be developing a very non-standard model; one that generates plotted figures in order to showcase the flexibility of custom PyFunc models.
By the end, we&#x27;ll have a functional Lissajous curve generator, wrapped and managed within the Pyfunc framework.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-you-will-learn-1">What you will learn<a href="#what-you-will-learn-1" class="hash-link" aria-label="Direct link to What you will learn" title="Direct link to What you will learn">​</a></h3>
<ul>
<li><strong>Defining Custom PyFunc Models</strong>: Explore the structure of the <code>PythonModel</code> class and its essential methods.</li>
<li><strong>Understanding Pyfunc Components</strong>: Get acquainted with the foundational building blocks of the Pyfunc flavor.</li>
<li><strong>Saving and Loading Models</strong>: Experience the seamless integration of MLflow&#x27;s storage and retrieval capabilities.</li>
<li><strong>Predicting with Custom Logic</strong>: Interface with the loaded custom Pyfunc to generate interesting Lissajous curve plots.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="the-pythonmodel-class">The <code>PythonModel</code> class<a href="#the-pythonmodel-class" class="hash-link" aria-label="Direct link to the-pythonmodel-class" title="Direct link to the-pythonmodel-class">​</a></h3>
<p>MLflow&#x27;s commitment to flexibility and standardization shines through the <code>PythonModel</code> class. This class, crucial to the Pyfunc
flavor, provides the necessary scaffolding to define custom logic, load resources, and make predictions.</p>
<p>There are two primary ways to create an instance of the PythonModel:</p>
<ol>
<li><strong>Class-based approach</strong>: Define a class with necessary methods and use it as a blueprint for the model.</li>
<li><strong>Function-based approach</strong>: Capture the entire prediction logic within a single function, letting MLflow handle the rest.</li>
</ol>
<p>For this tutorial, we&#x27;ll focus on the class-based approach, delving into methods like <code>load_context</code> and <code>predict</code> and
understanding their roles in the larger ecosystem.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="lissajous-curves">Lissajous Curves<a href="#lissajous-curves" class="hash-link" aria-label="Direct link to Lissajous Curves" title="Direct link to Lissajous Curves">​</a></h3>
<p>As our vehicle for understanding, we&#x27;ll employ the Lissajous curves – sinusoidal parametric curves whose shapes and orientations are
determined by their parameters. Instead of a conventional machine learning model, this mathematical curve will demonstrate the versatility
and power of the Pyfunc flavor.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-by-step-guide-1">Step-by-step Guide<a href="#step-by-step-guide-1" class="hash-link" aria-label="Direct link to Step-by-step Guide" title="Direct link to Step-by-step Guide">​</a></h3>
<ol>
<li><strong>Define the Custom PyFunc Model</strong>: We start by creating a Python class encapsulating the logic for generating Lissajous curves.</li>
<li><strong>Save the Model</strong>: With the model defined, we leverage MLflow&#x27;s capabilities to save it, ensuring future reproducibility.</li>
<li><strong>Load the Model</strong>: Retrieve the model from storage and prepare it for predictions.</li>
<li><strong>Generate Curves</strong>: Use the loaded model to create and visualize Lissajous curves, showcasing the end-to-end capabilities of the Pyfunc flavor.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="wrap-up-1">Wrap Up<a href="#wrap-up-1" class="hash-link" aria-label="Direct link to Wrap Up" title="Direct link to Wrap Up">​</a></h3>
<p>With a practical example under our belt, the power and flexibility of MLflow&#x27;s Custom Pyfunc are evident. Whether you&#x27;re working with
traditional machine learning models or unique use cases like the Lissajous curve generator, Pyfunc ensures a standardized, reproducible,
and efficient workflow.</p>
<a class="button button--primary" href="/docs/latest/traditional-ml/creating-custom-pyfunc/notebooks/basic-pyfunc"><span>View the Notebook</span></a>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="overriding-a-models-prediction-method">Overriding a model&#x27;s prediction method<a href="#overriding-a-models-prediction-method" class="hash-link" aria-label="Direct link to Overriding a model&#x27;s prediction method" title="Direct link to Overriding a model&#x27;s prediction method">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="introduction-2">Introduction<a href="#introduction-2" class="hash-link" aria-label="Direct link to Introduction" title="Direct link to Introduction">​</a></h3>
<p>Diving deeper into the realm of custom PyFuncs with MLflow, this tutorial addresses a common challenge in model deployment: retaining and
customizing the behavior of a model&#x27;s prediction method after serialization and deployment. Leveraging the power of MLflow&#x27;s PyFunc flavor,
we&#x27;ll learn how to override the default <em>predict</em> behavior, ensuring our model retains all its original capabilities when deployed in
different environments.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="what-you-will-learn-2">What you will learn<a href="#what-you-will-learn-2" class="hash-link" aria-label="Direct link to What you will learn" title="Direct link to What you will learn">​</a></h3>
<ul>
<li><strong>The Challenge with Default PyFuncs</strong>: Recognize the limitations of default PyFunc behavior with complex models, especially when methods other than <em>predict</em> are vital.</li>
<li><strong>Customizing Predict Method</strong>: Discover the technique to override the default <em>predict</em> method, enabling the support of various prediction methodologies.</li>
<li><strong>Harnessing Joblib with PyFunc</strong>: Understand why <em>joblib</em> is preferred over <em>pickle</em> for serializing scikit-learn models and how to integrate it with PyFunc.</li>
<li><strong>Dynamic Prediction with Params</strong>: Learn to make the <em>predict</em> method more versatile by accepting parameters that dictate the type of prediction.</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="why-override-predict">Why Override <em>predict</em>?<a href="#why-override-predict" class="hash-link" aria-label="Direct link to why-override-predict" title="Direct link to why-override-predict">​</a></h3>
<p>Models, especially in libraries like scikit-learn, often come with multiple methods for prediction, such as <em>predict</em>, <em>predict_proba</em>, and <em>predict_log_proba</em>.
When deploying such models, it&#x27;s essential to retain the flexibility to choose the prediction methodology dynamically. This section sheds light
on the need for such flexibility and the challenges with default PyFunc deployments.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="creating-a-custom-pyfunc">Creating a Custom PyFunc<a href="#creating-a-custom-pyfunc" class="hash-link" aria-label="Direct link to Creating a Custom PyFunc" title="Direct link to Creating a Custom PyFunc">​</a></h3>
<p>Venturing into the solution, we craft a custom PyFunc by extending MLflow&#x27;s <em>PythonModel</em>. This custom class serves as a wrapper around the
original model, providing a flexible <em>predict</em> method that can mimic the behavior of various original methods based on provided parameters.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="step-by-step-guide-2">Step-by-step Guide<a href="#step-by-step-guide-2" class="hash-link" aria-label="Direct link to Step-by-step Guide" title="Direct link to Step-by-step Guide">​</a></h3>
<ol>
<li><strong>Prepare a Basic Model</strong>: Use the Iris dataset to create a simple Logistic Regression model, illustrating the different prediction methods.</li>
<li><strong>Challenges with Default Deployment</strong>: Recognize the limitations when deploying the model as a default PyFunc.</li>
<li><strong>Crafting the Custom PyFunc</strong>: Design a ModelWrapper class that can dynamically switch between prediction methods.</li>
<li><strong>Saving and Loading the Custom Model</strong>: Integrate with MLflow to save the custom PyFunc and load it for predictions.</li>
<li><strong>Dynamic Predictions</strong>: Test the loaded model, ensuring it supports all original prediction methods.</li>
</ol>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="wrap-up-2">Wrap Up<a href="#wrap-up-2" class="hash-link" aria-label="Direct link to Wrap Up" title="Direct link to Wrap Up">​</a></h3>
<p>Overcoming the challenges of default deployments, this tutorial showcases the prowess of custom PyFuncs in MLflow. The ability to override and
customize prediction methods ensures that our deployed models remain as versatile and capable as their original incarnations. As ML workflows
grow in complexity, such customization becomes invaluable, ensuring our deployments are robust and adaptable.</p>
<a class="button button--primary" href="/docs/latest/traditional-ml/creating-custom-pyfunc/notebooks/override-predict"><span>View the Notebook</span></a>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="run-the-notebooks-in-your-environment">Run the Notebooks in your Environment<a href="#run-the-notebooks-in-your-environment" class="hash-link" aria-label="Direct link to Run the Notebooks in your Environment" title="Direct link to Run the Notebooks in your Environment">​</a></h2>
<p>Additionally, if you would like to download a copy locally to run in your own environment, you can download by
clicking the respective links to each notebook in this guide:</p>
<a class="button button--primary" style="margin-bottom:1rem;display:block;width:min-content" href="https://raw.githubusercontent.com/mlflow/mlflow/master/docs/source/traditional-ml/creating-custom-pyfunc/notebooks/introduction.ipynb" download="">Download the Introduction notebook</a>
<br>
<br>
<a class="button button--primary" style="margin-bottom:1rem;display:block;width:min-content" href="https://raw.githubusercontent.com/mlflow/mlflow/master/docs/source/traditional-ml/creating-custom-pyfunc/notebooks/basic-pyfunc.ipynb" download="">Download the Basic Pyfunc notebook</a>
<br>
<br>
<a class="button button--primary" style="margin-bottom:1rem;display:block;width:min-content" href="https://raw.githubusercontent.com/mlflow/mlflow/master/docs/source/traditional-ml/creating-custom-pyfunc/notebooks/override-predict.ipynb" download="">Download the Predict Override notebook</a>
<br>
<br>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>In order to run the notebooks, please ensure that you either have a local MLflow Tracking Server started or modify the
<code>mlflow.set_tracking_uri()</code> values to point to a running instance of the MLflow Tracking Server. In order to interact with
the MLflow UI, ensure that you are either running the UI server locally or have a configured deployed MLflow UI server that
you are able to access.</p></div></div></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/latest/traditional-ml/creating-custom-pyfunc/part2-pyfunc-components/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Understanding PyFunc in MLflow</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/latest/traditional-ml/creating-custom-pyfunc/notebooks/basic-pyfunc"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Introduction to MLflow Custom Pyfunc</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#basics-of-creating-a-custom-python-model-with-mlflows-pyfunc" class="table-of-contents__link toc-highlight">Basics of Creating a Custom Python Model with MLflow&#39;s Pyfunc</a><ul><li><a href="#introduction" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#what-you-will-learn" class="table-of-contents__link toc-highlight">What you will learn</a></li><li><a href="#step-by-step-guide" class="table-of-contents__link toc-highlight">Step-by-step Guide</a></li><li><a href="#wrap-up" class="table-of-contents__link toc-highlight">Wrap Up</a></li></ul></li><li><a href="#building-a-basic-custom-python-model" class="table-of-contents__link toc-highlight">Building a Basic Custom Python Model</a><ul><li><a href="#introduction-1" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#what-you-will-learn-1" class="table-of-contents__link toc-highlight">What you will learn</a></li><li><a href="#the-pythonmodel-class" class="table-of-contents__link toc-highlight">The <code>PythonModel</code> class</a></li><li><a href="#lissajous-curves" class="table-of-contents__link toc-highlight">Lissajous Curves</a></li><li><a href="#step-by-step-guide-1" class="table-of-contents__link toc-highlight">Step-by-step Guide</a></li><li><a href="#wrap-up-1" class="table-of-contents__link toc-highlight">Wrap Up</a></li></ul></li><li><a href="#overriding-a-models-prediction-method" class="table-of-contents__link toc-highlight">Overriding a model&#39;s prediction method</a><ul><li><a href="#introduction-2" class="table-of-contents__link toc-highlight">Introduction</a></li><li><a href="#what-you-will-learn-2" class="table-of-contents__link toc-highlight">What you will learn</a></li><li><a href="#why-override-predict" class="table-of-contents__link toc-highlight">Why Override <em>predict</em>?</a></li><li><a href="#creating-a-custom-pyfunc" class="table-of-contents__link toc-highlight">Creating a Custom PyFunc</a></li><li><a href="#step-by-step-guide-2" class="table-of-contents__link toc-highlight">Step-by-step Guide</a></li><li><a href="#wrap-up-2" class="table-of-contents__link toc-highlight">Wrap Up</a></li></ul></li><li><a href="#run-the-notebooks-in-your-environment" class="table-of-contents__link toc-highlight">Run the Notebooks in your Environment</a></li></ul></div></div></div></div></main></div></div></div><footer class="footer"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/mlflow" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.linkedin.com/company/mlflow-org" target="_blank" rel="noopener noreferrer" class="footer__link-item">LinkedIn<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://x.com/mlflow" target="_blank" rel="noopener noreferrer" class="footer__link-item">X<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">Resources</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/latest/">Docs</a></li><li class="footer__item"><a href="https://mlflow.org/releases" target="_blank" rel="noopener noreferrer" class="footer__link-item">Releases</a></li><li class="footer__item"><a href="https://mlflow.org/blog" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 MLflow Project, a Series of LF Projects, LLC.</div></div></div></footer></div>
</body>
</html>