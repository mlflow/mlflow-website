

<!DOCTYPE html>
<!-- source: docs/source/search-runs.rst -->
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Search Runs</title>
  
   
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <link rel="canonical" href="https://mlflow.org/docs/latest/search-runs.html">
  
  
    <link rel="shortcut icon" href="_static/favicon.ico"/>
    

    

  
    
        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer',"GTM-N6WMTTJ");</script>
        <!-- End Google Tag Manager -->
    

  

  
  
    

  

  
  
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600" rel="stylesheet">
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="_static/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="_static/css/cards.css" type="text/css" />
    <link rel="stylesheet" href="_static/css/grids.css" type="text/css" />
    <link rel="stylesheet" href="_static/css/mobile.css" type="text/css" />
    <link rel="stylesheet" href="_static/css/simple-cards.css" type="text/css" />
    <link rel="stylesheet" href="_static/css/tabs.css" type="text/css" />
    
  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="MLflow 2.17.1.dev0 documentation" href="index.html"/>
        <link rel="next" title="Search Experiments" href="/search-experiments.html"/>
        <link rel="prev" title="Command-Line Interface" href="/cli.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>
<script type="text/javascript" src="_static/jquery.js"></script>
<script type="text/javascript" src="_static/underscore.js"></script>
<script type="text/javascript" src="_static/doctools.js"></script>
<script type="text/javascript" src="_static/languagesections.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>
<script type="text/javascript" src="_static/runllm.js"></script>

<body class="wy-body-for-nav" role="document">
  
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-N6WMTTJ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
  

  
  <nav class="wy-nav-top header" role="navigation" aria-label="top navigation">
    <ul>
  <li class="menu-toggle">
    <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
    <a href="index.html" class="wy-nav-top-logo"
      ><img src="_static/MLflow-logo-final-black.png" alt="MLflow"
    /></a>
    <span class="version">2.17.1.dev0</span>
  </li>
</ul>
  </nav>
  <page>
    

    <nav data-toggle="wy-nav-shift" class="wy-nav-side relative">
      <div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
  </form>
</div>


    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="index.html" class="main-navigation-home"><img src="_static/icons/nav-home.svg"> MLflow</a>
    

    
      

      
        <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction/index.html">MLflow Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="getting-started/index.html">Getting Started with MLflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="new-features/index.html">New Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="llms/index.html">LLMs</a></li>
<li class="toctree-l1"><a class="reference internal" href="llms/tracing/index.html">MLflow Tracing</a></li>
<li class="toctree-l1"><a class="reference internal" href="model-evaluation/index.html">Model Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="deep-learning/index.html">Deep Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="traditional-ml/index.html">Traditional ML</a></li>
<li class="toctree-l1"><a class="reference internal" href="deployment/index.html">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="tracking.html">MLflow Tracking</a></li>
<li class="toctree-l1"><a class="reference internal" href="system-metrics/index.html">System Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="projects.html">MLflow Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="models.html">MLflow Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="model-registry.html">MLflow Model Registry</a></li>
<li class="toctree-l1"><a class="reference internal" href="recipes.html">MLflow Recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">MLflow Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="auth/index.html">MLflow Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="cli.html">Command-Line Interface</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Search Runs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#search-runs-on-mlflow-ui">Search Runs on MLflow UI</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#create-example-mlflow-runs">Create Example MLflow Runs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#search-query-example">Search Query Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#search-syntax-overview">Search Syntax Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#search-query-syntax-deep-dive">Search Query Syntax Deep Dive</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-queries">Example Queries</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#searching-by-metrics">1 - Searching By Metrics</a></li>
<li class="toctree-l4"><a class="reference internal" href="#searching-by-params">2 - Searching By Params</a></li>
<li class="toctree-l4"><a class="reference internal" href="#searching-by-tags">3 - Searching By Tags</a></li>
<li class="toctree-l4"><a class="reference internal" href="#searching-by-dataset-information">4 - Searching By Dataset Information</a></li>
<li class="toctree-l4"><a class="reference internal" href="#searching-by-run-s-metadata">5 - Searching By Run’s Metadata</a></li>
<li class="toctree-l4"><a class="reference internal" href="#searching-over-a-set">6 - Searching over a Set</a></li>
<li class="toctree-l4"><a class="reference internal" href="#chained-queries">7 - Chained Queries</a></li>
<li class="toctree-l4"><a class="reference internal" href="#non-none-queries">8 - Non-None Queries</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#programmatically-searching-runs">Programmatically Searching Runs</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#python">Python</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#complex-filter">1 - Complex Filter</a></li>
<li class="toctree-l4"><a class="reference internal" href="#run-view-type">2 - <cite>run_view_type</cite></a></li>
<li class="toctree-l4"><a class="reference internal" href="#ordering">2 - Ordering</a></li>
<li class="toctree-l4"><a class="reference internal" href="#searching-all-experiments">3 - Searching All Experiments</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#r">R</a></li>
<li class="toctree-l3"><a class="reference internal" href="#java">Java</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="search-experiments.html">Search Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="python_api/index.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="R-api.html">R API</a></li>
<li class="toctree-l1"><a class="reference internal" href="java_api/index.html">Java API</a></li>
<li class="toctree-l1"><a class="reference internal" href="rest-api.html">REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="docker.html">Official MLflow Docker Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="community-model-flavors.html">Community Model Flavors</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials-and-examples/index.html">Tutorials and Examples</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    

    <p>
      <a id='feedbacklink' href="https://github.com/mlflow/mlflow/blob/master/CONTRIBUTING.md" target="_blank">Contribute</a>
    </p>
  </div>
</div>
    </nav>

    <main class="wy-grid-for-nav">
      <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
        <div class="wy-nav-content">
          <div class="rst-content">
            










<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>Search Runs</li>
    
    
    <!-- <li class="wy-breadcrumbs-aside">
      <a href="https://github.com/mlflow/mlflow/blob/master/docs/source/search-runs.rst" class="fa fa-github"> Edit on GitHub</a>
    </li> -->
    
  </ul>
</div>
            <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
              <div itemprop="articleBody">
                
  <div class="section" id="search-runs">
<h1>Search Runs<a class="headerlink" href="#search-runs" title="Permalink to this headline"> </a></h1>
<p>This guide will walk you through how to search your MLflow runs through the MLflow UI and Python API.
This resource will be valuable if you’re interested in querying specific runs based on their metrics,
params, tags, dataset information, or run metadata.</p>
<p>In short, you can leverage SQL-like syntax to filter your runs based on a variety of conditions.
Note that the <code class="docutils literal notranslate"><span class="pre">OR</span></code> keyword is not supported and there are a few other differences from SQL
mentioned below, but despite these limitations, the run search functionality is quite powerful.</p>
<div class="section" id="search-runs-on-mlflow-ui">
<h2>Search Runs on MLflow UI<a class="headerlink" href="#search-runs-on-mlflow-ui" title="Permalink to this headline"> </a></h2>
<p>The MLflow UI provides a powerful search interface that allows you to filter runs. Below we’ll…</p>
<ol class="arabic simple">
<li><p>Create example MLflow runs</p></li>
<li><p>Look at a simple querying example</p></li>
<li><p>Deep dive into query syntax</p></li>
<li><p>Provide a variety of example queries</p></li>
</ol>
<div class="section" id="create-example-mlflow-runs">
<h3>Create Example MLflow Runs<a class="headerlink" href="#create-example-mlflow-runs" title="Permalink to this headline"> </a></h3>
<p>First, let’s create some example MLflow runs. This documentation is based on experiments created
with the below script. If you don’t want to interactively explore this on your machine, skip
this section.</p>
<p>Before running the script, let’s simply start the MLflow UI on a local host.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>mlflow<span class="w"> </span>ui
</pre></div>
</div>
<p>Let’s visit <code class="docutils literal notranslate"><span class="pre">http://localhost:5000/</span></code> in our web browser. After doing so, you’ll notice that we don’t
have any experiments or models. Let’s resolve this by creating a few MLflow runs via the script
below.</p>
<p>Note that when you run this script, you’ll want to do so from the same directory that you ran
the <code class="docutils literal notranslate"><span class="pre">mlflow</span> <span class="pre">ui</span></code> command.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mlflow</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">mlflow</span><span class="o">.</span><span class="n">set_experiment</span><span class="p">(</span><span class="s2">&quot;search-run-guide&quot;</span><span class="p">)</span>

<span class="n">accuracy</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">)</span>
<span class="n">log_scale_loss</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>
<span class="n">f1_score</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>

<span class="n">batch_size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">+</span> <span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span>
<span class="n">learning_rate</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">0.01</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span>
<span class="n">model</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;GPT-2&quot;</span><span class="p">,</span> <span class="s2">&quot;GPT-3&quot;</span><span class="p">,</span> <span class="s2">&quot;GPT-3.5&quot;</span><span class="p">,</span> <span class="s2">&quot;GPT-4&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="mi">6</span>

<span class="n">task</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;classification&quot;</span><span class="p">,</span> <span class="s2">&quot;regression&quot;</span><span class="p">,</span> <span class="s2">&quot;causal lm&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="mi">7</span>
<span class="n">environment</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;notebook&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">+</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span>

<span class="n">dataset_name</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;custom&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;also custom&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span>
<span class="n">dataset_digest</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;s8ds293b&quot;</span><span class="p">,</span> <span class="s2">&quot;jks834s2&quot;</span><span class="p">]</span> <span class="o">+</span> <span class="p">[</span><span class="kc">None</span><span class="p">]</span> <span class="o">*</span> <span class="mi">8</span>
<span class="n">dataset_context</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">+</span> <span class="p">[</span><span class="s2">&quot;test&quot;</span><span class="p">]</span> <span class="o">*</span> <span class="mi">5</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">mlflow</span><span class="o">.</span><span class="n">start_run</span><span class="p">():</span>
        <span class="n">mlflow</span><span class="o">.</span><span class="n">log_metrics</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;loss&quot;</span><span class="p">:</span> <span class="n">loss</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="s2">&quot;accuracy&quot;</span><span class="p">:</span> <span class="n">accuracy</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="s2">&quot;log-scale-loss&quot;</span><span class="p">:</span> <span class="n">log_scale_loss</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="s2">&quot;f1 score&quot;</span><span class="p">:</span> <span class="n">f1_score</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="n">mlflow</span><span class="o">.</span><span class="n">log_params</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;batch_size&quot;</span><span class="p">:</span> <span class="n">batch_size</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="s2">&quot;learning rate&quot;</span><span class="p">:</span> <span class="n">learning_rate</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="s2">&quot;model&quot;</span><span class="p">:</span> <span class="n">model</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="n">mlflow</span><span class="o">.</span><span class="n">set_tags</span><span class="p">(</span>
            <span class="p">{</span>
                <span class="s2">&quot;task&quot;</span><span class="p">:</span> <span class="n">task</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
                <span class="s2">&quot;environment&quot;</span><span class="p">:</span> <span class="n">environment</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="p">}</span>
        <span class="p">)</span>

        <span class="n">dataset</span> <span class="o">=</span> <span class="n">mlflow</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span>
            <span class="n">features</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span>
            <span class="n">targets</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="p">[</span><span class="mi">20</span><span class="p">]),</span>
            <span class="n">name</span><span class="o">=</span><span class="n">dataset_name</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
            <span class="n">digest</span><span class="o">=</span><span class="n">dataset_digest</span><span class="p">[</span><span class="n">i</span><span class="p">],</span>
        <span class="p">)</span>
        <span class="n">mlflow</span><span class="o">.</span><span class="n">log_input</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">dataset_context</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
</pre></div>
</div>
<p>The code above creates 10 MLflow runs with different metrics, params, tags and dataset information.
After successful execution, if you return to the MLflow UI in your browser, you should find all of
these runs under the experiment “search-run-guide”, as shown by the following screenshot:</p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/created_mlflow_runs.png"><img alt="testing runs" src="_images/created_mlflow_runs.png" style="width: 90%;" /></a>
</div>
<p>In real-world production deployments of MLflow, it’s common to have thousands or even hundreds of thousands of
runs. In such cases, it’s important to be able to filter and search for runs based on specific criteria.</p>
</div>
<div class="section" id="search-query-example">
<span id="search-runs-syntax"></span><h3>Search Query Example<a class="headerlink" href="#search-query-example" title="Permalink to this headline"> </a></h3>
<p>In order to filter your MLflow runs, you will need to write <strong>search queries</strong>, which are pseudo-SQL
conditions expressed in a distinct syntax.</p>
<p>To showcase this functionality, let’s look at the below code examples.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mlflow</span>

<span class="n">all_runs</span> <span class="o">=</span> <span class="n">mlflow</span><span class="o">.</span><span class="n">search_runs</span><span class="p">(</span><span class="n">search_all_experiments</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">all_runs</span><span class="p">)</span>
</pre></div>
</div>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">Output</span><a class="headerlink" href="#id1" title="Permalink to this code"> </a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>                             run_id  ... tags.mlflow.user
0  5984a3488161440f92de9847e846b342  ...     michael.berk
1  41160f238a5841998dda263794b26067  ...     michael.berk
2  babe221a676b4fa4b204f8240f2c4f14  ...     michael.berk
3  45eb4f02c5a1461aa6098fa550233be6  ...     michael.berk
4  1c7c459486c44b23bb016028aee1f153  ...     michael.berk
5  4453f59f1ab04491bb9582d8cba5f437  ...     michael.berk
6  22db81f070f6413588641c8c343cdd72  ...     michael.berk
7  c3680e37d0fa44eb9c9fb7828f6b5481  ...     michael.berk
8  67973142b9c0470d8d764ada07c5a988  ...     michael.berk
9  59853d5f17f946218f63de1dc82de07b  ...     michael.berk

[10 rows x 19 columns]
</pre></div>
</div>
</div>
<p>Second, let’s try filtering the runs for our really bad models: <code class="docutils literal notranslate"><span class="pre">metrics.loss</span> <span class="pre">&gt;</span> <span class="pre">0.8</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mlflow</span>

<span class="n">bad_runs</span> <span class="o">=</span> <span class="n">mlflow</span><span class="o">.</span><span class="n">search_runs</span><span class="p">(</span>
    <span class="n">filter_string</span><span class="o">=</span><span class="s2">&quot;metrics.loss &gt; 0.8&quot;</span><span class="p">,</span> <span class="n">search_all_experiments</span><span class="o">=</span><span class="kc">True</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">bad_runs</span><span class="p">)</span>
</pre></div>
</div>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">Output</span><a class="headerlink" href="#id2" title="Permalink to this code"> </a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>                             run_id  ... tags.mlflow.source.name
0  67973142b9c0470d8d764ada07c5a988  ...               delete.py
1  59853d5f17f946218f63de1dc82de07b  ...               delete.py

[2 rows x 19 columns]
</pre></div>
</div>
</div>
<p>You’ll notice that we now are displaying 2 runs instead of 10. Pretty easy, right?</p>
</div>
<div class="section" id="search-syntax-overview">
<h3>Search Syntax Overview<a class="headerlink" href="#search-syntax-overview" title="Permalink to this headline"> </a></h3>
<p>MLflow’s Search functionality leverages a Domain Specific Language (DSL) for querying. It is inspired by SQL but does not
offer the full range of SQL capabilities.</p>
<p>This section describes the syntax formatting, focusing on “left side” and “right side” elements in search queries. The
“left side” pertains to the field being filtered, such as <code class="docutils literal notranslate"><span class="pre">metrics.loss</span></code>, while the “right side” relates to the value against which
the field is being compared, like <code class="docutils literal notranslate"><span class="pre">0.8</span></code>.</p>
<p><strong>Visual Representation of Search Components:</strong></p>
<div class="figure align-center">
<a class="reference internal image-reference" href="_images/search_syntax.png"><img alt="search components" src="_images/search_syntax.png" style="width: 30%;" /></a>
</div>
<p><strong>Valid Syntax for Left and Right Side Elements:</strong></p>
<ol class="arabic">
<li><p><strong>Left Side Syntax:</strong></p>
<ul class="simple">
<li><p>Fields without special characters or reserved keywords can be referenced directly (e.g., <code class="docutils literal notranslate"><span class="pre">tag.test</span></code>).</p></li>
<li><p>Use backticks for fields that contain special characters or are reserved keywords.</p></li>
<li><p>Double quotes are also acceptable for enclosing field names (e.g., <code class="docutils literal notranslate"><span class="pre">tag.&quot;test&quot;</span></code>).</p></li>
</ul>
<p><strong>Unsupported:</strong></p>
<ul class="simple">
<li><p>Single quotes are <strong>not valid</strong> for enclosing field names (e.g., <code class="docutils literal notranslate"><span class="pre">tag.'test'</span></code> results in a syntax error).</p></li>
</ul>
</li>
<li><p><strong>Right Side Syntax:</strong></p>
<ul class="simple">
<li><p>Enclose values in single or double quotes based on content requirements (e.g., <code class="docutils literal notranslate"><span class="pre">tag.`test`</span> <span class="pre">=</span> <span class="pre">'abc'</span></code> or <code class="docutils literal notranslate"><span class="pre">tag.`test`</span> <span class="pre">=</span> <span class="pre">&quot;abc&quot;</span></code>).</p></li>
<li><p>Non-metric values, <strong>including numeric values</strong> that may be stored as tags or as parameters must be enclosed in quotations.</p></li>
</ul>
<p><strong>Unsupported:</strong></p>
<ul class="simple">
<li><p>Using backticks or no wrapping for values is not allowed. Examples of invalid syntax include:</p></li>
</ul>
<blockquote>
<div><div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">This results in a syntax error as backticks cannot be used for right-hand values.</span><a class="headerlink" href="#id3" title="Permalink to this code"> </a></div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">tag</span><span class="p">.</span><span class="o">`</span><span class="n">test</span><span class="o">`</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">`</span><span class="n">abc</span><span class="o">`</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">This results in a syntax error as values must be wrapped in double quotes if they are not metrics.</span><a class="headerlink" href="#id4" title="Permalink to this code"> </a></div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">tag</span><span class="p">.</span><span class="o">`</span><span class="n">test</span><span class="o">`</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">abc</span>
</pre></div>
</div>
</div>
</div></blockquote>
</li>
</ol>
</div>
<div class="section" id="search-query-syntax-deep-dive">
<h3>Search Query Syntax Deep Dive<a class="headerlink" href="#search-query-syntax-deep-dive" title="Permalink to this headline"> </a></h3>
<p>As noted above, MLflow search syntax is similar to SQL with a few notable exceptions.</p>
<ul>
<li><p>The SQL <code class="docutils literal notranslate"><span class="pre">OR</span></code> keyword is not supported.</p></li>
<li><p>For fields that contain special characters or start with numbers, these should be wrapped in <strong>backticks</strong>.</p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span><span class="gd">- Bad:  metrics.cross-entropy-loss &lt; 0.5</span>
<span class="gi">+ Good: metrics.`cross-entropy-loss` &lt; 0.5</span>

<span class="gd">- Bad:  params.1st_iteration_timestamp = &quot;2022-01-01&quot;</span>
<span class="gi">+ Good: params.`1st_iteration_timestamp` = &quot;2022-01-01&quot;</span>
</pre></div>
</div>
</li>
<li><p>For the SQL <code class="docutils literal notranslate"><span class="pre">IN</span></code> keyword, you must surround the values of your list with <strong>single quotes</strong>.</p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span><span class="gd">- Bad:  attributes.run_id IN (&quot;5984a3488161440f92de9847e846b342&quot;, &quot;babe221a676b4fa4b204f8240f2c4f14&quot;)</span>
<span class="gi">+ Good: attributes.run_id IN (&#39;5984a3488161440f92de9847e846b342&#39;, &#39;babe221a676b4fa4b204f8240f2c4f14&#39;)</span>
</pre></div>
</div>
</li>
<li><p>For the SQL <code class="docutils literal notranslate"><span class="pre">IN</span></code> keyword, you can only search the following fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">datasets.name</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">datasets.digest</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">datasets.context</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">attributes.run_id</span></code></p></li>
</ul>
</li>
<li><p>Non-None conditions for numeric fields are not supported e.g. <code class="docutils literal notranslate"><span class="pre">metrics.accuracy</span> <span class="pre">!=</span> <span class="pre">&quot;None&quot;</span></code> will fail.</p></li>
</ul>
<p>Other than the that, the syntax should be intuitive to anyone who has used SQL. To assemble
a single search condition, you must assemble an inequality using the following components…</p>
<ol class="arabic simple">
<li><p><strong>An MLflow field</strong>: a metric, param, tag, dataset or run metadata.</p></li>
<li><p><strong>A comparator</strong>: an inequality operator.</p></li>
</ol>
<blockquote>
<div><ul>
<li><p>For numerics, MLflow supports <code class="docutils literal notranslate"><span class="pre">=</span></code>, <code class="docutils literal notranslate"><span class="pre">!=</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;</span></code>, <code class="docutils literal notranslate"><span class="pre">&gt;=</span></code>, <code class="docutils literal notranslate"><span class="pre">&lt;</span></code>, and <code class="docutils literal notranslate"><span class="pre">&lt;=</span></code>. Examples include:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">metrics</span><span class="p">.</span><span class="n">accuracy</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">72</span>
<span class="n">metrics</span><span class="p">.</span><span class="n">loss</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">15</span>
<span class="n">metrics</span><span class="p">.</span><span class="n">accuracy</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">15</span>
</pre></div>
</div>
</li>
<li><p>For strings, MLflow supports <code class="docutils literal notranslate"><span class="pre">=</span></code>, <code class="docutils literal notranslate"><span class="pre">!=</span></code>, <code class="docutils literal notranslate"><span class="pre">LIKE</span></code> (case-sensitive) and <code class="docutils literal notranslate"><span class="pre">ILIKE</span></code> (case-insensitive). Examples include:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">params</span><span class="p">.</span><span class="n">model</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;GPT-4o&quot;</span>
<span class="n">params</span><span class="p">.</span><span class="n">model</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="ss">&quot;GPT%&quot;</span>
<span class="n">params</span><span class="p">.</span><span class="n">model</span><span class="w"> </span><span class="k">ILIKE</span><span class="w"> </span><span class="ss">&quot;gpt%&quot;</span>
</pre></div>
</div>
</li>
<li><p>For sets, MLflow supports <code class="docutils literal notranslate"><span class="pre">IN</span></code>. Examples include:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">datasets</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;custom&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;also custom&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;another custom name&#39;</span><span class="p">)</span>
<span class="n">datasets</span><span class="p">.</span><span class="n">digest</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;s8ds293b&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;jks834s2&#39;</span><span class="p">)</span>
<span class="n">attributes</span><span class="p">.</span><span class="n">run_id</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;5984a3488161440f92de9847e846b342&#39;</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p><strong>A reference value</strong>: a numeric value, string, or set of strings.</p></li>
</ol>
<p>Let’s look at some more examples.</p>
</div>
<div class="section" id="example-queries">
<h3>Example Queries<a class="headerlink" href="#example-queries" title="Permalink to this headline"> </a></h3>
<p>In this section we will go over how to search by different categories of MLflow fields. For each category we provide
a few sample queries. If you have executed the run creation script we provided, these queries should fetch certain runs
but sometimes require modification for run-specific information, such as <code class="docutils literal notranslate"><span class="pre">start_time</span></code>.</p>
<div class="section" id="searching-by-metrics">
<h4>1 - Searching By Metrics<a class="headerlink" href="#searching-by-metrics" title="Permalink to this headline"> </a></h4>
<p>Metrics are quantitative measures typically used to evaluate the model’s performance during
or after training. Metrics can include values like accuracy, precision, recall, F1 score, etc., and
can change over time as the model trains. They are logged manually via <code class="docutils literal notranslate"><span class="pre">mlflow.log_metric</span></code> or
<code class="docutils literal notranslate"><span class="pre">mlflow.log_metrics</span></code> or automatically via autologging.</p>
<p>To search for runs by filtering on metrics, you must include the <code class="docutils literal notranslate"><span class="pre">metrics</span></code> prefix in the left
side of the inequality. Note that they are <strong>stored as numbers</strong>, so you must use numeric comparators.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">metrics</span><span class="p">.</span><span class="n">accuracy</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">72</span>
<span class="n">metrics</span><span class="p">.</span><span class="ss">&quot;accuracy&quot;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">72</span>
<span class="n">metrics</span><span class="p">.</span><span class="n">loss</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">15</span>
<span class="n">metrics</span><span class="p">.</span><span class="o">`</span><span class="n">log</span><span class="o">-</span><span class="k">scale</span><span class="o">-</span><span class="n">loss</span><span class="o">`</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">metrics</span><span class="p">.</span><span class="o">`</span><span class="n">f1</span><span class="w"> </span><span class="n">score</span><span class="o">`</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">5</span>
<span class="n">metrics</span><span class="p">.</span><span class="n">accuracy</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">72</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">metrics</span><span class="p">.</span><span class="n">loss</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">15</span>
</pre></div>
</div>
</div>
<div class="section" id="searching-by-params">
<h4>2 - Searching By Params<a class="headerlink" href="#searching-by-params" title="Permalink to this headline"> </a></h4>
<p>Params are strings that typically represent the configuration aspects of the model. Parameters can include values
like learning rate, batch size, and number of epochs. They are logged manually via <code class="docutils literal notranslate"><span class="pre">mlflow.log_param</span></code>
or <code class="docutils literal notranslate"><span class="pre">mlflow.log_params</span></code> or automatically via autologging.</p>
<p>To search for runs by filtering on params, you must include the <code class="docutils literal notranslate"><span class="pre">params</span></code> prefix in the left
side of the inequality. Note that they are <strong>stored as strings</strong>, so you must use string
comparators, such as <code class="docutils literal notranslate"><span class="pre">=</span></code> and <code class="docutils literal notranslate"><span class="pre">!=</span></code>.</p>
<p>Note that numeric values stored as parameters are cast to string in the tracking store.
When querying for numeric parameters, you must specify them as strings by enclosing them in <strong>double quotes</strong>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">params</span><span class="p">.</span><span class="n">batch_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;2&quot;</span>
<span class="n">params</span><span class="p">.</span><span class="n">model</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="ss">&quot;GPT%&quot;</span>
<span class="n">params</span><span class="p">.</span><span class="n">model</span><span class="w"> </span><span class="k">ILIKE</span><span class="w"> </span><span class="ss">&quot;gPt%&quot;</span>
<span class="n">params</span><span class="p">.</span><span class="n">model</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="ss">&quot;GPT%&quot;</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">params</span><span class="p">.</span><span class="n">batch_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;2&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="searching-by-tags">
<span id="mlflow-tags"></span><h4>3 - Searching By Tags<a class="headerlink" href="#searching-by-tags" title="Permalink to this headline"> </a></h4>
<p>Tags are metadata that typically provide additional context about the run. Tags can include values
like user name, team, etc. They are logged manually via <code class="docutils literal notranslate"><span class="pre">mlflow.set_tag</span></code>
or <code class="docutils literal notranslate"><span class="pre">mlflow.set_tags</span></code>. In addition, <a class="reference external" href="https://mlflow.org/docs/latest/tracking/tracking-api.html#system-tags">system tags</a>,
such as <code class="docutils literal notranslate"><span class="pre">mlflow.user</span></code>, are automatically logged.</p>
<p>To search for runs by filtering on tags, you must include the <code class="docutils literal notranslate"><span class="pre">tags</span></code> or <code class="docutils literal notranslate"><span class="pre">mlflow</span></code> prefixes in
the left side of the inequality. Note that tags are <strong>stored as strings</strong>, so you must use string
comparators, such as <code class="docutils literal notranslate"><span class="pre">=</span></code> and <code class="docutils literal notranslate"><span class="pre">!=</span></code>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">tags</span><span class="p">.</span><span class="ss">&quot;environment&quot;</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;notebook&quot;</span>
<span class="n">tags</span><span class="p">.</span><span class="n">environment</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;notebook&quot;</span>
<span class="n">tags</span><span class="p">.</span><span class="n">task</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;Classification&quot;</span>
<span class="n">tags</span><span class="p">.</span><span class="n">task</span><span class="w"> </span><span class="k">ILIKE</span><span class="w"> </span><span class="ss">&quot;classif%&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="searching-by-dataset-information">
<h4>4 - Searching By Dataset Information<a class="headerlink" href="#searching-by-dataset-information" title="Permalink to this headline"> </a></h4>
<p>Datasets represent data used in model training or evaluation, including features, targets,
predictions, and metadata such as the dataset’s name, digest (hash) schema, profile, and source.
They are logged via <code class="docutils literal notranslate"><span class="pre">mlflow.log_input</span></code> or automatically via autologging.</p>
<p>To search for runs by filtering on dataset information, you must filter on one of the below fields</p>
<ol class="arabic simple">
<li><p><code class="docutils literal notranslate"><span class="pre">datasets.name</span></code>, which is the dataset’s name.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">datasets.digest</span></code>, which is a unique identifier for the dataset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">datasets.context</span></code>, which represents if the dataset is used for train, evaluation or test.</p></li>
</ol>
<p>Note that dataset information is <strong>stored as strings</strong>, so you must use string comparators, such as <code class="docutils literal notranslate"><span class="pre">=</span></code> and <code class="docutils literal notranslate"><span class="pre">!=</span></code>.
Also note that datasets support set comparators, such as <code class="docutils literal notranslate"><span class="pre">IN</span></code>.</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">datasets</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="ss">&quot;custom&quot;</span>
<span class="n">datasets</span><span class="p">.</span><span class="n">digest</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;s8ds293b&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;jks834s2&#39;</span><span class="p">)</span>
<span class="n">datasets</span><span class="p">.</span><span class="n">context</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;train&quot;</span>
</pre></div>
</div>
</div>
<div class="section" id="searching-by-run-s-metadata">
<h4>5 - Searching By Run’s Metadata<a class="headerlink" href="#searching-by-run-s-metadata" title="Permalink to this headline"> </a></h4>
<p>Run metadata are a variety of user-specified and system-generated attributes that provide additional context about the run.</p>
<p>To search for runs by filtering on the metadata of runs, you must include the <code class="docutils literal notranslate"><span class="pre">attributes</span></code> prefix in the left
side of the inequality. Note that run metadata can be either a string or a numeric depending on the
attribute, so you must use the appropriate comparator. For a complete list of attributes, see
<a class="reference internal" href="python_api/mlflow.entities.html#mlflow.entities.RunInfo" title="mlflow.entities.RunInfo"><code class="xref py py-class docutils literal notranslate"><span class="pre">mlflow.entities.RunInfo</span></code></a>, however note that not all fields in the RunInfo object are
searchable.</p>
<p>To search for runs by filtering on tags, you must include the <code class="docutils literal notranslate"><span class="pre">tags</span></code> or <code class="docutils literal notranslate"><span class="pre">mlflow</span></code> prefixes in
the left side of the inequality. Note that tags are <strong>stored as strings</strong>, so you must use string
comparators, such as <code class="docutils literal notranslate"><span class="pre">=</span></code> and <code class="docutils literal notranslate"><span class="pre">!=</span></code>.</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">Examples for Strings</span><a class="headerlink" href="#id5" title="Permalink to this code"> </a></div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">attributes</span><span class="p">.</span><span class="n">status</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;ACTIVE&quot;</span>
<span class="n">attributes</span><span class="p">.</span><span class="n">user_id</span><span class="w"> </span><span class="k">LIKE</span><span class="w"> </span><span class="ss">&quot;user1&quot;</span>
<span class="n">attributes</span><span class="p">.</span><span class="n">run_name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;my-run&quot;</span>
<span class="n">attributes</span><span class="p">.</span><span class="n">run_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="ss">&quot;a1b2c3d4&quot;</span>
<span class="n">attributes</span><span class="p">.</span><span class="n">run_id</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;a1b2c3d4&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;e5f6g7h8&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">Examples for Numerics</span><a class="headerlink" href="#id6" title="Permalink to this code"> </a></div>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">attributes</span><span class="p">.</span><span class="n">start_time</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">1664067852747</span>
<span class="n">attributes</span><span class="p">.</span><span class="n">end_time</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">1664067852747</span>
<span class="n">attributes</span><span class="p">.</span><span class="n">created</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">1664067852747</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="searching-over-a-set">
<h4>6 - Searching over a Set<a class="headerlink" href="#searching-over-a-set" title="Permalink to this headline"> </a></h4>
<p>You can search for runs by filtering on a set of acceptable values via the <code class="docutils literal notranslate"><span class="pre">IN</span></code> keyword. As noted
above, this is only supported for the following fields:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">datasets.{any_attribute}</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">attributes.run_id</span></code></p></li>
</ul>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">datasets</span><span class="p">.</span><span class="n">name</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;custom&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;also custom&#39;</span><span class="p">)</span>
<span class="n">datasets</span><span class="p">.</span><span class="n">digest</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;s8ds293b&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;jks834s2&#39;</span><span class="p">)</span>
<span class="n">attributes</span><span class="p">.</span><span class="n">run_id</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;a1b2c3d4&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;e5f6g7h8&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="chained-queries">
<h4>7 - Chained Queries<a class="headerlink" href="#chained-queries" title="Permalink to this headline"> </a></h4>
<p>You can chain multiple queries together using the <code class="docutils literal notranslate"><span class="pre">AND</span></code> keyword. For example, to search for runs
with a variety of conditions, you can use the following queries:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">metrics</span><span class="p">.</span><span class="n">accuracy</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">72</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">metrics</span><span class="p">.</span><span class="n">loss</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">15</span>
<span class="n">metrics</span><span class="p">.</span><span class="n">accuracy</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">72</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">metrics</span><span class="p">.</span><span class="n">batch_size</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span>
<span class="n">metrics</span><span class="p">.</span><span class="n">accuracy</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">72</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">metrics</span><span class="p">.</span><span class="n">batch_size</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">attributes</span><span class="p">.</span><span class="n">run_id</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="s1">&#39;a1b2c3d4&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;e5f6g7h8&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can also apply multiple conditions on the same field, for example searching for all loss metrics
<code class="docutils literal notranslate"><span class="pre">BETWEEEN</span></code> 0.1 and 0.15, inclusive:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">metrics</span><span class="p">.</span><span class="n">loss</span><span class="w"> </span><span class="o">&lt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">15</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">metrics</span><span class="p">.</span><span class="n">loss</span><span class="w"> </span><span class="o">&gt;=</span><span class="w"> </span><span class="mi">0</span><span class="p">.</span><span class="mi">1</span>
</pre></div>
</div>
<p>Finally, before moving on it’s important to revisit that that you cannot use the <code class="docutils literal notranslate"><span class="pre">OR</span></code> keyword in
your queries.</p>
</div>
<div class="section" id="non-none-queries">
<h4>8 - Non-None Queries<a class="headerlink" href="#non-none-queries" title="Permalink to this headline"> </a></h4>
<p>To search for runs where a field (only type string is supported) is not null, use the
<code class="docutils literal notranslate"><span class="pre">field</span> <span class="pre">!=</span> <span class="pre">&quot;None&quot;</span></code> syntax. For example, to search for runs where the batch_size is not null, you
can use the following query:</p>
<div class="highlight-sql notranslate"><div class="highlight"><pre><span></span><span class="n">params</span><span class="p">.</span><span class="n">batch_size</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="ss">&quot;None&quot;</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="programmatically-searching-runs">
<h2>Programmatically Searching Runs<a class="headerlink" href="#programmatically-searching-runs" title="Permalink to this headline"> </a></h2>
<p>When scaling out to large production systems, typically you’ll want to interact with your runs
outside the MLflow UI. This can be done programmatically using the MLflow client APIs.</p>
<div class="section" id="python">
<h3>Python<a class="headerlink" href="#python" title="Permalink to this headline"> </a></h3>
<p><a class="reference internal" href="python_api/mlflow.client.html#mlflow.client.MlflowClient.search_runs" title="mlflow.client.MlflowClient.search_runs"><code class="xref py py-func docutils literal notranslate"><span class="pre">mlflow.client.MlflowClient.search_runs()</span></code></a> or <a class="reference internal" href="python_api/mlflow.html#mlflow.search_runs" title="mlflow.search_runs"><code class="xref py py-func docutils literal notranslate"><span class="pre">mlflow.search_runs()</span></code></a>
take the same arguments as the above UI examples and more! They return all the runs that
match the specified filters. Your best resource is the dosctrings for each of these functions, but
here are some useful examples.</p>
<div class="section" id="complex-filter">
<h4>1 - Complex Filter<a class="headerlink" href="#complex-filter" title="Permalink to this headline"> </a></h4>
<p>Python provides powerful ways to build these queries programmatically. Some tips:</p>
<ul class="simple">
<li><p>For complex filters, specifically those with both single and double quotes, use multi-line strings or <cite>\”</cite> to escape the quotes.</p></li>
<li><p>When working with lists, use the <code class="docutils literal notranslate"><span class="pre">.join()</span></code> method to concatenate the list elements with a delimiter.</p></li>
<li><p>It’s often most concise to use the fluent APIs, so below we demo only with the fluent API.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mlflow</span>

<span class="n">run_ids</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;22db81f070f6413588641c8c343cdd72&quot;</span><span class="p">,</span> <span class="s2">&quot;c3680e37d0fa44eb9c9fb7828f6b5481&quot;</span><span class="p">]</span>
<span class="n">run_id_condition</span> <span class="o">=</span> <span class="s2">&quot;&#39;&quot;</span> <span class="o">+</span> <span class="s2">&quot;&#39;,&#39;&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">run_ids</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;&#39;&quot;</span>

<span class="n">complex_filter</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&quot;&quot;</span>
<span class="s2">attributes.run_id IN (</span><span class="si">{</span><span class="n">run_id_condition</span><span class="si">}</span><span class="s2">)</span>
<span class="s2">  AND metrics.loss &gt; 0.3</span>
<span class="s2">  AND metrics.&quot;f1 score&quot; &lt; 0.5</span>
<span class="s2">  AND params.model LIKE &quot;GPT%&quot;</span>
<span class="s2">&quot;&quot;&quot;</span>

<span class="n">runs_with_complex_filter</span> <span class="o">=</span> <span class="n">mlflow</span><span class="o">.</span><span class="n">search_runs</span><span class="p">(</span>
    <span class="n">experiment_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;search-run-guide&quot;</span><span class="p">],</span>
    <span class="n">filter_string</span><span class="o">=</span><span class="n">complex_filter</span><span class="p">,</span>
<span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">runs_with_complex_filter</span><span class="p">)</span>
</pre></div>
</div>
<p>The output will be a pandas DataFrame with the runs that match the specified filters, as shown below.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>                              run_id  ... tags.mlflow.runName
0  22db81f070f6413588641c8c343cdd72  ...   orderly-quail-568
1  c3680e37d0fa44eb9c9fb7828f6b5481  ...    melodic-lynx-301

[2 rows x 19 columns]
</pre></div>
</div>
</div>
<div class="section" id="run-view-type">
<h4>2 - <cite>run_view_type</cite><a class="headerlink" href="#run-view-type" title="Permalink to this headline"> </a></h4>
<p>The <code class="docutils literal notranslate"><span class="pre">run_view_type</span></code> parameter exposes additional filtering options, as noted in the
<a class="reference internal" href="python_api/mlflow.entities.html#mlflow.entities.ViewType" title="mlflow.entities.ViewType"><code class="xref py py-class docutils literal notranslate"><span class="pre">mlflow.entities.ViewType</span></code></a> enum. For example, if you want to filter only active runs,
which is a dropdown in the UI, simply pass <code class="docutils literal notranslate"><span class="pre">run_view_type=ViewType.ACTIVE_ONLY</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mlflow</span>
<span class="kn">from</span> <span class="nn">mlflow.entities</span> <span class="kn">import</span> <span class="n">ViewType</span>

<span class="n">active_runs</span> <span class="o">=</span> <span class="n">mlflow</span><span class="o">.</span><span class="n">search_runs</span><span class="p">(</span>
    <span class="n">experiment_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;search-run-guide&quot;</span><span class="p">],</span>
    <span class="n">run_view_type</span><span class="o">=</span><span class="n">ViewType</span><span class="o">.</span><span class="n">ACTIVE_ONLY</span><span class="p">,</span>
    <span class="n">order_by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;metrics.accuracy DESC&quot;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="ordering">
<h4>2 - Ordering<a class="headerlink" href="#ordering" title="Permalink to this headline"> </a></h4>
<p>Another useful feature that is available in the search API is allowing for ordering of the returned search results. You can specify a list of columns of interest along with
<code class="docutils literal notranslate"><span class="pre">DESC</span></code> or <code class="docutils literal notranslate"><span class="pre">ASC</span></code> in the <code class="docutils literal notranslate"><span class="pre">order_by</span></code> kwarg. Note that the <code class="docutils literal notranslate"><span class="pre">DESC</span></code> or <code class="docutils literal notranslate"><span class="pre">ASC</span></code> value is optional,
so when the value is not provided, the default is <code class="docutils literal notranslate"><span class="pre">ASC</span></code>. Also note that the default ordering when
the <code class="docutils literal notranslate"><span class="pre">order_by</span></code> parameter is omitted is to sort by <code class="docutils literal notranslate"><span class="pre">start_time</span> <span class="pre">DESC</span></code>, then <code class="docutils literal notranslate"><span class="pre">run_id</span> <span class="pre">ASC</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mlflow</span>
<span class="kn">from</span> <span class="nn">mlflow.entities</span> <span class="kn">import</span> <span class="n">ViewType</span>

<span class="n">active_runs_ordered_by_accuracy</span> <span class="o">=</span> <span class="n">mlflow</span><span class="o">.</span><span class="n">search_runs</span><span class="p">(</span>
    <span class="n">experiment_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;search-run-guide&quot;</span><span class="p">],</span>
    <span class="n">run_view_type</span><span class="o">=</span><span class="n">ViewType</span><span class="o">.</span><span class="n">ACTIVE_ONLY</span><span class="p">,</span>
    <span class="n">order_by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;metrics.accuracy DESC&quot;</span><span class="p">],</span>
<span class="p">)</span>
</pre></div>
</div>
<p>A common use case is getting the top <cite>n</cite> results, for example, the top 5 runs by accuracy. When
combined with the <code class="docutils literal notranslate"><span class="pre">max_results</span></code> parameter, you can get the top <code class="docutils literal notranslate"><span class="pre">n</span></code> that match your query.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mlflow</span>
<span class="kn">from</span> <span class="nn">mlflow.entities</span> <span class="kn">import</span> <span class="n">ViewType</span>

<span class="n">highest_accuracy_run</span> <span class="o">=</span> <span class="n">mlflow</span><span class="o">.</span><span class="n">search_runs</span><span class="p">(</span>
    <span class="n">experiment_names</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;search-run-guide&quot;</span><span class="p">],</span>
    <span class="n">run_view_type</span><span class="o">=</span><span class="n">ViewType</span><span class="o">.</span><span class="n">ACTIVE_ONLY</span><span class="p">,</span>
    <span class="n">max_results</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">order_by</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;metrics.accuracy DESC&quot;</span><span class="p">],</span>
<span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="searching-all-experiments">
<h4>3 - Searching All Experiments<a class="headerlink" href="#searching-all-experiments" title="Permalink to this headline"> </a></h4>
<p>Now you might be wondering how to search all experiments. It’s as simple as specifying
<code class="docutils literal notranslate"><span class="pre">search_all_experiments=True</span></code> and omitting the <code class="docutils literal notranslate"><span class="pre">experiment_ids</span></code> parameter.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mlflow</span>
<span class="kn">from</span> <span class="nn">mlflow.entities</span> <span class="kn">import</span> <span class="n">ViewType</span>

<span class="n">model_of_interest</span> <span class="o">=</span> <span class="s2">&quot;GPT-4&quot;</span>
<span class="n">gpt_4_runs_global</span> <span class="o">=</span> <span class="n">mlflow</span><span class="o">.</span><span class="n">search_runs</span><span class="p">(</span>
    <span class="n">filter_string</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;params.model = &#39;</span><span class="si">{</span><span class="n">model_of_interest</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">,</span>
    <span class="n">run_view_type</span><span class="o">=</span><span class="n">ViewType</span><span class="o">.</span><span class="n">ALL</span><span class="p">,</span>
    <span class="n">search_all_experiments</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Finally, there are additioanl useful features in the
<a class="reference internal" href="python_api/mlflow.client.html#mlflow.client.MlflowClient.search_runs" title="mlflow.client.MlflowClient.search_runs"><code class="xref py py-func docutils literal notranslate"><span class="pre">mlflow.client.MlflowClient.search_runs()</span></code></a> or <a class="reference internal" href="python_api/mlflow.html#mlflow.search_runs" title="mlflow.search_runs"><code class="xref py py-func docutils literal notranslate"><span class="pre">mlflow.search_runs()</span></code></a> methods, so be sure to
check out the documentation for more details.</p>
</div>
</div>
<div class="section" id="r">
<h3>R<a class="headerlink" href="#r" title="Permalink to this headline"> </a></h3>
<p>The R API is similar to the Python API, with the exeption that the filter conditions must be string wrapped. Due to this
behavior, right-hand side conditional elements must be wrapped in single quotes for parameters, attributes, and tags.</p>
<div class="highlight-r notranslate"><div class="highlight"><pre><span></span><span class="nf">library</span><span class="p">(</span><span class="n">mlflow</span><span class="p">)</span>
<span class="nf">mlflow_search_runs</span><span class="p">(</span>
<span class="w">  </span><span class="n">filter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;metrics.rmse &lt; 0.9 and tags.production = &#39;true&#39;&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="n">experiment_ids</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">as.character</span><span class="p">(</span><span class="m">1</span><span class="o">:</span><span class="m">2</span><span class="p">),</span>
<span class="w">  </span><span class="n">order_by</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;params.lr DESC&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="java">
<h3>Java<a class="headerlink" href="#java" title="Permalink to this headline"> </a></h3>
<p>The Java API is similar to the Python API with the exception that the entire conditional filter syntax is string-encapsulated.
This is due to the fact that the Java API is a thin wrapper around the Python core APIs, and as such, will be translated between
the two languages.</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">List</span><span class="o">&lt;</span><span class="n">Long</span><span class="o">&gt;</span><span class="w"> </span><span class="n">experimentIds</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;4&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;8&quot;</span><span class="p">);</span>
<span class="n">List</span><span class="o">&lt;</span><span class="n">RunInfo</span><span class="o">&gt;</span><span class="w"> </span><span class="n">searchResult</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="na">searchRuns</span><span class="p">(</span><span class="n">experimentIds</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;metrics.accuracy_score &lt; 99.90&quot;</span><span class="p">);</span>
</pre></div>
</div>
</div>
</div>
</div>


              </div>
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="cli.html" class="btn btn-neutral" title="Command-Line Interface" accesskey="p"><span class="db-icon db-icon-chevron-left"></span> Previous</a>
      
      
        <a href="search-experiments.html" class="btn btn-neutral" title="Search Experiments" accesskey="n">Next <span class="db-icon db-icon-chevron-right"></span></a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
      <p class="copyright">
          &copy; MLflow Project, a Series of LF Projects, LLC. All rights reserved.
      </p>

  </div> 

</footer>
          </div>
        </div>
      </section>
    </main>
  </page>

  


  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT:'./',
      VERSION:'2.17.1.dev0',
      COLLAPSE_INDEX:false,
      FILE_SUFFIX:'.html',
      LINK_SUFFIX: '.html',
      HAS_SOURCE:  true
    };
  </script>

  

  <script type="text/javascript" src="_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="_static/js/jquery.waypoints.min.js"></script>

  
  
  
  <script type="text/javascript">var CLIPPY_SVG_PATH = "_static/clippy.svg";</script>
  <script type="text/javascript" src="_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  

  
  <script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
        function copyToClipboard(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
        }
        // Get the code block designator class entries
        const allHighlights = document.querySelectorAll('.highlight');
        // Disable copyable links for notebook cell numbering and for cell outputs
        const highlights = Array.from(allHighlights).filter(highlight => !highlight.closest('.highlight-none') && 
            !highlight.closest('.nboutput'));
    
        highlights.forEach(function(highlight) {
            const copyIcon = document.createElement('span');
            copyIcon.classList.add('copy-icon');
            copyIcon.innerHTML = '&#xf0ea;';

            copyIcon.addEventListener('click', function() {
                const code = highlight.querySelector('pre').textContent;
                copyToClipboard(code);

                // Flash effect on click
                this.style.color = '#0194E2';
                setTimeout(() => {
                    this.style.color = ''; 
                }, 100);

                // Display "Code copied to clipboard" near the clicked icon
                const message = document.createElement('span');
                message.textContent = "Copied!";
                message.classList.add('copy-message'); 

                // Append the message to the icon
                this.appendChild(message);

                setTimeout(() => {
                    this.removeChild(message);
                }, 500);
            });

            highlight.appendChild(copyIcon);
        });
    });
  </script>


<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
        // Force download for notebook-download-btn
        const downloadButtons = document.querySelectorAll('.notebook-download-btn');
        downloadButtons.forEach(function(button) {
            button.addEventListener('click', function(event) {
                event.preventDefault(); // Prevent default behavior

                // Fetch the raw content of the notebook from GitHub
                fetch(button.href)
                    .then(response => response.blob())
                    .then(blob => {
                        const url = window.URL.createObjectURL(blob);
                        const link = document.createElement('a');
                        link.style.display = 'none';
                        link.href = url;
                        const filename = button.href.split('/').pop();
                        link.download = filename; 

                        document.body.appendChild(link);
                        link.click();

                        window.URL.revokeObjectURL(url);
                        document.body.removeChild(link);
                    })
                    .catch(err => console.error('Error fetching the notebook:', err));
            });
        });
    });
</script> 
</body>
</html>