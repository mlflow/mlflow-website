
  

<!DOCTYPE html>
<!-- source: docs/source/getting-started/intro-quickstart/index.rst -->
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>MLflow Tracking Quickstart &mdash; MLflow 2.14.2.dev0 documentation</title>
  
   
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <link rel="canonical" href="https://mlflow.org/docs/latest/getting-started/intro-quickstart/index.html">
  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    

    

  
    
        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer',"GTM-N6WMTTJ");</script>
        <!-- End Google Tag Manager -->
    

  

  
  
    

  

  
  
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/cards.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/grids.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/mobile.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/simple-cards.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/tabs.css" type="text/css" />
    
  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="MLflow 2.14.2.dev0 documentation" href="../../index.html"/>
        <link rel="up" title="Getting Started with MLflow" href="../index.html"/>
        <link rel="next" title="MLflow Tracking Quickstart Notebook" href="/notebooks/index.html"/>
        <link rel="prev" title="How to Run Tutorials" href="/../running-notebooks/index.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>
<script type="text/javascript" src="../../_static/jquery.js"></script>
<script type="text/javascript" src="../../_static/underscore.js"></script>
<script type="text/javascript" src="../../_static/doctools.js"></script>
<script type="text/javascript" src="../../_static/languagesections.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>

<body class="wy-body-for-nav" role="document">
  
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-N6WMTTJ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
  

  
  <nav class="wy-nav-top header" role="navigation" aria-label="top navigation">
    <ul>
  <li class="menu-toggle">
    <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
    <a href="../../index.html" class="wy-nav-top-logo"
      ><img src="../../_static/MLflow-logo-final-black.png" alt="MLflow"
    /></a>
    <span class="version">2.14.2.dev0</span>
  </li>
</ul>
  </nav>
  <page>
    

    <nav data-toggle="wy-nav-shift" class="wy-nav-side relative">
      <div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
  </form>
</div>


    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../../index.html" class="main-navigation-home"><img src="../../_static/icons/nav-home.svg"> MLflow</a>
    

    
      

      
        <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">What is MLflow?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Getting Started with MLflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../new-features/index.html">New Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../llms/index.html">LLMs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../model-evaluation/index.html">Model Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deep-learning/index.html">Deep Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../traditional-ml/index.html">Traditional ML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deployment/index.html">Deployment</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../tracking.html">MLflow Tracking</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../tracking.html#quickstart">Quickstart</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tracking.html#concepts">Concepts</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tracking.html#tracking-runs">Tracking Runs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tracking.html#tracking-datasets">Tracking Datasets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../tracking.html#explore-runs-and-results">Explore Runs and Results</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../tracking.html#set-up-the-mlflow-tracking-environment">Set up the MLflow Tracking Environment</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../../tracking.html#components">Components</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../../tracking.html#common-setups">Common Setups</a><ul class="current">
<li class="toctree-l4 current"><a class="current reference internal" href="#">MLflow Tracking Quickstart</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tracking/tutorials/local-database.html">Tracking Experiments with a Local Database</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../tracking/tutorials/remote-server.html">Remote Experiment Tracking with MLflow Tracking Server</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../tracking.html#other-configuration-with-mlflow-tracking-server">Other Configuration with <span class="xref std std-ref">MLflow Tracking Server</span></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../tracking.html#faq">FAQ</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../system-metrics/index.html">System Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../projects.html">MLflow Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../models.html">MLflow Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../model-registry.html">MLflow Model Registry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../recipes.html">MLflow Recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plugins.html">MLflow Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auth/index.html">MLflow Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cli.html">Command-Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../search-runs.html">Search Runs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../search-experiments.html">Search Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python_api/index.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../R-api.html">R API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../java_api/index.html">Java API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rest-api.html">REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docker.html">Official MLflow Docker Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community-model-flavors.html">Community Model Flavors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials-and-examples/index.html">Tutorials and Examples</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    

    <p>
      <a id='feedbacklink' href="https://github.com/mlflow/mlflow/blob/master/CONTRIBUTING.md" target="_blank">Contribute</a>
    </p>
  </div>
</div>
    </nav>

    <main class="wy-grid-for-nav">
      <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
        <div class="wy-nav-content">
          <div class="rst-content">
            










<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
        <li><a href="../index.html">Getting Started with MLflow</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>MLflow Tracking Quickstart</li>
    
    
    <!-- <li class="wy-breadcrumbs-aside">
      <a href="https://github.com/mlflow/mlflow/blob/master/docs/source/getting-started/intro-quickstart/index.rst" class="fa fa-github"> Edit on GitHub</a>
    </li> -->
    
  </ul>
</div>
            <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
              <div itemprop="articleBody">
                
  <div class="section" id="mlflow-tracking-quickstart">
<h1>MLflow Tracking Quickstart<a class="headerlink" href="#mlflow-tracking-quickstart" title="Permalink to this headline"> </a></h1>
<p>Welcome to MLflow!</p>
<p>The purpose of this quickstart is to provide a quick guide to the most essential core APIs of MLflow Tracking.
Specifically, those that enable the logging, registering, and loading of a model for inference.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For a more in-depth and tutorial-based approach (if that is your style), please see the
<a class="reference external" href="../logging-first-model/index.html">Getting Started with MLflow</a> tutorial. We recommend that you start here first, though, as this quickstart
uses the most common and frequently-used APIs for MLflow Tracking and serves as a good foundation for the other tutorials in the documentation.</p>
</div>
<div class="section" id="what-you-will-learn">
<h2>What you will learn<a class="headerlink" href="#what-you-will-learn" title="Permalink to this headline"> </a></h2>
<p>In just a few minutes of following along with this quickstart, you will learn:</p>
<ul class="simple">
<li><p>How to <strong>log</strong> parameters, metrics, and a model</p></li>
<li><p>The basics of the <strong>MLflow fluent API</strong></p></li>
<li><p>How to <strong>register</strong> a model during logging</p></li>
<li><p>How to navigate to a model in the <strong>MLflow UI</strong></p></li>
<li><p>How to <strong>load</strong> a logged model for inference</p></li>
</ul>
<p>If you would like to see this quickstart in a purely notebook format, we have a downloadable and viewable notebook-only version of this quickstart:</p>
 <section>
    <article class="simple-grid">
        <div class="simple-card">
            <a href="notebooks/tracking_quickstart.html" >
                <div class="header">
                    MLflow Tracking Quickstart Guide
                </div>
                <p>
                Learn the basics of MLflow Tracking in a fast-paced guide with a focus on seeing your first model in the MLflow UI
                </p>
            </a>
        </div>
    </article>
</section><div class="toctree-wrapper compound">
</div>
</div>
<div class="section" id="step-1-get-mlflow">
<h2>Step 1 - Get MLflow<a class="headerlink" href="#step-1-get-mlflow" title="Permalink to this headline"> </a></h2>
<p>MLflow is available on PyPI.</p>
<div class="section" id="installing-stable-release">
<h3>Installing Stable Release<a class="headerlink" href="#installing-stable-release" title="Permalink to this headline"> </a></h3>
<p>If you don’t already have it installed on your system, you can install it with:</p>
<div class="code-section docutils container">
<div class="highlight-bash notranslate" id="download-mlflow"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>mlflow
</pre></div>
</div>
</div>
</div>
<div class="section" id="installing-a-release-candidate-rc">
<h3>Installing a Release Candidate (RC)<a class="headerlink" href="#installing-a-release-candidate-rc" title="Permalink to this headline"> </a></h3>
<p>If you are eager to test out new features and validate that an upcoming release of MLflow will work well in your infrastructure, installing the latest
release candidate may be of interest to you.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Release Candidate builds are not recommended for actual use, rather they are intended only for testing validation.</p>
</div>
<p>To install the latest version of MLflow’s release candidates for a given version, see the example below that uses MLflow 2.14.0 as an example:</p>
<div class="code-section docutils container">
<div class="highlight-bash notranslate" id="download-mlflow-rc"><div class="highlight"><pre><span></span><span class="c1"># install the latest release candidate</span>
pip<span class="w"> </span>install<span class="w"> </span>--pre<span class="w"> </span>mlflow

<span class="c1"># or install a specific rc version</span>
pip<span class="w"> </span>install<span class="w"> </span><span class="nv">mlflow</span><span class="o">==</span><span class="m">2</span>.14.0rc0
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="step-2-start-a-tracking-server">
<h2>Step 2 - Start a Tracking Server<a class="headerlink" href="#step-2-start-a-tracking-server" title="Permalink to this headline"> </a></h2>
<div class="section" id="using-a-managed-mlflow-tracking-server">
<h3>Using a Managed MLflow Tracking Server<a class="headerlink" href="#using-a-managed-mlflow-tracking-server" title="Permalink to this headline"> </a></h3>
<p>For details on options for using a managed MLflow Tracking Server, including how to create a free Databricks Community Edition account with
managed MLflow, <a class="reference external" href="../running-notebooks/index.html">see the guide for tracking server options</a>.</p>
</div>
<div class="section" id="optional-run-a-local-tracking-server">
<h3>(Optional) Run a local Tracking Server<a class="headerlink" href="#optional-run-a-local-tracking-server" title="Permalink to this headline"> </a></h3>
<p>We’re going to start a local MLflow Tracking Server, which we will connect to for logging our data for this quickstart.
From a terminal, run:</p>
<div class="code-section docutils container">
<div class="highlight-bash notranslate" id="tracking-server-start"><div class="highlight"><pre><span></span>mlflow<span class="w"> </span>server<span class="w"> </span>--host<span class="w"> </span><span class="m">127</span>.0.0.1<span class="w"> </span>--port<span class="w"> </span><span class="m">8080</span>
</pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can choose any port that you would like, provided that it’s not already in use.</p>
</div>
</div>
<div class="section" id="set-the-tracking-server-uri-if-not-using-a-databricks-managed-mlflow-tracking-server">
<h3>Set the Tracking Server URI (if not using a Databricks Managed MLflow Tracking Server)<a class="headerlink" href="#set-the-tracking-server-uri-if-not-using-a-databricks-managed-mlflow-tracking-server" title="Permalink to this headline"> </a></h3>
<p>If you’re using a managed MLflow Tracking Server that is not provided by Databricks, or if you’re running a local tracking server,
ensure that you set the tracking server’s uri using:</p>
<div class="code-section docutils container">
<div class="highlight-python notranslate" id="set-tracking-uri"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mlflow</span>

<span class="n">mlflow</span><span class="o">.</span><span class="n">set_tracking_uri</span><span class="p">(</span><span class="n">uri</span><span class="o">=</span><span class="s2">&quot;http://&lt;host&gt;:&lt;port&gt;&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>If this is not set within your notebook or runtime environment, the runs will be logged to your local file system.</p>
</div>
</div>
<div class="section" id="step-3-train-a-model-and-prepare-metadata-for-logging">
<h2>Step 3 - Train a model and prepare metadata for logging<a class="headerlink" href="#step-3-train-a-model-and-prepare-metadata-for-logging" title="Permalink to this headline"> </a></h2>
<p>In this section, we’re going to log a model with MLflow. A quick overview of the steps are:</p>
<ul class="simple">
<li><p>Load and prepare the Iris dataset for modeling.</p></li>
<li><p>Train a Logistic Regression model and evaluate its performance.</p></li>
<li><p>Prepare the model hyperparameters and calculate metrics for logging.</p></li>
</ul>
<div class="code-section docutils container">
<div class="highlight-python notranslate" id="train-model"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mlflow</span>
<span class="kn">from</span> <span class="nn">mlflow.models</span> <span class="kn">import</span> <span class="n">infer_signature</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">from</span> <span class="nn">sklearn</span> <span class="kn">import</span> <span class="n">datasets</span>
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LogisticRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">accuracy_score</span><span class="p">,</span> <span class="n">precision_score</span><span class="p">,</span> <span class="n">recall_score</span><span class="p">,</span> <span class="n">f1_score</span>


<span class="c1"># Load the Iris dataset</span>
<span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">(</span><span class="n">return_X_y</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="c1"># Split the data into training and test sets</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span>
    <span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span>
<span class="p">)</span>

<span class="c1"># Define the model hyperparameters</span>
<span class="n">params</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;solver&quot;</span><span class="p">:</span> <span class="s2">&quot;lbfgs&quot;</span><span class="p">,</span>
    <span class="s2">&quot;max_iter&quot;</span><span class="p">:</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="s2">&quot;multi_class&quot;</span><span class="p">:</span> <span class="s2">&quot;auto&quot;</span><span class="p">,</span>
    <span class="s2">&quot;random_state&quot;</span><span class="p">:</span> <span class="mi">8888</span><span class="p">,</span>
<span class="p">}</span>

<span class="c1"># Train the model</span>
<span class="n">lr</span> <span class="o">=</span> <span class="n">LogisticRegression</span><span class="p">(</span><span class="o">**</span><span class="n">params</span><span class="p">)</span>
<span class="n">lr</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">)</span>

<span class="c1"># Predict on the test set</span>
<span class="n">y_pred</span> <span class="o">=</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="c1"># Calculate metrics</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">accuracy_score</span><span class="p">(</span><span class="n">y_test</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="step-4-log-the-model-and-its-metadata-to-mlflow">
<h2>Step 4 - Log the model and its metadata to MLflow<a class="headerlink" href="#step-4-log-the-model-and-its-metadata-to-mlflow" title="Permalink to this headline"> </a></h2>
<p>In this next step, we’re going to use the model that we trained, the hyperparameters that we specified for the model’s fit, and the
loss metrics that were calculated by evaluating the model’s performance on the test data to log to MLflow.</p>
<p>The steps that we will take are:</p>
<ul class="simple">
<li><p>Initiate an MLflow <strong>run</strong> context to start a new run that we will log the model and metadata to.</p></li>
<li><p><strong>Log</strong> model <strong>parameters</strong> and performance <strong>metrics</strong>.</p></li>
<li><p><strong>Tag</strong> the run for easy retrieval.</p></li>
<li><p><strong>Register</strong> the model in the MLflow Model Registry while <strong>logging</strong> (saving) the model.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While it can be valid to wrap the entire code within the <code class="docutils literal notranslate"><span class="pre">start_run</span></code> block, this is <strong>not recommended</strong>. If there as in issue with the
training of the model or any other portion of code that is unrelated to MLflow-related actions, an empty or partially-logged run will be
created, which will necessitate manual cleanup of the invalid run. It is best to keep the training execution outside of the run context block
to ensure that the loggable content (parameters, metrics, artifacts, and the model) are fully materialized prior to logging.</p>
</div>
<div class="code-section docutils container">
<div class="highlight-python notranslate" id="log-model"><div class="highlight"><pre><span></span><span class="c1"># Set our tracking server uri for logging</span>
<span class="n">mlflow</span><span class="o">.</span><span class="n">set_tracking_uri</span><span class="p">(</span><span class="n">uri</span><span class="o">=</span><span class="s2">&quot;http://127.0.0.1:8080&quot;</span><span class="p">)</span>

<span class="c1"># Create a new MLflow Experiment</span>
<span class="n">mlflow</span><span class="o">.</span><span class="n">set_experiment</span><span class="p">(</span><span class="s2">&quot;MLflow Quickstart&quot;</span><span class="p">)</span>

<span class="c1"># Start an MLflow run</span>
<span class="k">with</span> <span class="n">mlflow</span><span class="o">.</span><span class="n">start_run</span><span class="p">():</span>
    <span class="c1"># Log the hyperparameters</span>
    <span class="n">mlflow</span><span class="o">.</span><span class="n">log_params</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>

    <span class="c1"># Log the loss metric</span>
    <span class="n">mlflow</span><span class="o">.</span><span class="n">log_metric</span><span class="p">(</span><span class="s2">&quot;accuracy&quot;</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">)</span>

    <span class="c1"># Set a tag that we can use to remind ourselves what this run was for</span>
    <span class="n">mlflow</span><span class="o">.</span><span class="n">set_tag</span><span class="p">(</span><span class="s2">&quot;Training Info&quot;</span><span class="p">,</span> <span class="s2">&quot;Basic LR model for iris data&quot;</span><span class="p">)</span>

    <span class="c1"># Infer the model signature</span>
    <span class="n">signature</span> <span class="o">=</span> <span class="n">infer_signature</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span> <span class="n">lr</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_train</span><span class="p">))</span>

    <span class="c1"># Log the model</span>
    <span class="n">model_info</span> <span class="o">=</span> <span class="n">mlflow</span><span class="o">.</span><span class="n">sklearn</span><span class="o">.</span><span class="n">log_model</span><span class="p">(</span>
        <span class="n">sk_model</span><span class="o">=</span><span class="n">lr</span><span class="p">,</span>
        <span class="n">artifact_path</span><span class="o">=</span><span class="s2">&quot;iris_model&quot;</span><span class="p">,</span>
        <span class="n">signature</span><span class="o">=</span><span class="n">signature</span><span class="p">,</span>
        <span class="n">input_example</span><span class="o">=</span><span class="n">X_train</span><span class="p">,</span>
        <span class="n">registered_model_name</span><span class="o">=</span><span class="s2">&quot;tracking-quickstart&quot;</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="step-5-load-the-model-as-a-python-function-pyfunc-and-use-it-for-inference">
<h2>Step 5 - Load the model as a Python Function (pyfunc) and use it for inference<a class="headerlink" href="#step-5-load-the-model-as-a-python-function-pyfunc-and-use-it-for-inference" title="Permalink to this headline"> </a></h2>
<p>After logging the model, we can perform inference by:</p>
<ul class="simple">
<li><p><strong>Loading</strong> the model using MLflow’s <cite>pyfunc</cite> flavor.</p></li>
<li><p>Running <strong>Predict</strong> on new data using the loaded model.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The iris training data that we used was a numpy array structure. However, we can submit a Pandas DataFrame as well to the <cite>predict</cite> method, as shown
below.</p>
</div>
<div class="code-section docutils container">
<div class="highlight-python notranslate" id="load-model"><div class="highlight"><pre><span></span><span class="c1"># Load the model back for predictions as a generic Python Function model</span>
<span class="n">loaded_model</span> <span class="o">=</span> <span class="n">mlflow</span><span class="o">.</span><span class="n">pyfunc</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="n">model_info</span><span class="o">.</span><span class="n">model_uri</span><span class="p">)</span>

<span class="n">predictions</span> <span class="o">=</span> <span class="n">loaded_model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_test</span><span class="p">)</span>

<span class="n">iris_feature_names</span> <span class="o">=</span> <span class="n">datasets</span><span class="o">.</span><span class="n">load_iris</span><span class="p">()</span><span class="o">.</span><span class="n">feature_names</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">iris_feature_names</span><span class="p">)</span>
<span class="n">result</span><span class="p">[</span><span class="s2">&quot;actual_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">y_test</span>
<span class="n">result</span><span class="p">[</span><span class="s2">&quot;predicted_class&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">predictions</span>

<span class="n">result</span><span class="p">[:</span><span class="mi">4</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>The output of this code will look something like this:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 18%" />
<col style="width: 17%" />
<col style="width: 18%" />
<col style="width: 17%" />
<col style="width: 14%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>sepal length (cm)</p></th>
<th class="head"><p>sepal width (cm)</p></th>
<th class="head"><p>petal length (cm)</p></th>
<th class="head"><p>petal width (cm)</p></th>
<th class="head"><p>actual_class</p></th>
<th class="head"><p>predicted_class</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>6.1</p></td>
<td><p>2.8</p></td>
<td><p>4.7</p></td>
<td><p>1.2</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
<tr class="row-odd"><td><p>5.7</p></td>
<td><p>3.8</p></td>
<td><p>1.7</p></td>
<td><p>0.3</p></td>
<td><p>0</p></td>
<td><p>0</p></td>
</tr>
<tr class="row-even"><td><p>7.7</p></td>
<td><p>2.6</p></td>
<td><p>6.9</p></td>
<td><p>2.3</p></td>
<td><p>2</p></td>
<td><p>2</p></td>
</tr>
<tr class="row-odd"><td><p>6.0</p></td>
<td><p>2.9</p></td>
<td><p>4.5</p></td>
<td><p>1.5</p></td>
<td><p>1</p></td>
<td><p>1</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="step-6-view-the-run-in-the-mlflow-ui">
<h2>Step 6 - View the Run in the MLflow UI<a class="headerlink" href="#step-6-view-the-run-in-the-mlflow-ui" title="Permalink to this headline"> </a></h2>
<p>In order to see the results of our run, we can navigate to the MLflow UI. Since we have already started the Tracking Server at
<cite>http://localhost:8080</cite>, we can simply navigate to that URL in our browser.</p>
<p>When opening the site, you will see a screen similar to the following:</p>
<div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="../../_images/quickstart-our-experiment.png"><img alt="MLflow UI Experiment view page" src="../../_images/quickstart-our-experiment.png" style="width: 1024px;" /></a>
<p class="caption"><span class="caption-text">The main MLflow Tracking page, showing Experiments that have been created</span><a class="headerlink" href="#id2" title="Permalink to this image"> </a></p>
</div>
<p>Clicking on the name of the Experiment that we created (“MLflow Quickstart”) will give us a list of runs associated with the
Experiment. You should see a random name that has been generated for the run and nothing else show up in the <cite>Table</cite> list view to the right.</p>
<p>Clicking on the name of the run will take you to the Run page, where the details of what we’ve logged will be shown. The elements have
been highlighted below to show how and where this data is recorded within the UI.</p>
<div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="../../_images/quickstart-our-run.png"><img alt="MLflow UI Run view page" src="../../_images/quickstart-our-run.png" style="width: 1024px;" /></a>
<p class="caption"><span class="caption-text">The run view page for our run</span><a class="headerlink" href="#id3" title="Permalink to this image"> </a></p>
</div>
</div>
<div class="section" id="conclusion">
<h2>Conclusion<a class="headerlink" href="#conclusion" title="Permalink to this headline"> </a></h2>
<p>Congratulations on working through the MLflow Tracking Quickstart! You should now have a basic understanding of how to use the MLflow Tracking API to log
models.</p>
<p>If you are interested in a more in-depth tutorial, please see the <a class="reference external" href="../logging-first-model/index.html">Getting Started with MLflow</a> tutorial as a
good next step in increasing your knowledge about MLflow!</p>
</div>
</div>


              </div>
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../running-notebooks/index.html" class="btn btn-neutral" title="How to Run Tutorials" accesskey="p"><span class="db-icon db-icon-chevron-left"></span> Previous</a>
      
      
        <a href="notebooks/index.html" class="btn btn-neutral" title="MLflow Tracking Quickstart Notebook" accesskey="n">Next <span class="db-icon db-icon-chevron-right"></span></a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
      <p class="copyright">
          &copy; MLflow Project, a Series of LF Projects, LLC. All rights reserved.
      </p>

  </div> 

</footer>
          </div>
        </div>
      </section>
    </main>
  </page>

  


  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT:'../../',
      VERSION:'2.14.2.dev0',
      COLLAPSE_INDEX:false,
      FILE_SUFFIX:'.html',
      LINK_SUFFIX: '.html',
      HAS_SOURCE:  true
    };
  </script>

  

  <script type="text/javascript" src="../../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../../_static/js/jquery.waypoints.min.js"></script>

  
  
  
  <script type="text/javascript">var CLIPPY_SVG_PATH = "../../_static/clippy.svg";</script>
  <script type="text/javascript" src="../../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  

  
  <script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
        function copyToClipboard(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
        }
        // Get the code block designator class entries
        const allHighlights = document.querySelectorAll('.highlight');
        // Disable copyable links for notebook cell numbering and for cell outputs
        const highlights = Array.from(allHighlights).filter(highlight => !highlight.closest('.highlight-none') && 
            !highlight.closest('.nboutput'));
    
        highlights.forEach(function(highlight) {
            const copyIcon = document.createElement('span');
            copyIcon.classList.add('copy-icon');
            copyIcon.innerHTML = '&#xf0ea;';

            copyIcon.addEventListener('click', function() {
                const code = highlight.querySelector('pre').textContent;
                copyToClipboard(code);

                // Flash effect on click
                this.style.color = '#0194E2';
                setTimeout(() => {
                    this.style.color = ''; 
                }, 100);

                // Display "Code copied to clipboard" near the clicked icon
                const message = document.createElement('span');
                message.textContent = "Copied!";
                message.classList.add('copy-message'); 

                // Append the message to the icon
                this.appendChild(message);

                setTimeout(() => {
                    this.removeChild(message);
                }, 500);
            });

            highlight.appendChild(copyIcon);
        });
    });
  </script>


<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
        // Force download for notebook-download-btn
        const downloadButtons = document.querySelectorAll('.notebook-download-btn');
        downloadButtons.forEach(function(button) {
            button.addEventListener('click', function(event) {
                event.preventDefault(); // Prevent default behavior

                // Fetch the raw content of the notebook from GitHub
                fetch(button.href)
                    .then(response => response.blob())
                    .then(blob => {
                        const url = window.URL.createObjectURL(blob);
                        const link = document.createElement('a');
                        link.style.display = 'none';
                        link.href = url;
                        const filename = button.href.split('/').pop();
                        link.download = filename; 

                        document.body.appendChild(link);
                        link.click();

                        window.URL.revokeObjectURL(url);
                        document.body.removeChild(link);
                    })
                    .catch(err => console.error('Error fetching the notebook:', err));
            });
        });
    });
</script> 
</body>
</html>