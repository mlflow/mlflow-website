
  

<!DOCTYPE html>
<!-- source: docs/source/getting-started/registering-first-model/step3-load-model.rst -->
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Load a Registered Model &mdash; MLflow 2.14.4.dev0 documentation</title>
  
   
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <link rel="canonical" href="https://mlflow.org/docs/latest/getting-started/registering-first-model/step3-load-model.html">
  
  
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    

    

  
    
        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer',"GTM-N6WMTTJ");</script>
        <!-- End Google Tag Manager -->
    

  

  
  
    

  

  
  
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600" rel="stylesheet">
    <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/cards.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/grids.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/mobile.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/simple-cards.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/css/tabs.css" type="text/css" />
    
  
        <link rel="index" title="Index"
              href="../../genindex.html"/>
        <link rel="search" title="Search" href="../../search.html"/>
    <link rel="top" title="MLflow 2.14.4.dev0 documentation" href="../../index.html"/>
        <link rel="up" title="Tutorial Overview" href="index.html"/>
        <link rel="next" title="Tutorial Overview" href="/../logging-first-model/index.html"/>
        <link rel="prev" title="Explore the Registered Model" href="/step2-explore-registered-model.html"/> 

  
  <script src="../../_static/js/modernizr.min.js"></script>

</head>
<script type="text/javascript" src="../../_static/jquery.js"></script>
<script type="text/javascript" src="../../_static/underscore.js"></script>
<script type="text/javascript" src="../../_static/doctools.js"></script>
<script type="text/javascript" src="../../_static/languagesections.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>

<body class="wy-body-for-nav" role="document">
  
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-N6WMTTJ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
  

  
  <nav class="wy-nav-top header" role="navigation" aria-label="top navigation">
    <ul>
  <li class="menu-toggle">
    <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
    <a href="../../index.html" class="wy-nav-top-logo"
      ><img src="../../_static/MLflow-logo-final-black.png" alt="MLflow"
    /></a>
    <span class="version">2.14.4.dev0</span>
  </li>
</ul>
  </nav>
  <page>
    

    <nav data-toggle="wy-nav-shift" class="wy-nav-side relative">
      <div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
  </form>
</div>


    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../../index.html" class="main-navigation-home"><img src="../../_static/icons/nav-home.svg"> MLflow</a>
    

    
      

      
        <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../introduction/index.html">What is MLflow?</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Getting Started with MLflow</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#guidance-on-running-tutorials">Guidance on Running Tutorials</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#getting-started-guides">Getting Started Guides</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../index.html#mlflow-tracking">MLflow Tracking</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#autologging-basics">Autologging Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#run-comparison-basics">Run Comparison Basics</a></li>
<li class="toctree-l3"><a class="reference internal" href="../index.html#tracking-server-quickstart">Tracking Server Quickstart</a></li>
<li class="toctree-l3 current"><a class="reference internal" href="../index.html#model-registry-quickstart">Model Registry Quickstart</a><ul class="current">
<li class="toctree-l4 current"><a class="reference internal" href="index.html">Tutorial Overview</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#further-learning-what-s-next">Further Learning - Whatâ€™s Next?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../new-features/index.html">New Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../llms/index.html">LLMs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../model-evaluation/index.html">Model Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deep-learning/index.html">Deep Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../traditional-ml/index.html">Traditional ML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../deployment/index.html">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tracking.html">MLflow Tracking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../system-metrics/index.html">System Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../projects.html">MLflow Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../models.html">MLflow Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../model-registry.html">MLflow Model Registry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../recipes.html">MLflow Recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../plugins.html">MLflow Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../auth/index.html">MLflow Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cli.html">Command-Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../search-runs.html">Search Runs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../search-experiments.html">Search Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../python_api/index.html">Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../R-api.html">R API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../java_api/index.html">Java API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../rest-api.html">REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../docker.html">Official MLflow Docker Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community-model-flavors.html">Community Model Flavors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials-and-examples/index.html">Tutorials and Examples</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    

    <p>
      <a id='feedbacklink' href="https://github.com/mlflow/mlflow/blob/master/CONTRIBUTING.md" target="_blank">Contribute</a>
    </p>
  </div>
</div>
    </nav>

    <main class="wy-grid-for-nav">
      <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
        <div class="wy-nav-content">
          <div class="rst-content">
            










<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
        <li><a href="../index.html">Getting Started with MLflow</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
        <li><a href="index.html">Tutorial Overview</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>Load a Registered Model</li>
    
    
    <!-- <li class="wy-breadcrumbs-aside">
      <a href="https://github.com/mlflow/mlflow/blob/master/docs/source/getting-started/registering-first-model/step3-load-model.rst" class="fa fa-github"> Edit on GitHub</a>
    </li> -->
    
  </ul>
</div>
            <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
              <div itemprop="articleBody">
                
  <div class="section" id="load-a-registered-model">
<h1>Load a Registered Model<a class="headerlink" href="#load-a-registered-model" title="Permalink to this headline"> </a></h1>
<p>To perform inference on a registered model version, we need to load it into memory. There are many
ways to find our model version, but the best method differs depending on the information you have
available. However, in the spirit of a quickstart, the below code snippet shows the simplest way to
load a model from the model registry via a specific model URI and perform inference.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mlflow.sklearn</span>
<span class="kn">from</span> <span class="nn">sklearn.datasets</span> <span class="kn">import</span> <span class="n">make_regression</span>

<span class="n">model_name</span> <span class="o">=</span> <span class="s2">&quot;sk-learn-random-forest-reg-model&quot;</span>
<span class="n">model_version</span> <span class="o">=</span> <span class="s2">&quot;latest&quot;</span>

<span class="c1"># Load the model from the Model Registry</span>
<span class="n">model_uri</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;models:/</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">model_version</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">mlflow</span><span class="o">.</span><span class="n">sklearn</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="n">model_uri</span><span class="p">)</span>

<span class="c1"># Generate a new dataset for prediction and predict</span>
<span class="n">X_new</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">make_regression</span><span class="p">(</span><span class="n">n_features</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">n_informative</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">y_pred_new</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X_new</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">y_pred_new</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that if youâ€™re not using sklearn, if your model flavor is supported, you should use the
specific model flavor load method e.g. <code class="docutils literal notranslate"><span class="pre">mlflow.&lt;flavor&gt;.load_model()</span></code>. If the model flavor is
not supported, you should leverage <a class="reference internal" href="../../python_api/mlflow.pyfunc.html#mlflow.pyfunc.load_model" title="mlflow.pyfunc.load_model"><code class="xref py py-func docutils literal notranslate"><span class="pre">mlflow.pyfunc.load_model()</span></code></a>. Throughout this tutorial
we leverage sklearn  for demonstration purposes.</p>
<div class="section" id="example-0-load-via-tracking-server">
<h2>Example 0: Load via Tracking Server<a class="headerlink" href="#example-0-load-via-tracking-server" title="Permalink to this headline"> </a></h2>
<p>A model URI is a unique identifier for a serialized model. Given the model artifact is stored with
experiments in the tracking server, you can use the below model URIs to bypass the model registry
and load the artifact into memory.</p>
<ol class="arabic simple">
<li><p><strong>Absolute local path</strong>: <code class="docutils literal notranslate"><span class="pre">mlflow.sklearn.load_model(&quot;/Users/me/path/to/local/model&quot;)</span></code></p></li>
<li><p><strong>Relative local path</strong>: <code class="docutils literal notranslate"><span class="pre">mlflow.sklearn.load_model(&quot;relative/path/to/local/model&quot;)</span></code></p></li>
<li><p><strong>Run id</strong>: <code class="docutils literal notranslate"><span class="pre">mlflow.sklearn.load_model(f&quot;runs:/{mlflow_run_id}/{run_relative_path_to_model}&quot;)</span></code></p></li>
</ol>
<p>However, unless youâ€™re in the same environment that you logged the model, you typically wonâ€™t have
the above information. Instead, you should load the model by leveraging the modelâ€™s name and
version.</p>
</div>
<div class="section" id="example-1-load-via-name-and-version">
<h2>Example 1: Load via Name and Version<a class="headerlink" href="#example-1-load-via-name-and-version" title="Permalink to this headline"> </a></h2>
<p>To load a model into memory via the <code class="docutils literal notranslate"><span class="pre">model_name</span></code> and monotonically increasing <code class="docutils literal notranslate"><span class="pre">model_version</span></code>,
use the below method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">mlflow</span><span class="o">.</span><span class="n">sklearn</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;models:/</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="n">model_version</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>While this method is quick and easy, the monotonically increasing model version lacks flexibility.
Often, itâ€™s more efficient to leverage a model version alias.</p>
</div>
<div class="section" id="example-2-load-via-model-version-alias">
<h2>Example 2: Load via Model Version Alias<a class="headerlink" href="#example-2-load-via-model-version-alias" title="Permalink to this headline"> </a></h2>
<p>Model version aliases are user-defined identifiers for a model version. Given theyâ€™re mutable after
model registration, they decouple model versions from the code that uses them.</p>
<p>For instance, letâ€™s say we have a model version alias called <code class="docutils literal notranslate"><span class="pre">production_model</span></code>, corresponding to
a production model. When our team builds a better model that is ready for deployment, we donâ€™t have
to change our serving workload code. Instead, in MLflow we reassign the <code class="docutils literal notranslate"><span class="pre">production_model</span></code> alias
from the old model version to the new one. This can be done simply in the UI. In the API, we run
<cite>client.set_registered_model_alias</cite> with the same model name, alias name, and <strong>new</strong> model version
ID. Itâ€™s that easy!</p>
<p>In the prior page, we added a model version alias to our model, but hereâ€™s a programmatic example.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mlflow.sklearn</span>
<span class="kn">from</span> <span class="nn">mlflow</span> <span class="kn">import</span> <span class="n">MlflowClient</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">MlflowClient</span><span class="p">()</span>

<span class="c1"># Set model version alias</span>
<span class="n">model_name</span> <span class="o">=</span> <span class="s2">&quot;sk-learn-random-forest-reg-model&quot;</span>
<span class="n">model_version_alias</span> <span class="o">=</span> <span class="s2">&quot;the_best_model_ever&quot;</span>
<span class="n">client</span><span class="o">.</span><span class="n">set_registered_model_alias</span><span class="p">(</span>
    <span class="n">model_name</span><span class="p">,</span> <span class="n">model_version_alias</span><span class="p">,</span> <span class="s2">&quot;1&quot;</span>
<span class="p">)</span>  <span class="c1"># Duplicate of step in UI</span>

<span class="c1"># Get informawtion about the model</span>
<span class="n">model_info</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_model_version_by_alias</span><span class="p">(</span><span class="n">model_name</span><span class="p">,</span> <span class="n">model_version_alias</span><span class="p">)</span>
<span class="n">model_tags</span> <span class="o">=</span> <span class="n">model_info</span><span class="o">.</span><span class="n">tags</span>
<span class="nb">print</span><span class="p">(</span><span class="n">model_tags</span><span class="p">)</span>

<span class="c1"># Get the model version using a model URI</span>
<span class="n">model_uri</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;models:/</span><span class="si">{</span><span class="n">model_name</span><span class="si">}</span><span class="s2">@</span><span class="si">{</span><span class="n">model_version_alias</span><span class="si">}</span><span class="s2">&quot;</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">mlflow</span><span class="o">.</span><span class="n">sklearn</span><span class="o">.</span><span class="n">load_model</span><span class="p">(</span><span class="n">model_uri</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">Output</span><a class="headerlink" href="#id1" title="Permalink to this code"> </a></div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>{&#39;problem_type&#39;: &#39;regression&#39;}
RandomForestRegressor(max_depth=2, random_state=42)
</pre></div>
</div>
</div>
<p>Model version alias is highly dynamic and can correspond to anything that is meaningful for your
team. The most common example is a deployment state. For instance, letâ€™s say we have a <code class="docutils literal notranslate"><span class="pre">champion</span></code>
model in production but are developing <code class="docutils literal notranslate"><span class="pre">challenger</span></code> model that will hopefully out-perform our
production model. You can use <code class="docutils literal notranslate"><span class="pre">champion</span></code> and <code class="docutils literal notranslate"><span class="pre">challenger</span></code> model version aliases to uniquely
identify these model versions for easy access.</p>
<p>Thatâ€™s it! You should now be comfortableâ€¦</p>
<ol class="arabic simple">
<li><p>Registering a model</p></li>
<li><p>Finding a model and modifying the tags and model version alias via the MLflow UI</p></li>
<li><p>Loading the registered model for inference</p></li>
</ol>
</div>
</div>


              </div>
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="step2-explore-registered-model.html" class="btn btn-neutral" title="Explore the Registered Model" accesskey="p"><span class="db-icon db-icon-chevron-left"></span> Previous</a>
      
      
        <a href="../logging-first-model/index.html" class="btn btn-neutral" title="Tutorial Overview" accesskey="n">Next <span class="db-icon db-icon-chevron-right"></span></a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
      <p class="copyright">
          &copy; MLflow Project, a Series of LF Projects, LLC. All rights reserved.
      </p>

  </div> 

</footer>
          </div>
        </div>
      </section>
    </main>
  </page>

  


  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT:'../../',
      VERSION:'2.14.4.dev0',
      COLLAPSE_INDEX:false,
      FILE_SUFFIX:'.html',
      LINK_SUFFIX: '.html',
      HAS_SOURCE:  true
    };
  </script>

  

  <script type="text/javascript" src="../../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../../_static/js/jquery.waypoints.min.js"></script>

  
  
  
  <script type="text/javascript">var CLIPPY_SVG_PATH = "../../_static/clippy.svg";</script>
  <script type="text/javascript" src="../../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  

  
  <script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
        function copyToClipboard(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
        }
        // Get the code block designator class entries
        const allHighlights = document.querySelectorAll('.highlight');
        // Disable copyable links for notebook cell numbering and for cell outputs
        const highlights = Array.from(allHighlights).filter(highlight => !highlight.closest('.highlight-none') && 
            !highlight.closest('.nboutput'));
    
        highlights.forEach(function(highlight) {
            const copyIcon = document.createElement('span');
            copyIcon.classList.add('copy-icon');
            copyIcon.innerHTML = '&#xf0ea;';

            copyIcon.addEventListener('click', function() {
                const code = highlight.querySelector('pre').textContent;
                copyToClipboard(code);

                // Flash effect on click
                this.style.color = '#0194E2';
                setTimeout(() => {
                    this.style.color = ''; 
                }, 100);

                // Display "Code copied to clipboard" near the clicked icon
                const message = document.createElement('span');
                message.textContent = "Copied!";
                message.classList.add('copy-message'); 

                // Append the message to the icon
                this.appendChild(message);

                setTimeout(() => {
                    this.removeChild(message);
                }, 500);
            });

            highlight.appendChild(copyIcon);
        });
    });
  </script>


<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
        // Force download for notebook-download-btn
        const downloadButtons = document.querySelectorAll('.notebook-download-btn');
        downloadButtons.forEach(function(button) {
            button.addEventListener('click', function(event) {
                event.preventDefault(); // Prevent default behavior

                // Fetch the raw content of the notebook from GitHub
                fetch(button.href)
                    .then(response => response.blob())
                    .then(blob => {
                        const url = window.URL.createObjectURL(blob);
                        const link = document.createElement('a');
                        link.style.display = 'none';
                        link.href = url;
                        const filename = button.href.split('/').pop();
                        link.download = filename; 

                        document.body.appendChild(link);
                        link.click();

                        window.URL.revokeObjectURL(url);
                        document.body.removeChild(link);
                    })
                    .catch(err => console.error('Error fetching the notebook:', err));
            });
        });
    });
</script> 
</body>
</html>