"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[6251],{28453:(e,t,l)=>{l.d(t,{R:()=>o,x:()=>i});var a=l(96540);const n={},r=a.createContext(n);function o(e){const t=a.useContext(r);return a.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function i(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(n):e.components||n:o(e.components),a.createElement(r.Provider,{value:t},e.children)}},43057:(e,t,l)=>{l.r(t),l.d(t,{assets:()=>s,contentTitle:()=>p,default:()=>h,frontMatter:()=>i,metadata:()=>a,toc:()=>m});const a=JSON.parse('{"id":"tracing/integrations/listing/mastra","title":"Tracing Mastra","description":"MLflow Tracing provides automatic tracing capability for Mastra, a flexible and modular AI agents framework developed by Mastra. MLflow supports tracing for Mastra through the OpenTelemetry integration.","source":"@site/docs/genai/tracing/integrations/listing/mastra.mdx","sourceDirName":"tracing/integrations/listing","slug":"/tracing/integrations/listing/mastra","permalink":"/mlflow-website/docs/latest/genai/tracing/integrations/listing/mastra","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6,"sidebar_label":"Mastra"},"sidebar":"genAISidebar","previous":{"title":"LlamaIndex","permalink":"/mlflow-website/docs/latest/genai/tracing/integrations/listing/llama_index"},"next":{"title":"Microsoft Agent Framework","permalink":"/mlflow-website/docs/latest/genai/tracing/integrations/listing/microsoft-agent-framework"}}');var n=l(74848),r=l(28453),o=(l(49374),l(66927));const i={sidebar_position:6,sidebar_label:"Mastra"},p="Tracing Mastra",s={},m=[{value:"Step 1: Create a new Mastra agent",id:"step-1-create-a-new-mastra-agent",level:2},{value:"Step 2: Start the MLflow Tracking Server",id:"step-2-start-the-mlflow-tracking-server",level:2},{value:"Step 3: Configure OpenTelemetry",id:"step-3-configure-opentelemetry",level:2},{value:"Step 4: Run the Agent",id:"step-4-run-the-agent",level:2},{value:"Next Steps",id:"next-steps",level:2}];function c(e){const t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,r.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(t.header,{children:(0,n.jsx)(t.h1,{id:"tracing-mastra",children:"Tracing Mastra"})}),"\n",(0,n.jsx)(o.A,{src:"/images/llms/tracing/mastra-tracing.png",alt:"Mastra Tracing"}),"\n",(0,n.jsxs)(t.p,{children:[(0,n.jsx)(t.a,{href:"/genai/tracing",children:"MLflow Tracing"})," provides automatic tracing capability for ",(0,n.jsx)(t.a,{href:"https://github.com/mastra-ai/mastra",children:"Mastra"}),", a flexible and modular AI agents framework developed by Mastra. MLflow supports tracing for Mastra through the ",(0,n.jsx)(t.a,{href:"/genai/tracing/opentelemetry",children:"OpenTelemetry"})," integration."]}),"\n",(0,n.jsx)(t.h2,{id:"step-1-create-a-new-mastra-agent",children:"Step 1: Create a new Mastra agent"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"npm create mastra@laster\n"})}),"\n",(0,n.jsx)(t.p,{children:"This will create a new TypeScript project with a simple tool calling agent implementation."}),"\n",(0,n.jsx)(t.h2,{id:"step-2-start-the-mlflow-tracking-server",children:"Step 2: Start the MLflow Tracking Server"}),"\n",(0,n.jsx)(t.p,{children:"Start the MLflow Tracking Server with a SQL-based backend store:"}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-bash",children:"mlflow server --backend-store-uri sqlite:///mlflow.db --port 5000\n"})}),"\n",(0,n.jsxs)(t.p,{children:["This example uses SQLite as the backend store. To use other types of SQL databases such as PostgreSQL, MySQL, and MSSQL, change the store URI as described in the ",(0,n.jsx)(t.a,{href:"/self-hosting/architecture/backend-store",children:"backend store documentation"}),". OpenTelemetry ingestion is not supported with file-based backend stores."]}),"\n",(0,n.jsx)(t.h2,{id:"step-3-configure-opentelemetry",children:"Step 3: Configure OpenTelemetry"}),"\n",(0,n.jsx)(t.p,{children:"Configure the OpenTelemetry tracer in your Mastra agent to export traces to the MLflow Tracking Server endpoint."}),"\n",(0,n.jsxs)(t.p,{children:["Open the ",(0,n.jsx)(t.code,{children:"src/mastra/index.ts"})," file and add the ",(0,n.jsx)(t.code,{children:"observability"})," configuration to the ",(0,n.jsx)(t.code,{children:"Mastra"})," agent instantiation."]}),"\n",(0,n.jsx)(t.pre,{children:(0,n.jsx)(t.code,{className:"language-typescript",children:'export const mastra = new Mastra({\n  workflows: { weatherWorkflow },\n  ...\n\n  // Add the following observability configuration to enable OpenTelemetry tracing.\n  observability: {\n    configs: {\n      otel: {\n        serviceName: "maestra-app",\n        exporters: [new OtelExporter({\n          provider: {\n            custom: {\n              // Specify tracking server URI with the `/v1/traces` path.\n              endpoint: "http://localhost:5000/v1/traces",\n              // Set the MLflow experiment ID in the header.\n              headers: { "x-mlflow-experiment-id": "<your-experiment-id>"},\n              // MLflow support HTTP/Protobuf protocol.\n              protocol: "http/protobuf"\n            }\n          }\n        })]\n      }\n    }\n  },\n});\n'})}),"\n",(0,n.jsx)(t.h2,{id:"step-4-run-the-agent",children:"Step 4: Run the Agent"}),"\n",(0,n.jsxs)(t.p,{children:["Start the Mastra agent with the ",(0,n.jsx)(t.code,{children:"npm run dev"})," command. The playground URL will be displayed in the console."]}),"\n",(0,n.jsx)(o.A,{src:"/images/llms/tracing/mastra-playground.png",alt:"Mastra Playground"}),"\n",(0,n.jsxs)(t.p,{children:["After chatting with the agent, open the MLflow UI at ",(0,n.jsx)(t.code,{children:"http://localhost:5000"})," and navigate to the experiment to see the traces like the screenshot at the top of this page."]}),"\n",(0,n.jsx)(t.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,n.jsxs)(t.ul,{children:["\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"/genai/eval-monitor/running-evaluation/agents",children:"Evaluate the Agent"}),": Learn how to evaluate the agent's performance."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"/genai/prompt-registry",children:"Manage Prompts"}),": Learn how to manage prompts for the agent."]}),"\n",(0,n.jsxs)(t.li,{children:[(0,n.jsx)(t.a,{href:"/genai/prompt-registry/optimize-prompts",children:"Automatic Agent Optimization"}),": Learn how to automatically optimize the agent end-to-end with state-of-the-art optimization algorithms."]}),"\n"]})]})}function h(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,n.jsx)(t,{...e,children:(0,n.jsx)(c,{...e})}):c(e)}},49374:(e,t,l)=>{l.d(t,{B:()=>i});l(96540);const a=JSON.parse('{"mlflow.ag2":"api_reference/python_api/mlflow.ag2.html","mlflow.agno":"api_reference/python_api/mlflow.agno.html","mlflow.anthropic":"api_reference/python_api/mlflow.anthropic.html","mlflow.artifacts":"api_reference/python_api/mlflow.artifacts.html","mlflow.autogen":"api_reference/python_api/mlflow.autogen.html","mlflow.bedrock":"api_reference/python_api/mlflow.bedrock.html","mlflow.catboost":"api_reference/python_api/mlflow.catboost.html","mlflow.client":"api_reference/python_api/mlflow.client.html","mlflow.config":"api_reference/python_api/mlflow.config.html","mlflow.crewai":"api_reference/python_api/mlflow.crewai.html","mlflow.data":"api_reference/python_api/mlflow.data.html","mlflow.deployments":"api_reference/python_api/mlflow.deployments.html","mlflow.diviner":"api_reference/python_api/mlflow.diviner.html","mlflow.dspy":"api_reference/python_api/mlflow.dspy.html","mlflow.entities":"api_reference/python_api/mlflow.entities.html","mlflow.environment_variables":"api_reference/python_api/mlflow.environment_variables.html","mlflow.gateway":"api_reference/python_api/mlflow.gateway.html","mlflow.gemini":"api_reference/python_api/mlflow.gemini.html","mlflow.genai":"api_reference/python_api/mlflow.genai.html","mlflow.groq":"api_reference/python_api/mlflow.groq.html","mlflow.h2o":"api_reference/python_api/mlflow.h2o.html","mlflow.johnsnowlabs":"api_reference/python_api/mlflow.johnsnowlabs.html","mlflow.keras":"api_reference/python_api/mlflow.keras.html","mlflow.langchain":"api_reference/python_api/mlflow.langchain.html","mlflow.lightgbm":"api_reference/python_api/mlflow.lightgbm.html","mlflow.litellm":"api_reference/python_api/mlflow.litellm.html","mlflow.llama_index":"api_reference/python_api/mlflow.llama_index.html","mlflow.metrics":"api_reference/python_api/mlflow.metrics.html","mlflow.mistral":"api_reference/python_api/mlflow.mistral.html","mlflow.models":"api_reference/python_api/mlflow.models.html","mlflow.onnx":"api_reference/python_api/mlflow.onnx.html","mlflow.openai":"api_reference/python_api/mlflow.openai.html","mlflow.paddle":"api_reference/python_api/mlflow.paddle.html","mlflow.pmdarima":"api_reference/python_api/mlflow.pmdarima.html","mlflow.projects":"api_reference/python_api/mlflow.projects.html","mlflow.promptflow":"api_reference/python_api/mlflow.promptflow.html","mlflow.prophet":"api_reference/python_api/mlflow.prophet.html","mlflow.pydantic_ai":"api_reference/python_api/mlflow.pydantic_ai.html","mlflow.pyfunc":"api_reference/python_api/mlflow.pyfunc.html","mlflow.pyspark.ml":"api_reference/python_api/mlflow.pyspark.ml.html","mlflow.pytorch":"api_reference/python_api/mlflow.pytorch.html","mlflow":"api_reference/python_api/mlflow.html","mlflow.sagemaker":"api_reference/python_api/mlflow.sagemaker.html","mlflow.sentence_transformers":"api_reference/python_api/mlflow.sentence_transformers.html","mlflow.server":"api_reference/python_api/mlflow.server.html","mlflow.shap":"api_reference/python_api/mlflow.shap.html","mlflow.sklearn":"api_reference/python_api/mlflow.sklearn.html","mlflow.smolagents":"api_reference/python_api/mlflow.smolagents.html","mlflow.spacy":"api_reference/python_api/mlflow.spacy.html","mlflow.spark":"api_reference/python_api/mlflow.spark.html","mlflow.statsmodels":"api_reference/python_api/mlflow.statsmodels.html","mlflow.system_metrics":"api_reference/python_api/mlflow.system_metrics.html","mlflow.tensorflow":"api_reference/python_api/mlflow.tensorflow.html","mlflow.tracing":"api_reference/python_api/mlflow.tracing.html","mlflow.transformers":"api_reference/python_api/mlflow.transformers.html","mlflow.types":"api_reference/python_api/mlflow.types.html","mlflow.utils":"api_reference/python_api/mlflow.utils.html","mlflow.webhooks":"api_reference/python_api/mlflow.webhooks.html","mlflow.xgboost":"api_reference/python_api/mlflow.xgboost.html","mlflow.server.auth":"api_reference/auth/python-api.html","mlflow.server.cli":"api_reference/cli.html","mlflow.r":"api_reference/R-api.html","mlflow.java":"api_reference/java_api/index.html","mlflow.python":"api_reference/python_api/index.html","mlflow.rest":"api_reference/rest-api.html","mlflow.typescript":"api_reference/typescript_api/index.html","mlflow.llms.deployments.api":"api_reference/llms/deployments/api.html"}');var n=l(86025),r=l(74848);const o=e=>{const t=e.split(".");for(let l=t.length;l>0;l--){const e=t.slice(0,l).join(".");if(a[e])return e}return null};function i({fn:e,children:t,hash:l}){const i=o(e);if(!i)return(0,r.jsx)(r.Fragment,{children:t});const p=(0,n.default)(`/${a[i]}#${l??e}`);return(0,r.jsx)("a",{href:p,target:"_blank",children:t??(0,r.jsxs)("code",{children:[e,"()"]})})}},66927:(e,t,l)=>{l.d(t,{A:()=>o});l(96540);const a={container:"container_JwLF",imageWrapper:"imageWrapper_RfGN",image:"image_bwOA",caption:"caption_jo2G"};var n=l(86025),r=l(74848);function o({src:e,alt:t,width:l,caption:o,className:i}){return(0,r.jsxs)("div",{className:`${a.container} ${i||""}`,children:[(0,r.jsx)("div",{className:a.imageWrapper,style:l?{width:l}:{},children:(0,r.jsx)("img",{src:(0,n.default)(e),alt:t,className:a.image})}),o&&(0,r.jsx)("p",{className:a.caption,children:o})]})}}}]);