"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([["7265"],{41774(e,n,i){i.r(n),i.d(n,{metadata:()=>l,default:()=>x,frontMatter:()=>h,contentTitle:()=>g,toc:()=>u,assets:()=>f});var l=JSON.parse('{"id":"deep-learning/spacy/index","title":"MLflow spaCy Integration","description":"Introduction","source":"@site/docs/classic-ml/deep-learning/spacy/index.mdx","sourceDirName":"deep-learning/spacy","slug":"/deep-learning/spacy/","permalink":"/mlflow-website/docs/latest/ml/deep-learning/spacy/","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3,"sidebar_label":"spaCy"},"sidebar":"classicMLSidebar","previous":{"title":"Paraphrase Mining","permalink":"/mlflow-website/docs/latest/ml/deep-learning/sentence-transformers/tutorials/paraphrase-mining/paraphrase-mining-sentence-transformers"},"next":{"title":"Overview","permalink":"/mlflow-website/docs/latest/ml/tracking/"}}'),t=i(74848),a=i(28453),r=i(33508),o=i(10440),s=i(77541),d=i(17133),c=i(61878),p=i(46858),m=i(60665);let h={sidebar_position:3,sidebar_label:"spaCy"},g="MLflow spaCy Integration",f={},u=[{value:"Introduction",id:"introduction",level:2},{value:"Why MLflow + spaCy?",id:"why-mlflow--spacy",level:2},{value:"Model Logging",id:"model-logging",level:2},{value:"Custom Training with MLflow",id:"custom-training-with-mlflow",level:2},{value:"Model Loading",id:"model-loading",level:2},{value:"Learn More",id:"learn-more",level:2}];function y(e){let n={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"mlflow-spacy-integration",children:"MLflow spaCy Integration"})}),"\n",(0,t.jsx)(n.h2,{id:"introduction",children:"Introduction"}),"\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"spaCy"})," is an industrial-strength natural language processing library designed for production use. It provides pre-trained models and efficient processing pipelines for tasks like named entity recognition, part-of-speech tagging, and text classification."]}),"\n",(0,t.jsx)(n.p,{children:"MLflow's spaCy integration provides model logging, versioning, and deployment capabilities for NLP workflows."}),"\n",(0,t.jsx)(n.h2,{id:"why-mlflow--spacy",children:"Why MLflow + spaCy?"}),"\n",(0,t.jsx)(r.A,{features:[{icon:d.A,title:"Model Packaging",description:"Log spaCy models with all pipeline components and dependencies automatically captured."},{icon:c.A,title:"Experiment Tracking",description:"Track NLP metrics, model performance, and training configurations across experiments."},{icon:p.A,title:"Easy Deployment",description:"Deploy spaCy models as REST APIs or batch inference pipelines with MLflow serving."},{icon:m.A,title:"Version Control",description:"Manage different model versions and pipeline configurations with MLflow's model registry."}]}),"\n",(0,t.jsx)(n.h2,{id:"model-logging",children:"Model Logging"}),"\n",(0,t.jsx)(n.p,{children:"Log spaCy models to MLflow:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'import mlflow\nimport spacy\n\n# Load or train your spaCy model\nnlp = spacy.load("en_core_web_sm")\n\n# Log to MLflow\nmodel_info = mlflow.spacy.log_model(nlp, name="spacy_model")\n'})}),"\n",(0,t.jsx)(n.h2,{id:"custom-training-with-mlflow",children:"Custom Training with MLflow"}),"\n",(0,t.jsx)(n.p,{children:"Track custom spaCy training with MLflow:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'import mlflow\nimport spacy\nfrom spacy.training import Example\n\n# Load base model\nnlp = spacy.blank("en")\nnlp.add_pipe("ner")\n\n# Sample training data\nTRAIN_DATA = [\n    ("Apple is a tech company", {"entities": [(0, 5, "ORG")]}),\n    ("Google acquired YouTube", {"entities": [(0, 6, "ORG"), (16, 23, "PRODUCT")]}),\n]\n\n# Convert to Examples\nexamples = [\n    Example.from_dict(nlp.make_doc(text), annotations)\n    for text, annotations in TRAIN_DATA\n]\n\n# Initialize and train\noptimizer = nlp.initialize()\n\nwith mlflow.start_run():\n    mlflow.log_params(\n        {\n            "model": "blank_en",\n            "pipeline": "ner",\n        }\n    )\n\n    for epoch in range(10):\n        losses = {}\n        for example in examples:\n            nlp.update([example], sgd=optimizer, losses=losses)\n\n        mlflow.log_metric("loss", losses["ner"], step=epoch)\n\n    # Log the trained model\n    mlflow.spacy.log_model(nlp, name="custom_ner_model")\n'})}),"\n",(0,t.jsx)(n.h2,{id:"model-loading",children:"Model Loading"}),"\n",(0,t.jsx)(n.p,{children:"Load spaCy models from MLflow:"}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'import mlflow\n\n# Load as spaCy model\nnlp = mlflow.spacy.load_model("models:/<model_id>")\ndoc = nlp("Apple is looking at buying a startup")\n\n# Load as PyFunc for deployment\npredictor = mlflow.pyfunc.load_model("models:/<model_id>")\npredictions = predictor.predict(["Text to process"])\n'})}),"\n",(0,t.jsx)(n.h2,{id:"learn-more",children:"Learn More"}),"\n",(0,t.jsxs)(o.A,{children:[(0,t.jsx)(s.A,{icon:d.A,title:"Model Registry",description:"Version and manage spaCy models",href:"/ml/model-registry"}),(0,t.jsx)(s.A,{icon:c.A,title:"MLflow Tracking",description:"Track experiments, parameters, and metrics",href:"/ml/tracking"})]})]})}function x(e={}){let{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(y,{...e})}):y(e)}},75689(e,n,i){i.d(n,{A:()=>s});var l=i(96540);let t=e=>{let n=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,n,i)=>i?i.toUpperCase():n.toLowerCase());return n.charAt(0).toUpperCase()+n.slice(1)},a=(...e)=>e.filter((e,n,i)=>!!e&&""!==e.trim()&&i.indexOf(e)===n).join(" ").trim();var r={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,l.forwardRef)(({color:e="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:t,className:o="",children:s,iconNode:d,...c},p)=>(0,l.createElement)("svg",{ref:p,...r,width:n,height:n,stroke:e,strokeWidth:t?24*Number(i)/Number(n):i,className:a("lucide",o),...!s&&!(e=>{for(let n in e)if(n.startsWith("aria-")||"role"===n||"title"===n)return!0})(c)&&{"aria-hidden":"true"},...c},[...d.map(([e,n])=>(0,l.createElement)(e,n)),...Array.isArray(s)?s:[s]])),s=(e,n)=>{let i=(0,l.forwardRef)(({className:i,...r},s)=>(0,l.createElement)(o,{ref:s,iconNode:n,className:a(`lucide-${t(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,i),...r}));return i.displayName=t(e),i}},60665(e,n,i){i.d(n,{A:()=>l});let l=(0,i(75689).A)("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]])},61878(e,n,i){i.d(n,{A:()=>l});let l=(0,i(75689).A)("git-branch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]])},17133(e,n,i){i.d(n,{A:()=>l});let l=(0,i(75689).A)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},46858(e,n,i){i.d(n,{A:()=>l});let l=(0,i(75689).A)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},33508(e,n,i){i.d(n,{A:()=>t});var l=i(74848);i(96540);function t({features:e,col:n=2}){return(0,l.jsx)("div",{className:"featureHighlights_Ardf",style:{gridTemplateColumns:`repeat(${n}, 1fr)`},children:e.map((e,n)=>(0,l.jsxs)("div",{className:"highlightItem_XPnN",children:[e.icon&&(0,l.jsx)("div",{className:"highlightIcon_SUR8",children:(0,l.jsx)(e.icon,{size:24})}),(0,l.jsxs)("div",{className:"highlightContent_d0XP",children:[(0,l.jsx)("h4",{children:e.title}),(0,l.jsx)("p",{children:e.description})]})]},n))})}},77541(e,n,i){i.d(n,{A:()=>d});var l=i(74848);i(96540);var t=i(95310),a=i(34164);let r="tileImage_O4So";var o=i(66497),s=i(92802);function d({icon:e,image:n,imageDark:i,imageWidth:d,imageHeight:c,iconSize:p=32,containerHeight:m,title:h,description:g,href:f,linkText:u="Learn more \u2192",className:y}){if(!e&&!n)throw Error("TileCard requires either an icon or image prop");let x=m?{height:`${m}px`}:{},w={};return d&&(w.width=`${d}px`),c&&(w.height=`${c}px`),(0,l.jsxs)(t.A,{href:f,className:(0,a.A)("tileCard_NHsj",y),children:[(0,l.jsx)("div",{className:"tileIcon_pyoR",style:x,children:e?(0,l.jsx)(e,{size:p}):i?(0,l.jsx)(s.A,{sources:{light:(0,o.default)(n),dark:(0,o.default)(i)},alt:h,className:r,style:w}):(0,l.jsx)("img",{src:(0,o.default)(n),alt:h,className:r,style:w})}),(0,l.jsx)("h3",{children:h}),(0,l.jsx)("p",{children:g}),(0,l.jsx)("div",{className:"tileLink_iUbu",children:u})]})}},10440(e,n,i){i.d(n,{A:()=>a});var l=i(74848);i(96540);var t=i(34164);function a({children:e,className:n}){return(0,l.jsx)("div",{className:(0,t.A)("tilesGrid_hB9N",n),children:e})}},28453(e,n,i){i.d(n,{R:()=>r,x:()=>o});var l=i(96540);let t={},a=l.createContext(t);function r(e){let n=l.useContext(a);return l.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:r(e.components),l.createElement(a.Provider,{value:n},e.children)}}}]);