"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([["5653"],{93496(e,n,i){i.r(n),i.d(n,{metadata:()=>t,default:()=>h,frontMatter:()=>l,contentTitle:()=>a,toc:()=>o,assets:()=>d});var t=JSON.parse('{"id":"eval-monitor/scorers/llm-judge/gepa","title":"GEPA Alignment Optimizer","description":"MLflow provides the GEPA alignment optimizer using DSPy\'s implementation of GEPA (Genetic-Pareto). GEPA uses LLM-driven reflection to analyze execution traces and iteratively propose improved judge instructions based on human feedback.","source":"@site/docs/genai/eval-monitor/scorers/llm-judge/gepa.mdx","sourceDirName":"eval-monitor/scorers/llm-judge","slug":"/eval-monitor/scorers/llm-judge/gepa","permalink":"/mlflow-website/docs/latest/genai/eval-monitor/scorers/llm-judge/gepa","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{}}'),s=i(74848),r=i(28453);let l={},a="GEPA Alignment Optimizer",d={},o=[{value:"Requirements",id:"requirements",level:2},{value:"Basic Usage",id:"basic-usage",level:2},{value:"Parameters",id:"parameters",level:2},{value:"When to Use GEPA",id:"when-to-use-gepa",level:2},{value:"Debugging",id:"debugging",level:2}];function c(e){let n={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"gepa-alignment-optimizer",children:"GEPA Alignment Optimizer"})}),"\n",(0,s.jsxs)(n.p,{children:["MLflow provides the ",(0,s.jsx)(n.strong,{children:"GEPA alignment optimizer"})," using ",(0,s.jsx)(n.a,{href:"https://dspy.ai/api/optimizers/GEPA/overview/",children:"DSPy's implementation of GEPA"})," (Genetic-Pareto). GEPA uses LLM-driven reflection to analyze execution traces and iteratively propose improved judge instructions based on human feedback."]}),"\n",(0,s.jsx)(n.h2,{id:"requirements",children:"Requirements"}),"\n",(0,s.jsx)(n.p,{children:"For alignment to work:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Traces must contain human assessments (labels) with the same name as the judge"}),"\n",(0,s.jsx)(n.li,{children:"Natural language feedback (rationale) is highly recommended for better alignment"}),"\n",(0,s.jsx)(n.li,{children:"Minimum of 10 traces with human assessments required"}),"\n",(0,s.jsx)(n.li,{children:"A mix of positive and negative labels is recommended"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"basic-usage",children:"Basic Usage"}),"\n",(0,s.jsxs)(n.p,{children:["See ",(0,s.jsx)(n.a,{href:"/genai/eval-monitor/scorers/llm-judge/custom-judges",children:"make_judge documentation"})," for details on creating judges."]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'import mlflow\nfrom mlflow.genai.judges import make_judge\nfrom mlflow.genai.judges.optimizers import GEPAAlignmentOptimizer\n\njudge = make_judge(\n    name="politeness",\n    instructions=(\n        "Given a user question, evaluate if the chatbot\'s response is polite and respectful. "\n        "Consider the tone, language, and context of the response.\\n\\n"\n        "Question: {{ inputs }}\\n"\n        "Response: {{ outputs }}"\n    ),\n    feedback_value_type=bool,\n    model="openai:/gpt-5-mini",\n)\n\ntraces_with_feedback = mlflow.search_traces(return_type="list")\n\noptimizer = GEPAAlignmentOptimizer(\n    model="openai:/gpt-5-mini",\n    max_metric_calls=100,\n)\naligned_judge = judge.align(traces_with_feedback, optimizer)\n'})}),"\n",(0,s.jsx)(n.h2,{id:"parameters",children:"Parameters"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Parameter"}),(0,s.jsx)(n.th,{children:"Type"}),(0,s.jsx)(n.th,{children:"Default"}),(0,s.jsx)(n.th,{children:"Description"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"model"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"str"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"None"})}),(0,s.jsx)(n.td,{children:"Model used for reflection. If None, uses the default model."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"max_metric_calls"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"int"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"None"})}),(0,s.jsx)(n.td,{children:"Maximum evaluation calls during optimization. If None, automatically set to 4x the number of training examples."})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"gepa_kwargs"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"dict"})}),(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"None"})}),(0,s.jsxs)(n.td,{children:["Additional keyword arguments passed directly to ",(0,s.jsx)(n.code,{children:"dspy.GEPA()"})," for advanced configuration."]})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"when-to-use-gepa",children:"When to Use GEPA"}),"\n",(0,s.jsx)(n.p,{children:"GEPA is particularly effective when:"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Complex evaluation criteria"}),": Your judge needs to understand nuanced, context-dependent quality standards"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Rich textual feedback"}),": Human reviewers provide detailed explanations for their assessments"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Iterative refinement"}),": You want the optimizer to learn from failures and propose targeted improvements"]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["For simpler alignment tasks, consider using the default ",(0,s.jsx)(n.a,{href:"/genai/eval-monitor/scorers/llm-judge/simba",children:"SIMBA optimizer"}),"."]}),"\n",(0,s.jsx)(n.h2,{id:"debugging",children:"Debugging"}),"\n",(0,s.jsx)(n.p,{children:"To debug the optimization process, enable DEBUG logging:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:'import logging\n\nlogging.getLogger("mlflow.genai.judges.optimizers.gepa").setLevel(logging.DEBUG)\naligned_judge = judge.align(traces_with_feedback, optimizer)\n'})})]})}function h(e={}){let{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}},28453(e,n,i){i.d(n,{R:()=>l,x:()=>a});var t=i(96540);let s={},r=t.createContext(s);function l(e){let n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);