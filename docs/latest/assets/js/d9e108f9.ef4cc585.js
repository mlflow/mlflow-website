"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([["904"],{93985(e,t,n){n.r(t),n.d(t,{metadata:()=>a,default:()=>h,frontMatter:()=>o,contentTitle:()=>l,toc:()=>p,assets:()=>c});var a=JSON.parse('{"id":"tracing/integrations/listing/mastra","title":"Tracing Mastra","description":"MLflow Tracing provides automatic tracing capability for Mastra, a flexible and modular AI agents framework developed by Mastra. MLflow supports tracing for Mastra through the OpenTelemetry integration.","source":"@site/docs/genai/tracing/integrations/listing/mastra.mdx","sourceDirName":"tracing/integrations/listing","slug":"/tracing/integrations/listing/mastra","permalink":"/mlflow-website/docs/latest/genai/tracing/integrations/listing/mastra","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6,"sidebar_label":"Mastra"},"sidebar":"genAISidebar","previous":{"title":"LlamaIndex","permalink":"/mlflow-website/docs/latest/genai/tracing/integrations/listing/llama_index"},"next":{"title":"Microsoft Agent Framework","permalink":"/mlflow-website/docs/latest/genai/tracing/integrations/listing/microsoft-agent-framework"}}'),r=n(74848),i=n(28453),s=n(46077);let o={sidebar_position:6,sidebar_label:"Mastra"},l="Tracing Mastra",c={},p=[{value:"Step 1: Create a new Mastra agent",id:"step-1-create-a-new-mastra-agent",level:2},{value:"Step 2: Start the MLflow Tracking Server",id:"step-2-start-the-mlflow-tracking-server",level:2},{value:"Step 3: Configure OpenTelemetry",id:"step-3-configure-opentelemetry",level:2},{value:"Step 4: Run the Agent",id:"step-4-run-the-agent",level:2},{value:"Next Steps",id:"next-steps",level:2}];function d(e){let t={a:"a",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(t.header,{children:(0,r.jsx)(t.h1,{id:"tracing-mastra",children:"Tracing Mastra"})}),"\n",(0,r.jsx)(s.A,{src:"/images/llms/tracing/mastra-tracing.png",alt:"Mastra Tracing"}),"\n",(0,r.jsxs)(t.p,{children:[(0,r.jsx)(t.a,{href:"/genai/tracing",children:"MLflow Tracing"})," provides automatic tracing capability for ",(0,r.jsx)(t.a,{href:"https://github.com/mastra-ai/mastra",children:"Mastra"}),", a flexible and modular AI agents framework developed by Mastra. MLflow supports tracing for Mastra through the ",(0,r.jsx)(t.a,{href:"/genai/tracing/opentelemetry",children:"OpenTelemetry"})," integration."]}),"\n",(0,r.jsx)(t.h2,{id:"step-1-create-a-new-mastra-agent",children:"Step 1: Create a new Mastra agent"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"npm create mastra@latest\nnpm install @mastra/otel-exporter\n"})}),"\n",(0,r.jsx)(t.p,{children:"This will create a new TypeScript project with a simple tool calling agent implementation."}),"\n",(0,r.jsx)(t.h2,{id:"step-2-start-the-mlflow-tracking-server",children:"Step 2: Start the MLflow Tracking Server"}),"\n",(0,r.jsx)(t.p,{children:"Start the MLflow Tracking Server with a SQL-based backend store:"}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-bash",children:"mlflow server --backend-store-uri sqlite:///mlflow.db --port 5000\n"})}),"\n",(0,r.jsxs)(t.p,{children:["This example uses SQLite as the backend store. To use other types of SQL databases such as PostgreSQL, MySQL, and MSSQL, change the store URI as described in the ",(0,r.jsx)(t.a,{href:"/self-hosting/architecture/backend-store",children:"backend store documentation"}),". OpenTelemetry ingestion is not supported with file-based backend stores."]}),"\n",(0,r.jsx)(t.h2,{id:"step-3-configure-opentelemetry",children:"Step 3: Configure OpenTelemetry"}),"\n",(0,r.jsx)(t.p,{children:"Configure the OpenTelemetry tracer in your Mastra agent to export traces to the MLflow Tracking Server endpoint."}),"\n",(0,r.jsxs)(t.p,{children:["Open the ",(0,r.jsx)(t.code,{children:"src/mastra/index.ts"})," file and add the ",(0,r.jsx)(t.code,{children:"observability"})," configuration to the ",(0,r.jsx)(t.code,{children:"Mastra"})," agent instantiation."]}),"\n",(0,r.jsx)(t.pre,{children:(0,r.jsx)(t.code,{className:"language-typescript",children:'import { OtelExporter } from "@mastra/otel-exporter";\n\nexport const mastra = new Mastra({\n  workflows: { weatherWorkflow },\n  ...\n\n  // Add the following observability configuration to enable OpenTelemetry tracing.\n  observability: {\n    configs: {\n      otel: {\n        serviceName: "maestra-app",\n        exporters: [new OtelExporter({\n          provider: {\n            custom: {\n              // Specify tracking server URI with the `/v1/traces` path.\n              endpoint: "http://localhost:5000/v1/traces",\n              // Set the MLflow experiment ID in the header.\n              headers: { "x-mlflow-experiment-id": "<your-experiment-id>"},\n              // MLflow support HTTP/Protobuf protocol.\n              protocol: "http/protobuf"\n            }\n          }\n        })]\n      }\n    }\n  },\n});\n'})}),"\n",(0,r.jsx)(t.h2,{id:"step-4-run-the-agent",children:"Step 4: Run the Agent"}),"\n",(0,r.jsxs)(t.p,{children:["Start the Mastra agent with the ",(0,r.jsx)(t.code,{children:"npm run dev"})," command. The playground URL will be displayed in the console."]}),"\n",(0,r.jsx)(s.A,{src:"/images/llms/tracing/mastra-playground.png",alt:"Mastra Playground"}),"\n",(0,r.jsxs)(t.p,{children:["After chatting with the agent, open the MLflow UI at ",(0,r.jsx)(t.code,{children:"http://localhost:5000"})," and navigate to the experiment to see the traces like the screenshot at the top of this page."]}),"\n",(0,r.jsx)(t.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,r.jsxs)(t.ul,{children:["\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.a,{href:"/genai/eval-monitor/running-evaluation/agents",children:"Evaluate the Agent"}),": Learn how to evaluate the agent's performance."]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.a,{href:"/genai/prompt-registry",children:"Manage Prompts"}),": Learn how to manage prompts for the agent."]}),"\n",(0,r.jsxs)(t.li,{children:[(0,r.jsx)(t.a,{href:"/genai/prompt-registry/optimize-prompts",children:"Automatic Agent Optimization"}),": Learn how to automatically optimize the agent end-to-end with state-of-the-art optimization algorithms."]}),"\n"]})]})}function h(e={}){let{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,r.jsx)(t,{...e,children:(0,r.jsx)(d,{...e})}):d(e)}},46077(e,t,n){n.d(t,{A:()=>i});var a=n(74848);n(96540);var r=n(66497);function i({src:e,alt:t,width:n,caption:i,className:s}){return(0,a.jsxs)("div",{className:`container_JwLF ${s||""}`,children:[(0,a.jsx)("div",{className:"imageWrapper_RfGN",style:n?{width:n}:{},children:(0,a.jsx)("img",{src:(0,r.default)(e),alt:t,className:"image_bwOA"})}),i&&(0,a.jsx)("p",{className:"caption_jo2G",children:i})]})}},28453(e,t,n){n.d(t,{R:()=>s,x:()=>o});var a=n(96540);let r={},i=a.createContext(r);function s(e){let t=a.useContext(i);return a.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function o(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),a.createElement(i.Provider,{value:t},e.children)}}}]);