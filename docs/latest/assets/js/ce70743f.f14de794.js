"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([["2937"],{9707(e,t,n){n.r(t),n.d(t,{metadata:()=>i,default:()=>u,frontMatter:()=>a,contentTitle:()=>o,toc:()=>c,assets:()=>d});var i=JSON.parse('{"id":"getting-started/quickstart","title":"MLflow Tracking Quickstart","description":"Looking for using MLflow for LLMs/Agent development? Checkout the MLflow for GenAI documentation instead. This guide is intended for data scientists who train traditional machine learning models, such as decision trees.","source":"@site/docs/classic-ml/getting-started/quickstart.mdx","sourceDirName":"getting-started","slug":"/getting-started/quickstart","permalink":"/mlflow-website/docs/latest/ml/getting-started/quickstart","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"sidebar_label":"Quickstart"},"sidebar":"classicMLSidebar","previous":{"title":"Set Up MLflow","permalink":"/mlflow-website/docs/latest/ml/getting-started/running-notebooks/"},"next":{"title":"Hyperparameter Tuning","permalink":"/mlflow-website/docs/latest/ml/getting-started/hyperparameter-tuning/"}}'),s=n(74848),r=n(28453),l=n(46077);let a={sidebar_position:2,sidebar_label:"Quickstart"},o="MLflow Tracking Quickstart",d={},c=[{value:"Step 1 - Set up MLflow",id:"step-1---set-up-mlflow",level:2},{value:"Step 2 - Prepare training data",id:"step-2---prepare-training-data",level:2},{value:"Step 3 - Train a model with MLflow Autologging",id:"step-3---train-a-model-with-mlflow-autologging",level:2},{value:"Step 4 - View the Run in the MLflow UI",id:"step-4---view-the-run-in-the-mlflow-ui",level:2},{value:"Step 5 - Log a model and metadata manually",id:"step-5---log-a-model-and-metadata-manually",level:2},{value:"Step 6 - Load the model back for inference.",id:"step-6---load-the-model-back-for-inference",level:2},{value:"Next Steps",id:"next-steps",level:2}];function h(e){let t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"mlflow-tracking-quickstart",children:"MLflow Tracking Quickstart"})}),"\n",(0,s.jsx)(t.admonition,{type:"info",children:(0,s.jsxs)(t.p,{children:["Looking for using MLflow for LLMs/Agent development? Checkout the ",(0,s.jsxs)("ins",{children:[(0,s.jsx)(t.a,{href:"/genai",children:"MLflow for GenAI"})," documentation"]})," instead. This guide is intended for data scientists who train traditional machine learning models, such as decision trees."]})}),"\n",(0,s.jsx)(t.admonition,{title:"MLflow Assistant",type:"tip",children:(0,s.jsxs)(t.p,{children:["Need help setting up tracking? Try ",(0,s.jsx)("ins",{children:(0,s.jsx)(t.a,{href:"/genai/getting-started/try-assistant",children:"MLflow Assistant"})})," - a powerful AI assistant that can help you set up MLflow tracking for your project."]})}),"\n",(0,s.jsx)(t.p,{children:"Welcome to MLflow! The purpose of this quickstart is to provide a quick guide to the most essential core APIs of MLflow Tracking. In just a few minutes of following along with this quickstart, you will learn:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["How to ",(0,s.jsx)(t.strong,{children:"log"})," parameters, metrics, and a model using the MLflow logging API"]}),"\n",(0,s.jsxs)(t.li,{children:["How to navigate to a model in the ",(0,s.jsx)(t.strong,{children:"MLflow UI"})]}),"\n",(0,s.jsxs)(t.li,{children:["How to ",(0,s.jsx)(t.strong,{children:"load"})," a logged model for inference"]}),"\n"]}),"\n",(0,s.jsx)(t.h2,{id:"step-1---set-up-mlflow",children:"Step 1 - Set up MLflow"}),"\n",(0,s.jsx)(t.p,{children:"MLflow is available on PyPI. If you don't already have it installed on your system, you can install it with:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"pip install mlflow\n"})}),"\n",(0,s.jsxs)(t.p,{children:["Then, follow the instructions in the ",(0,s.jsx)(t.a,{href:"/ml/getting-started/running-notebooks",children:"Set Up MLflow"})," guide to set up MLflow."]}),"\n",(0,s.jsx)(t.p,{children:"If you just want to start super quick, run the following code in a notebook cell:"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'import mlflow\n\nmlflow.set_experiment("MLflow Quickstart")\n'})}),"\n",(0,s.jsx)(t.h2,{id:"step-2---prepare-training-data",children:"Step 2 - Prepare training data"}),"\n",(0,s.jsx)(t.p,{children:"Before training our first model, let's prepare the training data and model hyperparameters."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'import pandas as pd\nfrom sklearn import datasets\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.linear_model import LogisticRegression\nfrom sklearn.metrics import accuracy_score, precision_score, recall_score, f1_score\n\n# Load the Iris dataset\nX, y = datasets.load_iris(return_X_y=True)\n\n# Split the data into training and test sets\nX_train, X_test, y_train, y_test = train_test_split(\n    X, y, test_size=0.2, random_state=42\n)\n\n# Define the model hyperparameters\nparams = {\n    "solver": "lbfgs",\n    "max_iter": 1000,\n    "random_state": 8888,\n}\n'})}),"\n",(0,s.jsx)(t.h2,{id:"step-3---train-a-model-with-mlflow-autologging",children:"Step 3 - Train a model with MLflow Autologging"}),"\n",(0,s.jsxs)(t.p,{children:["In this step, we train the model on the training data loaded in the previous step, and log the model and its metadata to MLflow. The easiest way to do this is to using MLflow's ",(0,s.jsx)(t.strong,{children:"Autologging"})," feature."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"import mlflow\n\n# Enable autologging for scikit-learn\nmlflow.sklearn.autolog()\n\n# Just train the model normally\nlr = LogisticRegression(**params)\nlr.fit(X_train, y_train)\n"})}),"\n",(0,s.jsxs)(t.p,{children:["With just one line of additional code ",(0,s.jsx)(t.code,{children:"mlflow.sklearn.autolog()"}),", now you get the best of both worlds: you can focus on training the model, and MLflow will take care of the rest:"]}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Saving the trained model."}),"\n",(0,s.jsx)(t.li,{children:"Recording the model's performance metrics during training, such as accuracy, precision, AUC curve."}),"\n",(0,s.jsx)(t.li,{children:"Logging hyperparameter values used to train the model."}),"\n",(0,s.jsx)(t.li,{children:"Track metadata such as input data format, user, timestamp, etc."}),"\n"]}),"\n",(0,s.jsxs)(t.p,{children:["To learn more about autologging and supported libraries, see the ",(0,s.jsx)(t.a,{href:"/ml/tracking/autolog/",children:"Autologging"})," documentation."]}),"\n",(0,s.jsx)(t.h2,{id:"step-4---view-the-run-in-the-mlflow-ui",children:"Step 4 - View the Run in the MLflow UI"}),"\n",(0,s.jsxs)(t.p,{children:["To see the results of training, you can access the MLflow UI by navigating to the URL of the Tracking Server. If you have not started one, open a new terminal and run the following command at the root of the MLflow project and access the UI at ",(0,s.jsx)(t.a,{href:"http://localhost:5000",children:"http://localhost:5000"})," (or the port number you specified)."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-bash",children:"mlflow server --port 5000\n"})}),"\n",(0,s.jsx)(t.p,{children:"When opening the site, you will see a screen similar to the following:"}),"\n",(0,s.jsx)(l.A,{src:"/images/tutorials/introductory/quickstart-tracking/quickstart-ui-home.png",alt:"MLflow UI Home page"}),"\n",(0,s.jsx)(t.p,{children:'The "Experiments" section shows a list of (recently created) experiments. Click on the "MLflow Quickstart" experiment.'}),"\n",(0,s.jsx)(l.A,{src:"/images/tutorials/introductory/quickstart-tracking/quickstart-ui-run-list.png",alt:"MLflow UI Run list page"}),"\n",(0,s.jsxs)(t.p,{children:["The training ",(0,s.jsx)(t.strong,{children:"Run"})," created by MLflow is listed in the table. Click the run to view the details."]}),"\n",(0,s.jsx)(l.A,{src:"/images/tutorials/introductory/quickstart-tracking/quickstart-our-run.png",alt:"MLflow UI Run detail page"}),"\n",(0,s.jsx)(t.p,{children:"The Run detail page shows an overview of the run, its recorded metrics, hyper-parameters, tags, and more. Play around with the UI to see the different views and features."}),"\n",(0,s.jsx)(t.p,{children:'Scroll down to the "Model" section and you should see the model that was logged during training. Click on the model to view the details.'}),"\n",(0,s.jsx)(l.A,{src:"/images/tutorials/introductory/quickstart-tracking/quickstart-ui-logged-models.png",alt:"MLflow UI Model detail page"}),"\n",(0,s.jsx)(t.p,{children:'The model page displays similar metadata such as performance metrics and hyper-parameters. It also includes an "Artifacts" section that lists the files that were logged during training. You can also see environment information such as the Python version and dependencies, which are stored for reproducibility.'}),"\n",(0,s.jsx)(l.A,{src:"/images/tutorials/introductory/quickstart-tracking/quickstart-our-model.png",alt:"MLflow UI Model detail page"}),"\n",(0,s.jsx)(t.h2,{id:"step-5---log-a-model-and-metadata-manually",children:"Step 5 - Log a model and metadata manually"}),"\n",(0,s.jsx)(t.p,{children:"Now that we have learned how to log a model training run with MLflow autologging, let's step further and learn how to log a model and metadata manually. This is useful when you want to have more control over the logging process."}),"\n",(0,s.jsx)(t.p,{children:"The steps that we will take are:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["Initiate an MLflow ",(0,s.jsx)(t.strong,{children:"run"})," context to start a new run that we will log the model and metadata to."]}),"\n",(0,s.jsx)(t.li,{children:"Train and test the model."}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Log"})," model ",(0,s.jsx)(t.strong,{children:"parameters"})," and performance ",(0,s.jsx)(t.strong,{children:"metrics"}),"."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Tag"})," the run for easy retrieval."]}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'# Start an MLflow run\nwith mlflow.start_run():\n    # Log the hyperparameters\n    mlflow.log_params(params)\n\n    # Train the model\n    lr = LogisticRegression(**params)\n    lr.fit(X_train, y_train)\n\n    # Log the model\n    model_info = mlflow.sklearn.log_model(sk_model=lr, name="iris_model")\n\n    # Predict on the test set, compute and log the loss metric\n    y_pred = lr.predict(X_test)\n    accuracy = accuracy_score(y_test, y_pred)\n    mlflow.log_metric("accuracy", accuracy)\n\n    # Optional: Set a tag that we can use to remind ourselves what this run was for\n    mlflow.set_tag("Training Info", "Basic LR model for iris data")\n'})}),"\n",(0,s.jsx)(t.h2,{id:"step-6---load-the-model-back-for-inference",children:"Step 6 - Load the model back for inference."}),"\n",(0,s.jsx)(t.p,{children:"After logging the model, we can perform inference by:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Loading"})," the model using MLflow's ",(0,s.jsx)(t.code,{children:"pyfunc"})," flavor."]}),"\n",(0,s.jsxs)(t.li,{children:["Running ",(0,s.jsx)(t.strong,{children:"Predict"})," on new data using the loaded model."]}),"\n"]}),"\n",(0,s.jsx)(t.admonition,{type:"info",children:(0,s.jsxs)(t.p,{children:["To load the model as a native scikit-learn model, use ",(0,s.jsx)(t.code,{children:"mlflow.sklearn.load_model(model_info.model_uri)"})," instead of the pyfunc flavor."]})}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'# Load the model back for predictions as a generic Python Function model\nloaded_model = mlflow.pyfunc.load_model(model_info.model_uri)\n\npredictions = loaded_model.predict(X_test)\n\niris_feature_names = datasets.load_iris().feature_names\n\nresult = pd.DataFrame(X_test, columns=iris_feature_names)\nresult["actual_class"] = y_test\nresult["predicted_class"] = predictions\n\nresult[:4]\n'})}),"\n",(0,s.jsx)(t.p,{children:"The output of this code will look something like this:"}),"\n",(0,s.jsxs)("table",{children:[(0,s.jsx)("thead",{children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{children:"sepal length (cm)"}),(0,s.jsx)("th",{children:"sepal width (cm)"}),(0,s.jsx)("th",{children:"petal length (cm)"}),(0,s.jsx)("th",{children:"petal width (cm)"}),(0,s.jsx)("th",{children:"actual_class"}),(0,s.jsx)("th",{children:"predicted_class"})]})}),(0,s.jsxs)("tbody",{children:[(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"6.1"}),(0,s.jsx)("td",{children:"2.8"}),(0,s.jsx)("td",{children:"4.7"}),(0,s.jsx)("td",{children:"1.2"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"1"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"5.7"}),(0,s.jsx)("td",{children:"3.8"}),(0,s.jsx)("td",{children:"1.7"}),(0,s.jsx)("td",{children:"0.3"}),(0,s.jsx)("td",{children:"0"}),(0,s.jsx)("td",{children:"0"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"7.7"}),(0,s.jsx)("td",{children:"2.6"}),(0,s.jsx)("td",{children:"6.9"}),(0,s.jsx)("td",{children:"2.3"}),(0,s.jsx)("td",{children:"2"}),(0,s.jsx)("td",{children:"2"})]}),(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{children:"6.0"}),(0,s.jsx)("td",{children:"2.9"}),(0,s.jsx)("td",{children:"4.5"}),(0,s.jsx)("td",{children:"1.5"}),(0,s.jsx)("td",{children:"1"}),(0,s.jsx)("td",{children:"1"})]})]})]}),"\n",(0,s.jsx)(t.h2,{id:"next-steps",children:"Next Steps"}),"\n",(0,s.jsx)(t.p,{children:"Congratulations on working through the MLflow Tracking Quickstart! You should now have a basic understanding of how to use the MLflow Tracking APIs to log models."}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.a,{href:"/genai",children:"MLflow for GenAI"}),": Learn how to use MLflow for GenAI/LLM development."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.a,{href:"/ml/deep-learning",children:"MLflow for Deep Learning"}),": Learn how to use MLflow for deep learning frameworks such as PyTorch, TensorFlow, etc."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.a,{href:"/ml/tracking/",children:"MLflow Tracking"}),": Learn more about the MLflow Tracking APIs."]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.a,{href:"/self-hosting",children:"Self-hosting Guide"}),": Learn how to self-host the MLflow Tracking Server and set it up for team collaboration."]}),"\n"]})]})}function u(e={}){let{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(h,{...e})}):h(e)}},46077(e,t,n){n.d(t,{A:()=>r});var i=n(74848);n(96540);var s=n(66497);function r({src:e,alt:t,width:n,caption:r,className:l}){return(0,i.jsxs)("div",{className:`container_JwLF ${l||""}`,children:[(0,i.jsx)("div",{className:"imageWrapper_RfGN",style:n?{width:n}:{},children:(0,i.jsx)("img",{src:(0,s.default)(e),alt:t,className:"image_bwOA"})}),r&&(0,i.jsx)("p",{className:"caption_jo2G",children:r})]})}},28453(e,t,n){n.d(t,{R:()=>l,x:()=>a});var i=n(96540);let s={},r=i.createContext(s);function l(e){let t=i.useContext(r);return i.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),i.createElement(r.Provider,{value:t},e.children)}}}]);