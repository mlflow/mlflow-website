"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[9003],{28101:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>d,contentTitle:()=>a,default:()=>u,frontMatter:()=>r,metadata:()=>s,toc:()=>c});const s=JSON.parse('{"id":"llms/custom-pyfunc-for-llms/notebooks/index","title":"Custom PyFuncs for Advanced LLMs with MLflow - Notebooks","description":"If you\'d like to delve deeper into the notebooks in this guide, they can be viewed or downloaded directly below.","source":"@site/docs/llms/custom-pyfunc-for-llms/notebooks/index.mdx","sourceDirName":"llms/custom-pyfunc-for-llms/notebooks","slug":"/llms/custom-pyfunc-for-llms/notebooks/","permalink":"/docs/latest/llms/custom-pyfunc-for-llms/notebooks/","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{}}');var l=t(74848),o=t(28453),i=t(86294);const r={},a="Custom PyFuncs for Advanced LLMs with MLflow - Notebooks",d={},c=[{value:"Deploying Advanced LLMs with Custom PyFuncs",id:"deploying-advanced-llms-with-custom-pyfuncs",level:2},{value:"Introduction",id:"introduction",level:3},{value:"What you will learn",id:"what-you-will-learn",level:3},{value:"Why Custom <em>pyfunc</em> for LLM Deployment?",id:"why-custom-pyfunc-for-llm-deployment",level:3},{value:"Crafting the Custom <em>pyfunc</em>",id:"crafting-the-custom-pyfunc",level:3},{value:"Step-by-step Guide",id:"step-by-step-guide",level:3},{value:"Wrap Up",id:"wrap-up",level:3}];function h(e){const n={admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",strong:"strong",ul:"ul",...(0,o.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"custom-pyfuncs-for-advanced-llms-with-mlflow---notebooks",children:"Custom PyFuncs for Advanced LLMs with MLflow - Notebooks"})}),"\n",(0,l.jsx)(n.p,{children:"If you'd like to delve deeper into the notebooks in this guide, they can be viewed or downloaded directly below."}),"\n",(0,l.jsx)(n.h2,{id:"deploying-advanced-llms-with-custom-pyfuncs",children:"Deploying Advanced LLMs with Custom PyFuncs"}),"\n",(0,l.jsx)(n.h3,{id:"introduction",children:"Introduction"}),"\n",(0,l.jsxs)(n.p,{children:["In this tutorial, we'll explore the nuances of deploying advanced Large Language Models (LLMs) with MLflow, particularly focusing on models\nthat can't be readily managed with MLflow's built-in functionality. We'll highlight the necessity of custom ",(0,l.jsx)(n.em,{children:"pyfunc"})," definitions when\ndealing with such complex models, emphasizing its role in managing intricate model behaviors and dependencies. By the end, you'll understand\nthe intricacies of deploying an LLM model using the MPT-7B instruct transformer, wrapped efficiently using a custom ",(0,l.jsx)(n.em,{children:"pyfunc"}),"."]}),"\n",(0,l.jsx)(n.h3,{id:"what-you-will-learn",children:"What you will learn"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"LLM Deployment Challenges"}),": Recognize the complexities and challenges associated with deploying advanced LLMs in MLflow."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Custom PyFuncs for LLMs"}),": Understand the need and process of creating a custom ",(0,l.jsx)(n.em,{children:"pyfunc"})," to effectively manage LLMs, particularly when default flavors fall short."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Prompt Management in Deployment"}),": Delve into how custom ",(0,l.jsx)(n.em,{children:"pyfunc"})," allows manipulation of interface data to generate prompts, simplifying end-user interactions in a RESTful environment."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Leveraging Custom PyFunc for Enhanced Flexibility"}),": Witness how custom ",(0,l.jsx)(n.em,{children:"pyfunc"})," definitions provide the flexibility needed for advanced model behaviors and dependencies."]}),"\n"]}),"\n",(0,l.jsxs)(n.h3,{id:"why-custom-pyfunc-for-llm-deployment",children:["Why Custom ",(0,l.jsx)(n.em,{children:"pyfunc"})," for LLM Deployment?"]}),"\n",(0,l.jsxs)(n.p,{children:["Deploying advanced LLMs isn't straightforward. Models like the MPT-7B instruct transformer have specific requirements and behaviors that don't align with traditional MLflow flavors.\nThis section highlights the challenges faced and the importance of custom ",(0,l.jsx)(n.em,{children:"pyfunc"})," definitions in addressing these challenges."]}),"\n",(0,l.jsxs)(n.h3,{id:"crafting-the-custom-pyfunc",children:["Crafting the Custom ",(0,l.jsx)(n.em,{children:"pyfunc"})]}),"\n",(0,l.jsxs)(n.p,{children:["Venturing into the solution, we'll craft a custom ",(0,l.jsx)(n.em,{children:"pyfunc"})," to efficiently wrap and manage our LLM. This custom definition serves as a bridge, ensuring our LLM can be deployed\nseamlessly while retaining its original capabilities and adhering to MLflow's standards."]}),"\n",(0,l.jsx)(n.h3,{id:"step-by-step-guide",children:"Step-by-step Guide"}),"\n",(0,l.jsxs)(n.ol,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"LLM Introduction"}),": Understand the MPT-7B instruct transformer, its importance, and its intricacies."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Challenges with Traditional Deployment"}),": Recognize the difficulties when attempting to deploy such an LLM using MLflow's default capabilities."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsxs)(n.strong,{children:["Designing the Custom ",(0,l.jsx)(n.em,{children:"pyfunc"})]}),": Create a custom ",(0,l.jsx)(n.em,{children:"pyfunc"})," that addresses the LLM's requirements and behaviors."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Deploying the LLM"}),": Integrate with MLflow to deploy the LLM using the crafted custom ",(0,l.jsx)(n.em,{children:"pyfunc"}),"."]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"Interface Simplification"}),": Examine how the custom ",(0,l.jsx)(n.em,{children:"pyfunc"})," simplifies user interactions, particularly in RESTful deployments."]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"wrap-up",children:"Wrap Up"}),"\n",(0,l.jsxs)(n.p,{children:["With the complexities of advanced LLM deployment unraveled, this tutorial showcases the indispensable role of custom ",(0,l.jsx)(n.em,{children:"pyfunc"})," in MLflow. Through a detailed,\nhands-on approach, you'll appreciate how custom ",(0,l.jsx)(n.em,{children:"pyfunc"})," definitions can make seemingly insurmountable deployment challenges manageable and streamlined."]}),"\n",(0,l.jsx)(i.AC,{children:(0,l.jsx)(i._C,{headerText:"Serving LLMs with MLflow: Leveraging Custom PyFunc",link:"/llms/custom-pyfunc-for-llms/notebooks/custom-pyfunc-advanced-llm",text:"Learn how to use the MLflow Custom Pyfunc Model to serve Large Language Models (LLMs) in a RESTful environment."})}),"\n",(0,l.jsx)("br",{}),"\n",(0,l.jsx)(n.admonition,{type:"note",children:(0,l.jsxs)(n.p,{children:["To execute the notebooks, ensure you either have a local MLflow Tracking Server running or adjust the ",(0,l.jsx)(n.code,{children:"mlflow.set_tracking_uri()"})," to point to an active MLflow Tracking Server instance.\nTo engage with the MLflow UI, ensure you're either running the UI server locally or have a configured, accessible, deployed MLflow UI server."]})})]})}function u(e={}){const{wrapper:n}={...(0,o.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(h,{...e})}):h(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>r});var s=t(96540);const l={},o=s.createContext(l);function i(e){const n=s.useContext(o);return s.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),s.createElement(o.Provider,{value:n},e.children)}},86294:(e,n,t)=>{t.d(n,{Zp:()=>a,AC:()=>r,WO:()=>c,tf:()=>u,_C:()=>d,$3:()=>h,jK:()=>m});var s=t(34164);const l={CardGroup:"CardGroup_P84T",MaxThreeColumns:"MaxThreeColumns_FO1r",AutofillColumns:"AutofillColumns_fKhQ",Card:"Card_aSCR",CardBordered:"CardBordered_glGF",CardBody:"CardBody_BhRs",TextColor:"TextColor_a8Tp",BoxRoot:"BoxRoot_Etgr",FlexWrapNowrap:"FlexWrapNowrap_f60k",FlexJustifyContentFlexStart:"FlexJustifyContentFlexStart_ZYv5",FlexDirectionRow:"FlexDirectionRow_T2qL",FlexAlignItemsCenter:"FlexAlignItemsCenter_EHVM",FlexFlex:"FlexFlex__JTE",Link:"Link_fVkl",MarginLeft4:"MarginLeft4_YQSJ",MarginTop4:"MarginTop4_jXKN",PaddingBottom4:"PaddingBottom4_O9gt",LogoCardContent:"LogoCardContent_kCQm",LogoCardImage:"LogoCardImage_JdcX",SmallLogoCardContent:"SmallLogoCardContent_LxhV",SmallLogoCardImage:"SmallLogoCardImage_tPZl",NewFeatureCardContent:"NewFeatureCardContent_Rq3d",NewFeatureCardHeading:"NewFeatureCardHeading_f6q3",NewFeatureCardHeadingSeparator:"NewFeatureCardHeadingSeparator_pSx8",NewFeatureCardTags:"NewFeatureCardTags_IFHO",NewFeatureCardWrapper:"NewFeatureCardWrapper_NQ0k",TitleCardContent:"TitleCardContent_l9MQ",TitleCardTitle:"TitleCardTitle__K8J",TitleCardSeparator:"TitleCardSeparator_IN2E",Cols1:"Cols1_Gr2U",Cols2:"Cols2_sRvc",Cols3:"Cols3_KjUS",Cols4:"Cols4_dKOj",Cols5:"Cols5_jDmj",Cols6:"Cols6_Q0OR"};var o=t(56289),i=t(74848);const r=e=>{let{children:n,isSmall:t,cols:o}=e;return(0,i.jsx)("div",{className:(0,s.A)(l.CardGroup,t?l.AutofillColumns:o?l[`Cols${o}`]:l.MaxThreeColumns),children:n})},a=e=>{let{children:n,link:t=""}=e;return t?(0,i.jsx)(o.A,{className:(0,s.A)(l.Link,l.Card,l.CardBordered),to:t,children:n}):(0,i.jsx)("div",{className:(0,s.A)(l.Card,l.CardBordered),children:n})},d=e=>{let{headerText:n,link:t,text:o}=e;return(0,i.jsx)(a,{link:t,children:(0,i.jsxs)("span",{children:[(0,i.jsx)("div",{className:(0,s.A)(l.CardTitle,l.BoxRoot,l.PaddingBottom4),style:{pointerEvents:"none"},children:(0,i.jsx)("div",{className:(0,s.A)(l.BoxRoot,l.FlexFlex,l.FlexAlignItemsCenter,l.FlexDirectionRow,l.FlexJustifyContentFlexStart,l.FlexWrapNowrap),style:{marginLeft:"-4px",marginTop:"-4px"},children:(0,i.jsx)("div",{className:(0,s.A)(l.BoxRoot,l.BoxHideIfEmpty,l.MarginTop4,l.MarginLeft4),style:{pointerEvents:"auto"},children:(0,i.jsx)("span",{className:"",children:n})})})}),(0,i.jsx)("span",{className:(0,s.A)(l.TextColor,l.CardBody),children:(0,i.jsx)("p",{children:o})})]})})},c=e=>{let{description:n,children:t,link:s}=e;return(0,i.jsx)(a,{link:s,children:(0,i.jsxs)("div",{className:l.LogoCardContent,children:[(0,i.jsx)("div",{className:l.LogoCardImage,children:t}),(0,i.jsx)("p",{className:l.TextColor,children:n})]})})},h=e=>{let{children:n,link:t}=e;return(0,i.jsx)(a,{link:t,children:(0,i.jsx)("div",{className:l.SmallLogoCardContent,children:(0,i.jsx)("div",{className:(0,s.A)("max-height-img-container",l.SmallLogoCardImage),children:n})})})},u=e=>{let{children:n,description:t,name:s,releaseVersion:r,learnMoreLink:d=""}=e;return(0,i.jsx)(a,{children:(0,i.jsxs)("div",{className:l.NewFeatureCardWrapper,children:[(0,i.jsxs)("div",{className:l.NewFeatureCardContent,children:[(0,i.jsxs)("div",{className:l.NewFeatureCardHeading,children:[s,(0,i.jsx)("br",{}),(0,i.jsx)("hr",{className:l.NewFeatureCardHeadingSeparator})]}),(0,i.jsx)("div",{className:l.LogoCardImage,children:n}),(0,i.jsx)("br",{}),(0,i.jsx)("p",{children:t}),(0,i.jsx)("br",{})]}),(0,i.jsxs)("div",{className:l.NewFeatureCardTags,children:[(0,i.jsx)("div",{children:d&&(0,i.jsx)(o.A,{className:"button button--outline button--sm button--primary",to:d,children:"Learn more"})}),(0,i.jsxs)(o.A,{className:"button button--outline button--sm button--primary",to:`https://github.com/mlflow/mlflow/releases/tag/v${r}`,children:["released in ",r]})]})]})})},m=e=>{let{title:n,description:t,link:o=""}=e;return(0,i.jsx)(a,{link:o,children:(0,i.jsxs)("div",{className:l.TitleCardContent,children:[(0,i.jsx)("div",{className:(0,s.A)(l.TitleCardTitle),style:{textAlign:"left",fontWeight:"bold"},children:n}),(0,i.jsx)("hr",{className:(0,s.A)(l.TitleCardSeparator),style:{margin:"12px 0"}}),(0,i.jsx)("p",{className:(0,s.A)(l.TextColor),children:t})]})})}}}]);