"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[2745],{28453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>s});var r=t(96540);const l={},a=r.createContext(l);function i(e){const n=r.useContext(a);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function s(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),r.createElement(a.Provider,{value:n},e.children)}},65537:(e,n,t)=>{t.d(n,{A:()=>b});var r=t(96540),l=t(34164),a=t(65627),i=t(56347),s=t(50372),o=t(30604),c=t(11861),d=t(78749);function h(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function u(e){const{values:n,children:t}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return h(e).map((e=>{let{props:{value:n,label:t,attributes:r,default:l}}=e;return{value:n,label:t,attributes:r,default:l}}))}(t);return function(e){const n=(0,c.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,t])}function m(e){let{value:n,tabValues:t}=e;return t.some((e=>e.value===n))}function p(e){let{queryString:n=!1,groupId:t}=e;const l=(0,i.W6)(),a=function(e){let{queryString:n=!1,groupId:t}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:n,groupId:t});return[(0,o.aZ)(a),(0,r.useCallback)((e=>{if(!a)return;const n=new URLSearchParams(l.location.search);n.set(a,e),l.replace({...l.location,search:n.toString()})}),[a,l])]}function f(e){const{defaultValue:n,queryString:t=!1,groupId:l}=e,a=u(e),[i,o]=(0,r.useState)((()=>function(e){let{defaultValue:n,tabValues:t}=e;if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!m({value:n,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${t.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const r=t.find((e=>e.default))??t[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:a}))),[c,h]=p({queryString:t,groupId:l}),[f,g]=function(e){let{groupId:n}=e;const t=function(e){return e?`docusaurus.tab.${e}`:null}(n),[l,a]=(0,d.Dv)(t);return[l,(0,r.useCallback)((e=>{t&&a.set(e)}),[t,a])]}({groupId:l}),x=(()=>{const e=c??f;return m({value:e,tabValues:a})?e:null})();(0,s.A)((()=>{x&&o(x)}),[x]);return{selectedValue:i,selectValue:(0,r.useCallback)((e=>{if(!m({value:e,tabValues:a}))throw new Error(`Can't select invalid tab value=${e}`);o(e),h(e),g(e)}),[h,g,a]),tabValues:a}}var g=t(9136);const x={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var w=t(74848);function j(e){let{className:n,block:t,selectedValue:r,selectValue:i,tabValues:s}=e;const o=[],{blockElementScrollPositionUntilNextRender:c}=(0,a.a_)(),d=e=>{const n=e.currentTarget,t=o.indexOf(n),l=s[t].value;l!==r&&(c(n),i(l))},h=e=>{let n=null;switch(e.key){case"Enter":d(e);break;case"ArrowRight":{const t=o.indexOf(e.currentTarget)+1;n=o[t]??o[0];break}case"ArrowLeft":{const t=o.indexOf(e.currentTarget)-1;n=o[t]??o[o.length-1];break}}n?.focus()};return(0,w.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,l.A)("tabs",{"tabs--block":t},n),children:s.map((e=>{let{value:n,label:t,attributes:a}=e;return(0,w.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>{o.push(e)},onKeyDown:h,onClick:d,...a,className:(0,l.A)("tabs__item",x.tabItem,a?.className,{"tabs__item--active":r===n}),children:t??n},n)}))})}function _(e){let{lazy:n,children:t,selectedValue:a}=e;const i=(Array.isArray(t)?t:[t]).filter(Boolean);if(n){const e=i.find((e=>e.props.value===a));return e?(0,r.cloneElement)(e,{className:(0,l.A)("margin-top--md",e.props.className)}):null}return(0,w.jsx)("div",{className:"margin-top--md",children:i.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==a})))})}function y(e){const n=f(e);return(0,w.jsxs)("div",{className:(0,l.A)("tabs-container",x.tabList),children:[(0,w.jsx)(j,{...n,...e}),(0,w.jsx)(_,{...n,...e})]})}function b(e){const n=(0,g.A)();return(0,w.jsx)(y,{...e,children:h(e.children)},String(n))}},67756:(e,n,t)=>{t.d(n,{B:()=>o});t(96540);const r=JSON.parse('{"mlflow.anthropic":"api_reference/python_api/mlflow.anthropic.html","mlflow.artifacts":"api_reference/python_api/mlflow.artifacts.html","mlflow.ag2":"api_reference/python_api/mlflow.ag2.html","mlflow.autogen":"api_reference/python_api/mlflow.autogen.html","mlflow.bedrock":"api_reference/python_api/mlflow.bedrock.html","mlflow.catboost":"api_reference/python_api/mlflow.catboost.html","mlflow.client":"api_reference/python_api/mlflow.client.html","mlflow.config":"api_reference/python_api/mlflow.config.html","mlflow.crewai":"api_reference/python_api/mlflow.crewai.html","mlflow.data":"api_reference/python_api/mlflow.data.html","mlflow.deployments":"api_reference/python_api/mlflow.deployments.html","mlflow.diviner":"api_reference/python_api/mlflow.diviner.html","mlflow.dspy":"api_reference/python_api/mlflow.dspy.html","mlflow.entities":"api_reference/python_api/mlflow.entities.html","mlflow.environment_variables":"api_reference/python_api/mlflow.environment_variables.html","mlflow.gateway":"api_reference/python_api/mlflow.gateway.html","mlflow.gemini":"api_reference/python_api/mlflow.gemini.html","mlflow.groq":"api_reference/python_api/mlflow.groq.html","mlflow.h2o":"api_reference/python_api/mlflow.h2o.html","mlflow.johnsnowlabs":"api_reference/python_api/mlflow.johnsnowlabs.html","mlflow.keras":"api_reference/python_api/mlflow.keras.html","mlflow.langchain":"api_reference/python_api/mlflow.langchain.html","mlflow.lightgbm":"api_reference/python_api/mlflow.lightgbm.html","mlflow.litellm":"api_reference/python_api/mlflow.litellm.html","mlflow.llama_index":"api_reference/python_api/mlflow.llama_index.html","mlflow.metrics":"api_reference/python_api/mlflow.metrics.html","mlflow.mistral":"api_reference/python_api/mlflow.mistral.html","mlflow.models":"api_reference/python_api/mlflow.models.html","mlflow.onnx":"api_reference/python_api/mlflow.onnx.html","mlflow.openai":"api_reference/python_api/mlflow.openai.html","mlflow.paddle":"api_reference/python_api/mlflow.paddle.html","mlflow.pmdarima":"api_reference/python_api/mlflow.pmdarima.html","mlflow.projects":"api_reference/python_api/mlflow.projects.html","mlflow.promptflow":"api_reference/python_api/mlflow.promptflow.html","mlflow.prophet":"api_reference/python_api/mlflow.prophet.html","mlflow.pyfunc":"api_reference/python_api/mlflow.pyfunc.html","mlflow.pyspark.ml":"api_reference/python_api/mlflow.pyspark.ml.html","mlflow.pytorch":"api_reference/python_api/mlflow.pytorch.html","mlflow":"api_reference/python_api/mlflow.html","mlflow.sagemaker":"api_reference/python_api/mlflow.sagemaker.html","mlflow.sentence_transformers":"api_reference/python_api/mlflow.sentence_transformers.html","mlflow.server":"api_reference/python_api/mlflow.server.html","mlflow.shap":"api_reference/python_api/mlflow.shap.html","mlflow.sklearn":"api_reference/python_api/mlflow.sklearn.html","mlflow.spacy":"api_reference/python_api/mlflow.spacy.html","mlflow.spark":"api_reference/python_api/mlflow.spark.html","mlflow.statsmodels":"api_reference/python_api/mlflow.statsmodels.html","mlflow.system_metrics":"api_reference/python_api/mlflow.system_metrics.html","mlflow.tensorflow":"api_reference/python_api/mlflow.tensorflow.html","mlflow.tracing":"api_reference/python_api/mlflow.tracing.html","mlflow.transformers":"api_reference/python_api/mlflow.transformers.html","mlflow.types":"api_reference/python_api/mlflow.types.html","mlflow.utils":"api_reference/python_api/mlflow.utils.html","mlflow.xgboost":"api_reference/python_api/mlflow.xgboost.html","mlflow.server.auth":"api_reference/auth/python-api.html"}');var l=t(29030),a=t(56289),i=t(74848);const s=e=>{const n=e.split(".");for(let t=n.length;t>0;t--){const e=n.slice(0,t).join(".");if(r[e])return e}return null};function o(e){let{fn:n,children:t}=e;const o=s(n);if(!o)return(0,i.jsx)(i.Fragment,{children:t});const c=(0,l.Ay)(`/${r[o]}#${n}`);return(0,i.jsx)(a.A,{to:c,target:"_blank",children:t??(0,i.jsxs)("code",{children:[n,"()"]})})}},77969:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>u,contentTitle:()=>h,default:()=>f,frontMatter:()=>d,metadata:()=>r,toc:()=>m});const r=JSON.parse('{"id":"tracking/tracking-api/index","title":"MLflow Tracking APIs","description":"MLflow Tracking provides Python, R, Java, or REST API to log your experiment data and models.","source":"@site/docs/tracking/tracking-api/index.mdx","sourceDirName":"tracking/tracking-api","slug":"/tracking/tracking-api/","permalink":"/docs/latest/tracking/tracking-api/","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":5,"frontMatter":{"sidebar_label":"API Guides","sidebar_position":5}}');var l=t(74848),a=t(28453),i=t(56289),s=t(65537),o=t(79329),c=t(67756);const d={sidebar_label:"API Guides",sidebar_position:5},h="MLflow Tracking APIs",u={},m=[{value:"Auto Logging",id:"auto-logging",level:2},{value:"Manual Logging",id:"manual-logging",level:2},{value:"Logging functions",id:"tracking_logging_functions",level:3},{value:"Tracking Tips",id:"tracking-tips",level:2},{value:"Logging with explicit step and timestamp",id:"logging-with-explicit-step-and-timestamp",level:3},{value:"Organizing Runs in Experiments",id:"organizing-runs-in-experiments",level:3},{value:"Creating Child Runs",id:"child_runs",level:3},{value:"Launching Multiple Runs in One Program",id:"launching-multiple-runs",level:3},{value:"Sequential Runs",id:"sequential-runs",level:4},{value:"Parallel Runs",id:"parallel-runs",level:4},{value:"Adding Tags to Runs",id:"adding-tags-to-runs",level:3},{value:"System Tags",id:"system_tags",level:4},{value:"Custom Tags",id:"custom-tags",level:4},{value:"Get MLflow Run instance from autologged results",id:"get-mlflow-run-instance-from-autologged-results",level:3}];function p(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"mlflow-tracking-apis",children:"MLflow Tracking APIs"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.a,{href:"/tracking",children:"MLflow Tracking"})," provides Python, R, Java, or REST API to log your experiment data and models."]}),"\n",(0,l.jsx)(n.h2,{id:"auto-logging",children:(0,l.jsx)(n.a,{href:"/tracking/autolog",children:"Auto Logging"})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.a,{href:"/tracking/autolog",children:"Auto logging"})," is a powerful feature that allows you to log metrics, parameters, and models without the need for explicit log statements\nbut just a single ",(0,l.jsx)(n.code,{children:"mlflow.autolog()"})," call at the top of your ML code."]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:"import mlflow\n\nmlflow.autolog()\n\n# Your training code...\n"})}),"\n",(0,l.jsxs)(n.p,{children:["See ",(0,l.jsx)(n.a,{href:"/tracking/autolog",children:"Automatic Logging with MLflow Tracking"})," documentation for supported libraries and how to use autolog APIs with each of them."]}),"\n",(0,l.jsx)(n.h2,{id:"manual-logging",children:"Manual Logging"}),"\n",(0,l.jsxs)(n.p,{children:["Alternatively, you log MLflow metrics by adding ",(0,l.jsx)(n.code,{children:"log"})," methods in your ML code. For example:"]}),"\n",(0,l.jsxs)(s.A,{children:[(0,l.jsx)(o.A,{default:!0,label:"Python",value:"python",children:(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:'with mlflow.start_run():\n    for epoch in range(0, 3):\n        mlflow.log_metric(key="quality", value=2 * epoch, step=epoch)\n'})})}),(0,l.jsx)(o.A,{label:"Java",value:"java",children:(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-java",children:'MlflowClient client = new MlflowClient();\nRunInfo run = client.createRun();\nfor (int epoch = 0; epoch < 3; epoch ++) {\n    client.logMetric(run.getRunId(), "quality", 2 * epoch, System.currentTimeMillis(), epoch);\n}\n'})})})]}),"\n",(0,l.jsx)(n.h3,{id:"tracking_logging_functions",children:"Logging functions"}),"\n",(0,l.jsx)(n.p,{children:"Here are the full list of logging functions provided by the Tracking API (Python)."}),"\n",(0,l.jsx)(n.admonition,{type:"note",children:(0,l.jsx)(n.p,{children:"Java and R APIs provide similar but limited set of logging functions."})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(c.B,{fn:"mlflow.set_tracking_uri"})," connects to a tracking URI. You can also set the ",(0,l.jsx)(n.code,{children:"MLFLOW_TRACKING_URI"})," environment variable to have MLflow find a URI from there. In both cases, the URI can either be a HTTP/HTTPS URI for a remote server, a database connection string, or a local path to log data to a directory. The URI defaults to ",(0,l.jsx)(n.code,{children:"mlruns"}),"."]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(c.B,{fn:"mlflow.get_tracking_uri"})," returns the current tracking URI."]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(c.B,{fn:"mlflow.create_experiment"})," creates a new experiment and returns the experiment ID. Runs can be launched under the experiment by passing the experiment ID to ",(0,l.jsx)(c.B,{fn:"mlflow.start_run"})," or by setting the active experiment with ",(0,l.jsx)(c.B,{fn:"mlflow.set_experiment"}),", passing in the experiment ID of the created experiment."]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(c.B,{fn:"mlflow.set_experiment"})," sets an experiment as active and returns the active experiment instance. If you do not specify an experiment in ",(0,l.jsx)(c.B,{fn:"mlflow.start_run"}),", new runs are launched under this experiment."]}),"\n",(0,l.jsx)(n.admonition,{type:"note",children:(0,l.jsxs)(n.p,{children:["If the experiment being set by name does not exist, a new experiment will be\ncreated with the given name. After the experiment has been created, it will be set\nas the active experiment. On certain platforms, such as Databricks, the experiment name\nmust be an absolute path, e.g. ",(0,l.jsx)(n.code,{children:'"/Users/<username>/my-experiment"'}),"."]})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(c.B,{fn:"mlflow.start_run"})," starts a new run and returns a ",(0,l.jsx)(c.B,{fn:"mlflow.ActiveRun",children:(0,l.jsx)(n.code,{children:"mlflow.ActiveRun"})})," object usable as a context manager for the current run. If an active run is already in progress, you should either end the current run before starting the new run or nest the new run within the current run using ",(0,l.jsx)(n.code,{children:"nested=True"}),". You do not need to call ",(0,l.jsx)(n.code,{children:"start_run"})," explicitly: calling one of the logging functions with no active run automatically starts a new one."]}),"\n",(0,l.jsx)(n.admonition,{type:"note",children:(0,l.jsxs)(n.p,{children:["Unless the argument ",(0,l.jsx)(n.code,{children:"run_name"})," is set in ",(0,l.jsx)(c.B,{fn:"mlflow.start_run"}),", a unique run name will be generated for each run."]})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(c.B,{fn:"mlflow.end_run"})," ends the currently active run, if any, taking an optional run status."]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(c.B,{fn:"mlflow.active_run"})," returns a ",(0,l.jsx)(c.B,{fn:"mlflow.entities.Run",children:(0,l.jsx)(n.code,{children:"mlflow.entities.Run"})})," object corresponding to the currently active run, if any."]}),"\n",(0,l.jsxs)(n.admonition,{type:"note",children:[(0,l.jsxs)(n.p,{children:["You cannot access currently-active run attributes (parameters, metrics, etc.) through the run returned by ",(0,l.jsx)(n.code,{children:"mlflow.active_run"}),"."]}),(0,l.jsxs)(n.p,{children:["In order to access such attributes, use the ",(0,l.jsx)(c.B,{fn:"mlflow.client.MlflowClient",children:(0,l.jsx)(n.code,{children:"MlflowClient"})})," as follows:"]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:"client = mlflow.MlflowClient()\ndata = client.get_run(mlflow.active_run().info.run_id).data\n"})})]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(c.B,{fn:"mlflow.last_active_run"})," returns a ",(0,l.jsx)(c.B,{fn:"mlflow.entities.Run",children:(0,l.jsx)(n.code,{children:"mlflow.entities.Run"})})," object corresponding to the currently active run, if any. Otherwise, it returns a ",(0,l.jsx)(c.B,{fn:"mlflow.entities.Run",children:(0,l.jsx)(n.code,{children:"mlflow.entities.Run"})})," object corresponding the last run started from the current Python process that reached a terminal status (i.e. ",(0,l.jsx)(n.code,{children:"FINISHED"}),", ",(0,l.jsx)(n.code,{children:"FAILED"}),", or ",(0,l.jsx)(n.code,{children:"KILLED"}),")."]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(c.B,{fn:"mlflow.get_parent_run"})," returns a ",(0,l.jsx)(c.B,{fn:"mlflow.entities.Run",children:(0,l.jsx)(n.code,{children:"mlflow.entities.Run"})})," object corresponding to the parent run for the given run id, if one exists. Otherwise, it returns ",(0,l.jsx)(n.code,{children:"None"}),"."]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(c.B,{fn:"mlflow.log_param"})," logs a single key-value param in the currently active run. The key and value are both strings. Use ",(0,l.jsx)(c.B,{fn:"mlflow.log_params"})," to log multiple params at once."]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(c.B,{fn:"mlflow.log_metric"})," logs a single key-value metric. The value must always be a number. MLflow remembers the history of values for each metric. Use ",(0,l.jsx)(c.B,{fn:"mlflow.log_metrics"})," to log multiple metrics at once."]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(c.B,{fn:"mlflow.log_input"})," logs a single ",(0,l.jsx)(c.B,{fn:"mlflow.data.dataset.Dataset",children:(0,l.jsx)(n.code,{children:"mlflow.data.dataset.Dataset"})})," object corresponding to the currently active run. You may also log a dataset context string and a dict of key-value tags."]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(c.B,{fn:"mlflow.set_tag"})," sets a single key-value tag in the currently active run. The key and value are both strings. Use ",(0,l.jsx)(c.B,{fn:"mlflow.set_tags"})," to set multiple tags at once."]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(c.B,{fn:"mlflow.log_artifact"})," logs a local file or directory as an artifact, optionally taking an ",(0,l.jsx)(n.code,{children:"artifact_path"})," to place it in within the run's artifact URI. Run artifacts can be organized into directories, so you can place the artifact in a directory this way."]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(c.B,{fn:"mlflow.log_artifacts"})," logs all the files in a given directory as artifacts, again taking an optional ",(0,l.jsx)(n.code,{children:"artifact_path"}),"."]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(c.B,{fn:"mlflow.get_artifact_uri"})," returns the URI that artifacts from the current run should be logged to."]}),"\n",(0,l.jsx)(n.h2,{id:"tracking-tips",children:"Tracking Tips"}),"\n",(0,l.jsx)(n.h3,{id:"logging-with-explicit-step-and-timestamp",children:"Logging with explicit step and timestamp"}),"\n",(0,l.jsxs)(n.p,{children:["The ",(0,l.jsx)(n.code,{children:"log"})," methods support two alternative methods for distinguishing metric values on the x-axis: ",(0,l.jsx)(n.code,{children:"timestamp"})," and ",(0,l.jsx)(n.code,{children:"step"})," (number of training iterations, number of epochs, and so on).\nBy default, ",(0,l.jsx)(n.code,{children:"timestamp"})," is set to the current time and ",(0,l.jsx)(n.code,{children:"step"})," is set to 0. You can override these values by passing\n",(0,l.jsx)(n.code,{children:"timestamp"})," and ",(0,l.jsx)(n.code,{children:"step"})," arguments to the ",(0,l.jsx)(n.code,{children:"log"})," methods. For example:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:'mlflow.log_metric(key="train_loss", value=train_loss, step=epoch, timestamp=now)\n'})}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"step"})," has the following requirements and properties:"]}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:"Must be a valid 64-bit integer value."}),"\n",(0,l.jsx)(n.li,{children:"Can be negative."}),"\n",(0,l.jsx)(n.li,{children:"Can be out of order in successive write calls. For example, (1, 3, 2) is a valid sequence."}),"\n",(0,l.jsx)(n.li,{children:'Can have "gaps" in the sequence of values specified in successive write calls. For example, (1, 5, 75, -20) is a valid sequence.'}),"\n"]}),"\n",(0,l.jsx)(n.p,{children:"If you specify both a timestamp and a step, metrics are recorded against both axes independently."}),"\n",(0,l.jsx)(n.h3,{id:"organizing-runs-in-experiments",children:"Organizing Runs in Experiments"}),"\n",(0,l.jsxs)(n.p,{children:["MLflow allows you to group runs under experiments, which can be useful for comparing runs intended\nto tackle a particular task. You can create experiments via multiple way - MLflow UI, the ",(0,l.jsx)(i.A,{to:"/api_reference/cli.html",target:"_blank",children:"Command-Line Interface"})," (",(0,l.jsx)(n.code,{children:"mlflow experiments"}),"),\nor the ",(0,l.jsx)(c.B,{fn:"mlflow.create_experiment"})," Python API. You can pass the experiment name for an individual run\nusing the CLI (for example, ",(0,l.jsx)(n.code,{children:"mlflow run ... --experiment-name [name]"}),") or the ",(0,l.jsx)(n.code,{children:"MLFLOW_EXPERIMENT_NAME"}),"\nenvironment variable. Alternatively, you can use the experiment ID instead, via the\n",(0,l.jsx)(n.code,{children:"--experiment-id"})," CLI flag or the ",(0,l.jsx)(n.code,{children:"MLFLOW_EXPERIMENT_ID"})," environment variable."]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-bash",children:"# Set the experiment via environment variables\nexport MLFLOW_EXPERIMENT_NAME=fraud-detection\n\nmlflow experiments create --experiment-name fraud-detection\n"})}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:'# Launch a run. The experiment is inferred from the MLFLOW_EXPERIMENT_NAME environment\n# variable, or from the --experiment-name parameter passed to the MLflow CLI (the latter\n# taking precedence)\nwith mlflow.start_run():\n    mlflow.log_param("a", 1)\n    mlflow.log_metric("b", 2)\n'})}),"\n",(0,l.jsx)(n.h3,{id:"child_runs",children:"Creating Child Runs"}),"\n",(0,l.jsxs)(n.p,{children:["You can also create multiple runs inside a single run. This is useful for scenario like hyperparameter tuning,\ncross-validation folds, where you need another level of organization within an experiment. You can create child runs\nby passing ",(0,l.jsx)(n.code,{children:"parent_run_id"})," to ",(0,l.jsx)(c.B,{fn:"mlflow.start_run"})," function. For example:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:'# Start parent run\nwith mlflow.start_run() as parent_run:\n    param = [0.01, 0.02, 0.03]\n\n    # Create a child run for each parameter setting\n    for p in param:\n        with mlflow.start_run(nested=True) as child_run:\n            mlflow.log_param("p", p)\n            ...\n            mlflow.log_metric("val_loss", val_loss)\n'})}),"\n",(0,l.jsx)(n.p,{children:"You can fetch all child runs under a parent run using tags."}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:'child_runs = mlflow.search_runs(\n    experiment_ids=[YOUR_EXPERIMENT_ID],\n    filter_string=f"tags.mlflow.parentRunId = \'{parent_run.info.run_id}\'",\n)\nprint("child runs:")\nprint(results[["run_id", "params.p", "metrics.val_loss"]])\n# child runs:\n#             run_id params.p  metrics.val_loss\n#   0        0c0b...     0.01            0.1234\n#   0        c2a0...     0.02            0.0890\n#   0        g2j1...     0.03            0.1567\n'})}),"\n",(0,l.jsx)(n.h3,{id:"launching-multiple-runs",children:"Launching Multiple Runs in One Program"}),"\n",(0,l.jsxs)(n.p,{children:["Sometimes you want to launch multiple MLflow runs in the same program: for example, maybe you are\nperforming a hyperparameter search locally or your experiments are just very fast to run. The way to\ndo this depends on whether you want to run them ",(0,l.jsx)(n.a,{href:"#sequential-runs",children:"sequentially"})," or in ",(0,l.jsx)(n.a,{href:"#parallel-runs",children:"parallel"}),"."]}),"\n",(0,l.jsx)(n.h4,{id:"sequential-runs",children:"Sequential Runs"}),"\n",(0,l.jsxs)(n.p,{children:["Running multiple runs one-by-one is easy to do because the ",(0,l.jsx)(n.code,{children:"ActiveRun"})," object returned by ",(0,l.jsx)(c.B,{fn:"mlflow.start_run"}),"\nis a Python ",(0,l.jsx)(n.a,{href:"https://docs.python.org/2.5/whatsnew/pep-343.html",children:"context manager"}),'. You can "scope" each run to\njust one block of code as follows:']}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:'# First run\nwith mlflow.start_run():\n    mlflow.log_param("x", 1)\n    mlflow.log_metric("y", 2)\n    ...\n\n# Another run\nwith mlflow.start_run():\n    ...\n'})}),"\n",(0,l.jsxs)(n.p,{children:["The run remains open throughout the ",(0,l.jsx)(n.code,{children:"with"})," statement, and is automatically closed when the\nstatement exits, even if it exits due to an exception."]}),"\n",(0,l.jsx)(n.h4,{id:"parallel-runs",children:"Parallel Runs"}),"\n",(0,l.jsxs)(n.p,{children:["MLflow also supports running multiple runs in parallel using ",(0,l.jsx)(n.a,{href:"https://docs.python.org/2/library/multiprocessing.html",children:"multiprocessing"})," or multi threading."]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Multi-processing"})," is straightforward: just call ",(0,l.jsx)(c.B,{fn:"mlflow.start_run"})," in a separate process and it creates a new run for each. For example:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:'import mlflow\nimport multiprocessing as mp\n\n\ndef train_model(param):\n    with mlflow.start_run():\n        mlflow.log_param("p", param)\n        ...\n\n\nif __name__ == "__main__":\n    mlflow.set_experiment("multi-process")\n    params = [0.01, 0.02, ...]\n    with mp.Pool(processes=4) as pool:\n        pool.map(train_model, params)\n'})}),"\n",(0,l.jsxs)(n.admonition,{title:"attention",type:"warning",children:[(0,l.jsxs)(n.p,{children:["The above code will only work if the ",(0,l.jsx)(n.code,{children:"fork"})," method is used for creating child processes. If you are using\nthe ",(0,l.jsx)(n.code,{children:"spawn"})," method, the child processes will not automatically inherit the global state of the parent process, which includes\nthe active experiment and tracking URI, resulting in the child processes not being able to log to the same experiment. To\novercome this limitation, you can set the active experiment and tracking URI explicitly in each child process as shown below.\nThe ",(0,l.jsx)(n.code,{children:"fork"})," is the default method on POSIX systems except MacOS, but otherwise ",(0,l.jsx)(n.code,{children:"spawn"})," method will be used by default."]}),(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:'import mlflow\nimport multiprocessing as mp\n\n\ndef train_model(params):\n    # Set the experiment and tracking URI in each child process\n    mlflow.set_tracking_uri("http://localhost:5000")\n    mlflow.set_experiment("multi-process")\n    with mlflow.start_run():\n        ...\n\n\nif __name__ == "__main__":\n    params = [0.01, 0.02, ...]\n    pool = mp.get_context("spawn").Pool(processes=4)\n    pool.map(train_model, params)\n'})})]}),"\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.strong,{children:"Multi-threading"})," is a bit more complicated because MLflow uses a global state to keep track of the currently active run i.e. having multiple active\nruns in the same process may cause data corruption. However, you can avoid this issue and use multi threading by using ",(0,l.jsx)(n.a,{href:"#child_runs",children:"Child Runs"}),".\nYou can start child runs in each thread by passing ",(0,l.jsx)(n.code,{children:"nested=True"})," to ",(0,l.jsx)(c.B,{fn:"mlflow.start_run"})," as described in the previous section. For example:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:'import mlflow\nimport threading\n\n\ndef train_model(param):\n    # Create a child run by passing nested=True\n    with mlflow.start_run(nested=True):\n        mlflow.log_param("p", param)\n        ...\n\n\nif __name__ == "__main__":\n    params = [0.01, 0.02, ...]\n    threads = []\n    for p in params:\n        t = threading.Thread(target=train_model, args=(p,))\n        threads.append(t)\n        t.start()\n\n    for t in threads:\n        t.join()\n'})}),"\n",(0,l.jsxs)(n.p,{children:["Also ",(0,l.jsx)(n.a,{href:"https://github.com/mlflow/mlflow/blob/master/examples/hyperparam/search_random.py",children:"here"})," is the full example of hyperparameter tuning using child runs with multi threading."]}),"\n",(0,l.jsx)(n.h3,{id:"adding-tags-to-runs",children:"Adding Tags to Runs"}),"\n",(0,l.jsxs)(n.p,{children:["You can annotate runs with arbitrary tags to organize them into groups. This allows you to easily filter and search\nRuns in Tracking UI by using ",(0,l.jsx)(n.a,{href:"/search-runs#mlflow_tags",children:"filter expression"}),"."]}),"\n",(0,l.jsx)(n.h4,{id:"system_tags",children:"System Tags"}),"\n",(0,l.jsxs)(n.p,{children:["Tag keys that start with ",(0,l.jsx)(n.code,{children:"mlflow."})," are reserved for internal use."]}),"\n",(0,l.jsx)(n.admonition,{type:"note",children:(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"mlflow.note.content"})," is an exceptional case where the tag is ",(0,l.jsx)(n.strong,{children:"not set automatically"})," and can be overridden by the user to include additional information about the run."]})}),"\n",(0,l.jsx)(n.p,{children:"The following tags are set automatically by MLflow, when appropriate:"}),"\n",(0,l.jsxs)("table",{children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{children:"Key"}),(0,l.jsx)("th",{children:"Description"})]})}),(0,l.jsxs)("tbody",{children:[(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:(0,l.jsx)(n.code,{children:"mlflow.docker.image.id"})}),(0,l.jsx)("td",{children:"ID of the Docker image used to execute this run."})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:(0,l.jsx)(n.code,{children:"mlflow.docker.image.name"})}),(0,l.jsx)("td",{children:"Name of the Docker image used to execute this run."})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:(0,l.jsx)(n.code,{children:"mlflow.log-model.history"})}),(0,l.jsx)("td",{children:"Model metadata collected by log-model calls. Includes the serialized form of the MLModel model files logged to a run, although the exact format and information captured is subject to change."})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:(0,l.jsx)(n.code,{children:"mlflow.note.content"})}),(0,l.jsxs)("td",{children:["A descriptive note about this run. ",(0,l.jsx)("br",{})," This reserved tag is ",(0,l.jsx)(n.strong,{children:"not set automatically"})," and can be overridden by the user to include additional information about the run. The content is displayed on the run's page under the Notes section."]})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:(0,l.jsx)(n.code,{children:"mlflow.parentRunId"})}),(0,l.jsx)("td",{children:"The ID of the parent run, if this is a nested run."})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:(0,l.jsx)(n.code,{children:"mlflow.project.entryPoint"})}),(0,l.jsx)("td",{children:"Name of the project entry point associated with the current run, if any."})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:(0,l.jsx)(n.code,{children:"mlflow.project.env"})}),(0,l.jsxs)("td",{children:["The runtime context used by the MLflow project. Possible values: ",(0,l.jsx)(n.code,{children:'"docker"'})," and ",(0,l.jsx)(n.code,{children:'"conda"'}),"."]})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:(0,l.jsx)(n.code,{children:"mlflow.source.git.branch"})}),(0,l.jsxs)("td",{children:["Name of the branch of the executed code, if in a git repository. This tag is only logged within the context of ",(0,l.jsx)(n.a,{href:"/projects",children:"MLflow Projects"}),"."]})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:(0,l.jsx)(n.code,{children:"mlflow.source.git.commit"})}),(0,l.jsxs)("td",{children:["Commit hash of the executed code, if in a git repository. This tag is only logged when the code is executed as a Python script like ",(0,l.jsx)(n.code,{children:"python train.py"})," or as a project. If the code is executed in a notebook, this tag is not logged."]})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:(0,l.jsx)(n.code,{children:"mlflow.source.git.repoURL"})}),(0,l.jsxs)("td",{children:["URL that the executed code was cloned from. This tag is only logged within the context of ",(0,l.jsx)(n.a,{href:"/projects",children:"MLflow Projects"}),"."]})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:(0,l.jsx)(n.code,{children:"mlflow.source.name"})}),(0,l.jsx)("td",{children:"Source identifier (e.g., GitHub URL, local Python filename, name of notebook)"})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:(0,l.jsx)(n.code,{children:"mlflow.source.type"})}),(0,l.jsxs)("td",{children:["Source type. Possible values: ",(0,l.jsx)(n.code,{children:'"NOTEBOOK"'}),", ",(0,l.jsx)(n.code,{children:'"JOB"'}),", ",(0,l.jsx)(n.code,{children:'"PROJECT"'}),", ",(0,l.jsx)(n.code,{children:'"LOCAL"'}),", and ",(0,l.jsx)(n.code,{children:'"UNKNOWN"'})]})]}),(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{children:(0,l.jsx)(n.code,{children:"mlflow.user"})}),(0,l.jsx)("td",{children:"Identifier of the user who created the run."})]})]})]}),"\n",(0,l.jsx)(n.h4,{id:"custom-tags",children:"Custom Tags"}),"\n",(0,l.jsxs)(n.p,{children:["The ",(0,l.jsx)(c.B,{fn:"mlflow.client.MlflowClient.set_tag",children:(0,l.jsx)(n.code,{children:"MlflowClient.set_tag()"})})," function lets you add custom tags to runs. A tag can only have a single unique value mapped to it at a time. For example:"]}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:'client.set_tag(run.info.run_id, "tag_key", "tag_value")\n'})}),"\n",(0,l.jsx)(n.h3,{id:"get-mlflow-run-instance-from-autologged-results",children:"Get MLflow Run instance from autologged results"}),"\n",(0,l.jsxs)(n.p,{children:["In some cases, you may want to access the MLflow Run instance associated with the autologged results.\nYou can access the most recent autologging run through the ",(0,l.jsx)(c.B,{fn:"mlflow.last_active_run"})," function."]}),"\n",(0,l.jsx)(n.p,{children:"Here's a sklearn autolog example that makes use of this function:"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:"import mlflow\n\nfrom sklearn.model_selection import train_test_split\nfrom sklearn.datasets import load_diabetes\nfrom sklearn.ensemble import RandomForestRegressor\n\nmlflow.autolog()\n\ndb = load_diabetes()\nX_train, X_test, y_train, y_test = train_test_split(db.data, db.target)\n\n# Create and train models.\nrf = RandomForestRegressor(n_estimators=100, max_depth=6, max_features=3)\nrf.fit(X_train, y_train)\n\n# Use the model to make predictions on the test dataset.\npredictions = rf.predict(X_test)\nautolog_run = mlflow.last_active_run()\nprint(autolog_run)\n# <Run:\n#    data=<RunData:\n#        metrics={'accuracy': 0.0},\n#        params={'n_estimators': '100', 'max_depth': '6', 'max_features': '3'},\n#        tags={'estimator_class': 'sklearn.ensemble._forest.RandomForestRegressor', 'estimator_name': 'RandomForestRegressor'}\n#    >,\n#    info=<RunInfo:\n#        artifact_uri='file:///Users/andrew/Code/mlflow/mlruns/0/0c0b.../artifacts',\n#        end_time=163...0,\n#        run_id='0c0b...',\n#        start_time=163...0,\n#        status='FINISHED',\n#        user_id='ME'>\n#    >\n"})})]})}function f(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(p,{...e})}):p(e)}},79329:(e,n,t)=>{t.d(n,{A:()=>i});t(96540);var r=t(34164);const l={tabItem:"tabItem_Ymn6"};var a=t(74848);function i(e){let{children:n,hidden:t,className:i}=e;return(0,a.jsx)("div",{role:"tabpanel",className:(0,r.A)(l.tabItem,i),hidden:t,children:n})}}}]);