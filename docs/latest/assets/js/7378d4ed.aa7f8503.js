"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[4155],{10916:(e,n,i)=>{i.d(n,{A:()=>r});const r=i.p+"assets/images/recipes_evaluate_step_card-55a914d6dad9414b7e1c95789c732d01.png"},28453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>a});var r=i(96540);const t={},s=r.createContext(t);function l(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),r.createElement(s.Provider,{value:n},e.children)}},51748:(e,n,i)=>{i.d(n,{A:()=>r});const r=i.p+"assets/images/recipes_databricks_ui-0074e1c7ac262b92e2621e9028979def.png"},52469:(e,n,i)=>{i.d(n,{A:()=>r});const r=i.p+"assets/images/recipes_databricks_repo_ui-b3760db4a0f58a4e59bb9e4f80b5de5e.png"},52516:(e,n,i)=>{i.d(n,{A:()=>r});const r=i.p+"assets/images/recipes_databricks_dag-c6efa40f3909566e70cdcfbf66168b12.png"},59099:(e,n,i)=>{i.d(n,{A:()=>r});const r=i.p+"assets/images/recipes_databricks_fixme-d3976c6cd04ee9e6f07abbb8f7618d92.png"},59684:(e,n,i)=>{i.d(n,{A:()=>r});const r=i.p+"assets/images/recipes_databricks_notebook_ui-508317080ed050ab34c6fcc1f460591b.png"},65537:(e,n,i)=>{i.d(n,{A:()=>v});var r=i(96540),t=i(34164),s=i(65627),l=i(56347),a=i(50372),o=i(30604),c=i(11861),p=i(78749);function d(e){return r.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function h(e){const{values:n,children:i}=e;return(0,r.useMemo)((()=>{const e=n??function(e){return d(e).map((e=>{let{props:{value:n,label:i,attributes:r,default:t}}=e;return{value:n,label:i,attributes:r,default:t}}))}(i);return function(e){const n=(0,c.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,i])}function m(e){let{value:n,tabValues:i}=e;return i.some((e=>e.value===n))}function f(e){let{queryString:n=!1,groupId:i}=e;const t=(0,l.W6)(),s=function(e){let{queryString:n=!1,groupId:i}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!i)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return i??null}({queryString:n,groupId:i});return[(0,o.aZ)(s),(0,r.useCallback)((e=>{if(!s)return;const n=new URLSearchParams(t.location.search);n.set(s,e),t.replace({...t.location,search:n.toString()})}),[s,t])]}function u(e){const{defaultValue:n,queryString:i=!1,groupId:t}=e,s=h(e),[l,o]=(0,r.useState)((()=>function(e){let{defaultValue:n,tabValues:i}=e;if(0===i.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!m({value:n,tabValues:i}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${i.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const r=i.find((e=>e.default))??i[0];if(!r)throw new Error("Unexpected error: 0 tabValues");return r.value}({defaultValue:n,tabValues:s}))),[c,d]=f({queryString:i,groupId:t}),[u,g]=function(e){let{groupId:n}=e;const i=function(e){return e?`docusaurus.tab.${e}`:null}(n),[t,s]=(0,p.Dv)(i);return[t,(0,r.useCallback)((e=>{i&&s.set(e)}),[i,s])]}({groupId:t}),x=(()=>{const e=c??u;return m({value:e,tabValues:s})?e:null})();(0,a.A)((()=>{x&&o(x)}),[x]);return{selectedValue:l,selectValue:(0,r.useCallback)((e=>{if(!m({value:e,tabValues:s}))throw new Error(`Can't select invalid tab value=${e}`);o(e),d(e),g(e)}),[d,g,s]),tabValues:s}}var g=i(9136);const x={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var w=i(74848);function y(e){let{className:n,block:i,selectedValue:r,selectValue:l,tabValues:a}=e;const o=[],{blockElementScrollPositionUntilNextRender:c}=(0,s.a_)(),p=e=>{const n=e.currentTarget,i=o.indexOf(n),t=a[i].value;t!==r&&(c(n),l(t))},d=e=>{let n=null;switch(e.key){case"Enter":p(e);break;case"ArrowRight":{const i=o.indexOf(e.currentTarget)+1;n=o[i]??o[0];break}case"ArrowLeft":{const i=o.indexOf(e.currentTarget)-1;n=o[i]??o[o.length-1];break}}n?.focus()};return(0,w.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,t.A)("tabs",{"tabs--block":i},n),children:a.map((e=>{let{value:n,label:i,attributes:s}=e;return(0,w.jsx)("li",{role:"tab",tabIndex:r===n?0:-1,"aria-selected":r===n,ref:e=>{o.push(e)},onKeyDown:d,onClick:p,...s,className:(0,t.A)("tabs__item",x.tabItem,s?.className,{"tabs__item--active":r===n}),children:i??n},n)}))})}function j(e){let{lazy:n,children:i,selectedValue:s}=e;const l=(Array.isArray(i)?i:[i]).filter(Boolean);if(n){const e=l.find((e=>e.props.value===s));return e?(0,r.cloneElement)(e,{className:(0,t.A)("margin-top--md",e.props.className)}):null}return(0,w.jsx)("div",{className:"margin-top--md",children:l.map(((e,n)=>(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==s})))})}function b(e){const n=u(e);return(0,w.jsxs)("div",{className:(0,t.A)("tabs-container",x.tabList),children:[(0,w.jsx)(y,{...n,...e}),(0,w.jsx)(j,{...n,...e})]})}function v(e){const n=(0,g.A)();return(0,w.jsx)(b,{...e,children:d(e.children)},String(n))}},67756:(e,n,i)=>{i.d(n,{B:()=>o});i(96540);const r=JSON.parse('{"mlflow.anthropic":"api_reference/python_api/mlflow.anthropic.html","mlflow.artifacts":"api_reference/python_api/mlflow.artifacts.html","mlflow.autogen":"api_reference/python_api/mlflow.autogen.html","mlflow.bedrock":"api_reference/python_api/mlflow.bedrock.html","mlflow.catboost":"api_reference/python_api/mlflow.catboost.html","mlflow.client":"api_reference/python_api/mlflow.client.html","mlflow.config":"api_reference/python_api/mlflow.config.html","mlflow.crewai":"api_reference/python_api/mlflow.crewai.html","mlflow.data":"api_reference/python_api/mlflow.data.html","mlflow.deployments":"api_reference/python_api/mlflow.deployments.html","mlflow.diviner":"api_reference/python_api/mlflow.diviner.html","mlflow.dspy":"api_reference/python_api/mlflow.dspy.html","mlflow.entities":"api_reference/python_api/mlflow.entities.html","mlflow.environment_variables":"api_reference/python_api/mlflow.environment_variables.html","mlflow.fastai":"api_reference/python_api/mlflow.fastai.html","mlflow.gateway":"api_reference/python_api/mlflow.gateway.html","mlflow.gemini":"api_reference/python_api/mlflow.gemini.html","mlflow.groq":"api_reference/python_api/mlflow.groq.html","mlflow.h2o":"api_reference/python_api/mlflow.h2o.html","mlflow.johnsnowlabs":"api_reference/python_api/mlflow.johnsnowlabs.html","mlflow.keras":"api_reference/python_api/mlflow.keras.html","mlflow.langchain":"api_reference/python_api/mlflow.langchain.html","mlflow.lightgbm":"api_reference/python_api/mlflow.lightgbm.html","mlflow.litellm":"api_reference/python_api/mlflow.litellm.html","mlflow.llama_index":"api_reference/python_api/mlflow.llama_index.html","mlflow.metrics":"api_reference/python_api/mlflow.metrics.html","mlflow.mistral":"api_reference/python_api/mlflow.mistral.html","mlflow.mleap":"api_reference/python_api/mlflow.mleap.html","mlflow.models":"api_reference/python_api/mlflow.models.html","mlflow.onnx":"api_reference/python_api/mlflow.onnx.html","mlflow.openai":"api_reference/python_api/mlflow.openai.html","mlflow.paddle":"api_reference/python_api/mlflow.paddle.html","mlflow.pmdarima":"api_reference/python_api/mlflow.pmdarima.html","mlflow.projects":"api_reference/python_api/mlflow.projects.html","mlflow.promptflow":"api_reference/python_api/mlflow.promptflow.html","mlflow.prophet":"api_reference/python_api/mlflow.prophet.html","mlflow.pyfunc":"api_reference/python_api/mlflow.pyfunc.html","mlflow.pyspark.ml":"api_reference/python_api/mlflow.pyspark.ml.html","mlflow.pytorch":"api_reference/python_api/mlflow.pytorch.html","mlflow.recipes":"api_reference/python_api/mlflow.recipes.html","mlflow":"api_reference/python_api/mlflow.html","mlflow.sagemaker":"api_reference/python_api/mlflow.sagemaker.html","mlflow.sentence_transformers":"api_reference/python_api/mlflow.sentence_transformers.html","mlflow.server":"api_reference/python_api/mlflow.server.html","mlflow.shap":"api_reference/python_api/mlflow.shap.html","mlflow.sklearn":"api_reference/python_api/mlflow.sklearn.html","mlflow.spacy":"api_reference/python_api/mlflow.spacy.html","mlflow.spark":"api_reference/python_api/mlflow.spark.html","mlflow.statsmodels":"api_reference/python_api/mlflow.statsmodels.html","mlflow.system_metrics":"api_reference/python_api/mlflow.system_metrics.html","mlflow.tensorflow":"api_reference/python_api/mlflow.tensorflow.html","mlflow.tracing":"api_reference/python_api/mlflow.tracing.html","mlflow.transformers":"api_reference/python_api/mlflow.transformers.html","mlflow.types":"api_reference/python_api/mlflow.types.html","mlflow.utils":"api_reference/python_api/mlflow.utils.html","mlflow.xgboost":"api_reference/python_api/mlflow.xgboost.html","mlflow.server.auth":"api_reference/auth/python-api.html"}');var t=i(29030),s=i(56289),l=i(74848);const a=e=>{const n=e.split(".");for(let i=n.length;i>0;i--){const e=n.slice(0,i).join(".");if(r[e])return e}return null};function o(e){let{fn:n,children:i}=e;const o=a(n);if(!o)return(0,l.jsx)(l.Fragment,{children:i});const c=(0,t.Ay)(`/${r[o]}#${n}`);return(0,l.jsx)(s.A,{to:c,target:"_blank",children:i??(0,l.jsxs)("code",{children:[n,"()"]})})}},79329:(e,n,i)=>{i.d(n,{A:()=>l});i(96540);var r=i(34164);const t={tabItem:"tabItem_Ymn6"};var s=i(74848);function l(e){let{children:n,hidden:i,className:l}=e;return(0,s.jsx)("div",{role:"tabpanel",className:(0,r.A)(t.tabItem,l),hidden:i,children:n})}},82856:(e,n,i)=>{i.d(n,{A:()=>r});const r=i.p+"assets/images/recipes_databricks_logged_artifacts-1ae7b3cb40b51906d8fd0cca01c2c844.png"},89862:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>h,contentTitle:()=>d,default:()=>u,frontMatter:()=>p,metadata:()=>r,toc:()=>m});const r=JSON.parse('{"id":"recipes/index","title":"MLflow Recipes","description":"MLflow Recipes is deprecated and will be removed in a future release.","source":"@site/docs/recipes/index.mdx","sourceDirName":"recipes","slug":"/recipes/","permalink":"/docs/latest/recipes/","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":16,"frontMatter":{"sidebar_position":16},"sidebar":"docsSidebar","previous":{"title":"Prompt Engineering UI (Experimental)","permalink":"/docs/latest/llms/prompt-engineering/"},"next":{"title":"MLflow Evaluation","permalink":"/docs/latest/model-evaluation/"}}');var t=i(74848),s=i(28453),l=i(56289),a=i(67756),o=i(65537),c=i(79329);const p={sidebar_position:16},d="MLflow Recipes",h={},m=[{value:"Quickstarts",id:"quickstarts",level:2},{value:"Prerequisites",id:"prerequisites",level:3},{value:"NYC taxi fare prediction example",id:"nyc-taxi-fare-prediction-example",level:3},{value:"Classification problem example",id:"classification-problem-example",level:3},{value:"Key concepts",id:"key-concepts",level:2},{value:"Usage",id:"usage",level:2},{value:"Model development workflow",id:"model-development-workflow",level:3},{value:"Development environments",id:"development-environments",level:3},{value:"[Databricks]",id:"databricks",level:4},{value:"[Local with Jupyter Notebook]",id:"local-with-jupyter-notebook",level:4},{value:"[Edit locally with IDE (VSCode) and run on Databricks]",id:"edit-locally-with-ide-vscode-and-run-on-databricks",level:4},{value:"Recipe Templates",id:"recipe-templates",level:2},{value:"Detailed reference guide",id:"detailed-reference-guide",level:2},{value:"Template structure",id:"recipe-template-structure",level:3},{value:"Working with profiles",id:"working-with-profiles",level:3}];function f(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,s.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(n.header,{children:(0,t.jsx)(n.h1,{id:"mlflow-recipes",children:"MLflow Recipes"})}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsx)(n.p,{children:"MLflow Recipes is deprecated and will be removed in a future release."})}),"\n",(0,t.jsx)(n.p,{children:"MLflow Recipes (previously known as MLflow Pipelines) is a framework that enables data scientists\nto quickly develop high-quality models and deploy them to production.\nCompared to ad-hoc ML workflows, MLflow Recipes offers several major benefits:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Get started quickly"}),": ",(0,t.jsx)(n.a,{href:"#recipe-templates",children:"Predefined templates"})," for common ML tasks,\nsuch as ",(0,t.jsx)(n.a,{href:"#regression-template",children:"regression modeling"}),", enable data scientists to get started\nquickly and focus on building great models, eliminating the large amount of boilerplate code that\nis traditionally required to curate datasets, engineer features, train & tune models, and package\nmodels for production deployment."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Iterate faster"}),": The intelligent recipe execution engine accelerates model development by\ncaching results from each step of the process and re-running the minimal set of steps as changes\nare made."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Easily ship to production"}),": The modular, git-integrated ",(0,t.jsx)(n.a,{href:"#recipe-templates-key-concept",children:"recipe structure"})," dramatically simplifies the handoff from development to\nproduction by ensuring that all model code, data, and configurations are easily reviewable and\ndeployable by ML engineers."]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"quickstarts",children:"Quickstarts"}),"\n",(0,t.jsx)(n.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsx)(l.A,{id:"recipes-installation",class:"anchor-with-sticky-navbar"}),"\n",(0,t.jsxs)(n.p,{children:["MLflow Recipes is available as an extension of the\n",(0,t.jsx)(n.a,{href:"https://pypi.org/project/mlflow/",children:"MLflow Python library"}),". You can install MLflow Recipes\nas follows:"]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Local"}),": Install MLflow from PyPI: ",(0,t.jsx)(n.code,{children:"pip install mlflow"}),".\nNote that MLflow Recipes requires ",(0,t.jsx)(n.a,{href:"https://www.gnu.org/software/make",children:"Make"}),",\nwhich may not be preinstalled on some Windows systems.\nWindows users must install Make before using MLflow Recipes. For more information about\ninstalling Make on Windows, see ",(0,t.jsx)(n.a,{href:"https://gnuwin32.sourceforge.net/install.html",children:"https://gnuwin32.sourceforge.net/install.html"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.strong,{children:"Databricks"}),": Install MLflow Recipes from a Databricks Notebook by running\n",(0,t.jsx)(n.code,{children:"%pip install mlflow"}),", or install MLflow Recipes on a Databricks Cluster by\nfollowing the PyPI library installation instructions ",(0,t.jsx)(n.a,{href:"https://docs.databricks.com/libraries/cluster-libraries.html#install-a-library-on-a-cluster",children:"here"}),"\nand specifying the ",(0,t.jsx)(n.code,{children:"mlflow"})," package string."]}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.a,{href:"https://docs.databricks.com/runtime/dbr.html",children:"Databricks Runtime"})," version 11.0\nor greater is required in order to install MLflow Recipes on Databricks."]})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"nyc-taxi-fare-prediction-example",children:"NYC taxi fare prediction example"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.a,{href:"https://github.com/mlflow/recipes-examples/tree/main/regression",children:"NYC taxi fare prediction example"}),"\nuses the ",(0,t.jsx)(n.a,{href:"#regression-template",children:"MLflow Recipes Regression Template"})," to develop and score models on the\n",(0,t.jsx)(n.a,{href:"https://www1.nyc.gov/site/tlc/about/tlc-trip-record-data.page",children:"NYC Taxi (TLC) Trip Record Dataset"}),".\nYou can run the example locally by ",(0,t.jsx)(n.a,{href:"#recipes-installation",children:"installing MLflow Recipes"})," and running the\n",(0,t.jsx)(n.a,{href:"https://github.com/mlflow/recipes-examples/blob/main/regression/notebooks/jupyter.ipynb",children:"Jupyter example regression notebook"}),".\nYou can run the example on Databricks by\n",(0,t.jsx)(n.a,{href:"https://docs.databricks.com/repos/work-with-notebooks-other-files.html#clone-a-remote-git-repository",children:"cloning the example repository with Databricks Repos"}),"\nand running the ",(0,t.jsx)(n.a,{href:"https://github.com/mlflow/recipes-examples/blob/main/regression/notebooks/databricks.py",children:"Databricks example regression notebook"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["To build and score models for your own use cases, we recommend using the\n",(0,t.jsx)(n.a,{href:"#regression-template",children:"MLflow Recipes Regression Template"}),". For more information, see the\n",(0,t.jsx)(n.a,{href:"https://github.com/mlflow/recipes-regression-template/blob/main/README.md",children:"Regression Template reference guide"}),"."]}),"\n",(0,t.jsx)(n.h3,{id:"classification-problem-example",children:"Classification problem example"}),"\n",(0,t.jsxs)(n.p,{children:["The ",(0,t.jsx)(n.a,{href:"https://github.com/mlflow/recipes-examples/tree/main/classification",children:"Classification problem example"}),"\nuses the ",(0,t.jsx)(n.a,{href:"#classification-template",children:"MLflow Recipes Classification Template"})," to develop and score models on the\n",(0,t.jsx)(n.a,{href:"https://github.com/mlflow/recipes-examples/tree/main/classification/data",children:"Wine Quality Dataset"}),".\nYou can run the example locally\nby ",(0,t.jsx)(n.a,{href:"#recipes-installation",children:"installing MLflow Recipes"})," and running the\n",(0,t.jsx)(n.a,{href:"https://github.com/mlflow/recipes-examples/blob/main/classification/notebooks/jupyter.ipynb",children:"Jupyter example classification notebook"}),".\nYou can run the example on Databricks by\n",(0,t.jsx)(n.a,{href:"https://docs.databricks.com/repos/work-with-notebooks-other-files.html#clone-a-remote-git-repository",children:"cloning the example repository with Databricks Repos"}),"\nand running the ",(0,t.jsx)(n.a,{href:"https://github.com/mlflow/recipes-examples/blob/main/classification/notebooks/databricks.py",children:"Databricks example classification notebook"}),"."]}),"\n",(0,t.jsxs)(n.p,{children:["To build and score models for your own use cases, we recommend using the\n",(0,t.jsx)(n.a,{href:"#classification-template",children:"MLflow Recipes Classification Template"}),". For more information, see the\n",(0,t.jsx)(n.a,{href:"https://github.com/mlflow/recipes-classification-template/blob/main/README.md",children:"Classification Template reference guide"}),"."]}),"\n",(0,t.jsx)(n.h2,{id:"key-concepts",children:"Key concepts"}),"\n",(0,t.jsx)(l.A,{id:"steps-key-concept",class:"anchor-with-sticky-navbar"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Steps"}),": A Step represents an individual ML operation, such as ingesting data,\nfitting an estimator, evaluating a model against test data, or deploying a model\nfor real-time scoring. Each Step accepts a collection of well-defined inputs and\nproduce well-defined outputs according to user-defined configurations and code."]}),"\n"]}),"\n",(0,t.jsx)(l.A,{id:"recipes-key-concept",class:"anchor-with-sticky-navbar"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Recipes"}),": A Recipe is an ordered composition of ",(0,t.jsx)(n.a,{href:"#steps-key-concept",children:"Steps"}),"\nused to solve an ML problem or perform an MLOps task, such as developing a\nregression model or performing batch model scoring on production data.\nMLflow Recipes provides ",(0,t.jsx)(a.B,{fn:"mlflow.recipes.Recipe",children:"API"}),"\nand a ",(0,t.jsx)(l.A,{to:"/api_reference/cli.html",target:"_blank",children:"CLI"})," for running recipes and inspecting their results."]}),"\n"]}),"\n",(0,t.jsx)(l.A,{id:"recipe-templates-key-concept",class:"anchor-with-sticky-navbar"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Templates"}),": A Recipe Template is a git repository with a ",(0,t.jsx)(n.a,{href:"#recipe-template-structure",children:"standardized, modular layout"}),"\ncontaining all of the customizable code and configurations for a ",(0,t.jsx)(n.a,{href:"#recipes-key-concept",children:"Recipe"}),".\nConfigurations are defined in YAML format for easy review via the\n",(0,t.jsx)(n.a,{href:"https://github.com/mlflow/recipes-regression-template/blob/main/recipe.yaml",children:"recipe.yaml"})," file and\n",(0,t.jsx)(n.a,{href:"#profiles-key-concept",children:"Profile YAML files"}),". Each template also defines its requirements, data science notebooks, and tests. MLflow Recipes\nincludes ",(0,t.jsx)(n.a,{href:"#recipe-templates",children:"predefined templates"})," for a variety of model development and\nMLOps tasks."]}),"\n"]}),"\n",(0,t.jsx)(l.A,{id:"profiles-key-concept",class:"anchor-with-sticky-navbar"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Profiles"}),": Profiles contain user-specific or environment-specific configurations for a\n",(0,t.jsx)(n.a,{href:"#recipes-key-concept",children:"Recipe"}),", such as the particular set of hyperparameters being\ntuned by a data scientist in development or the MLflow Model Registry URI and credentials\nused to store production-worthy models. Each profile is represented as a YAML file\nin the ",(0,t.jsx)(n.a,{href:"#recipe-templates-key-concept",children:"Recipe Template"})," (e.g.\n",(0,t.jsx)(n.a,{href:"https://github.com/mlflow/recipes-examples/blob/main/regression/profiles/local.yaml",children:"local.yaml"}),"\nand ",(0,t.jsx)(n.a,{href:"https://github.com/mlflow/recipes-examples/blob/main/regression/profiles/databricks.yaml",children:"databricks.yaml"}),")."]}),"\n"]}),"\n",(0,t.jsx)(l.A,{id:"step-cards-key-concept",class:"anchor-with-sticky-navbar"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"Step Cards"}),": Step Cards display the results produced by running a\n",(0,t.jsx)(n.a,{href:"#steps-key-concept",children:"Step"}),", including dataset profiles, model performance & explainability\nplots, overviews of the best model parameters found during tuning, and more. Step Cards and their\ncorresponding dataset and model information are also logged to MLflow Tracking."]}),"\n"]}),"\n",(0,t.jsx)(n.h2,{id:"usage",children:"Usage"}),"\n",(0,t.jsx)(n.h3,{id:"model-development-workflow",children:"Model development workflow"}),"\n",(0,t.jsx)(n.p,{children:"The general model development workflow for using MLflow Recipes is as follows:"}),"\n",(0,t.jsxs)(n.ol,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Clone a ",(0,t.jsx)(n.a,{href:"#recipe-templates",children:"Recipe Template"})," git repository corresponding to the ML\nproblem that you wish to solve. Follow the template's README file for template-specific\ninstructions."]}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["[Local] Clone the ",(0,t.jsx)(n.a,{href:"#regression-template",children:"MLflow Recipes Regression Template"})," into a local directory."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"git clone https://github.com/mlflow/recipes-regression-template\n"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["[Databricks] Clone the ",(0,t.jsx)(n.a,{href:"#regression-template",children:"MLflow Recipes Regression Template"})," git repository using\n",(0,t.jsx)(n.a,{href:"https://docs.databricks.com/repos/index.html",children:"Databricks Repos"}),"."]}),"\n",(0,t.jsx)("div",{style:{width:"60% "},children:(0,t.jsx)(n.img,{src:i(52469).A+"",width:"2796",height:"1404"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Edit required fields marked by ",(0,t.jsx)(n.code,{children:"FIXME::REQUIRED"})," comments in ",(0,t.jsx)(n.code,{children:"recipe.yaml"})," and\n",(0,t.jsx)(n.code,{children:"profiles/*.yaml"}),". The recipe is runnable once all required fields are filled with\nproper values. You may proceed to step 3 if this is the first time going through this step.\nOtherwise, continue to edit the YAML config files as well as ",(0,t.jsx)(n.code,{children:"steps/*.py"})," files,\nfilling out areas marked by ",(0,t.jsx)(n.code,{children:"FIXME::OPTIONAL"})," as you see fit to\ncustomize the recipe steps to your ML problem for better model performance."]}),"\n",(0,t.jsx)("div",{style:{width:"60%"},children:(0,t.jsx)(n.img,{src:i(59099).A+"",width:"2204",height:"1820"})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Run the recipe by selecting a desired profile. Profiles are used to quickly switch environment\nspecific recipe settings, such as ingest data location.\nWhen a recipe run completes, you may inspect the run results. MLflow Recipes\ncreates and displays an interactive ",(0,t.jsx)(n.strong,{children:"Step Card"})," with the results of the last executed ",(0,t.jsx)(n.a,{href:"#steps-key-concept",children:"step"}),".\nEach ",(0,t.jsx)(n.a,{href:"#recipe-templates",children:"Recipe Template"})," also includes a\n",(0,t.jsx)(n.a,{href:"https://github.com/mlflow/recipes-regression-template/blob/main/notebooks/databricks.py",children:"Databricks Notebook"}),"\nand a ",(0,t.jsx)(n.a,{href:"https://github.com/mlflow/recipes-regression-template/blob/main/notebooks/jupyter.ipynb",children:"Jupyter Notebook"}),"\nfor running the recipe and inspecting its results."]}),"\n",(0,t.jsxs)(n.p,{children:["Example API and CLI workflows for running the ",(0,t.jsx)(n.a,{href:"#regression-template",children:"MLflow Recipes Regression Template"})," and inspecting\nresults. Note that recipes must be run from within their corresponding git repositories."]}),"\n",(0,t.jsxs)(o.A,{children:[(0,t.jsx)(c.A,{value:"python",label:"Python",default:!0,children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'import os\nfrom mlflow.recipes import Recipe\nfrom mlflow.pyfunc import PyFuncModel\n\nos.chdir("~/recipes-regression-template")\nregression_recipe = Recipe(profile="local")\n# Run the full recipe\nregression_recipe.run()\n# Inspect the model training results\nregression_recipe.inspect(step="train")\n# Load the trained model\nregression_model_recipe: PyFuncModel = regression_recipe.get_artifact("model")\n'})})}),(0,t.jsx)(c.A,{value:"sh",label:"Sh",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"git clone https://github.com/mlflow/recipes-regression-template\ncd recipes-regression-template\n# Run the full recipe\nmlflow recipes run --profile local\n# Inspect the model training results\nmlflow recipes inspect --step train --profile local\n# Inspect the resulting model performance evaluations\nmlflow recipes inspect --step evaluate --profile local\n"})})})]}),"\n",(0,t.jsx)("figure",{style:{width:"60%"},children:(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.img,{src:i(10916).A+"",width:"2428",height:"1168"}),(0,t.jsxs)("figcaption",{children:["An example step\ncard produced by running the ",(0,t.jsx)(n.strong,{children:"evaluate"})," step of the\n",(0,t.jsx)(n.a,{href:"#regression-template",children:"MLflow Recipes Regression Template"}),". The step card results\nindicate that the trained model passed all performance validations and is ready for\nregistration with the ",(0,t.jsx)(n.a,{href:"/model-registry",children:"MLflow Model Registry"}),"."]})]})}),"\n",(0,t.jsx)("figure",{style:{width:"60%"},children:(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.img,{src:i(82856).A+"",width:"2974",height:"1794"}),"\n",(0,t.jsx)("figcaption",{children:"An example MLflow run view page, showing artifacts logged from the Recipe's steps."})]})}),"\n",(0,t.jsx)("figure",{children:(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.img,{src:i(59684).A+"",width:"3224",height:"1660"}),"\n",(0,t.jsxs)("figcaption",{children:["Example recipe run from the\n",(0,t.jsx)(n.a,{href:"https://github.com/mlflow/recipes-regression-template/blob/main/notebooks/databricks.py",children:"Databricks Notebook"}),"\nincluded in the ",(0,t.jsx)(n.a,{href:"#regression-template",children:"MLflow Recipes Regression Template"}),"."]})]})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:['Data profiling is often best viewed with "quantiles" mode. To switch it on, on the Facet\ndata profile, find ',(0,t.jsx)(n.code,{children:"Chart to show"}),", click the selector below, and choose ",(0,t.jsx)(n.code,{children:"Quantiles"}),"."]})}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["Iterate over step 2 and 3: make changes to an individual step, and test them by running\nthe step and observing the results it produces.\nUse ",(0,t.jsx)(n.code,{children:"Recipe.inspect()"})," to visualize the overall Recipe dependency graph and artifacts\neach step produces.\nUse ",(0,t.jsx)(n.code,{children:"Recipe.get_artifact()"})," to further inspect individual step outputs in a notebook."]}),"\n",(0,t.jsxs)(n.p,{children:["MLflow Recipes intelligently caches results from each ",(0,t.jsx)(n.a,{href:"#steps-key-concept",children:"Recipe Step"}),",\nensuring that steps are only executed if their inputs, code, or configurations have changed,\nor if such changes have occurred in dependent steps. Once you are satisfied with the results of\nyour changes, commit them to a branch of the ",(0,t.jsx)(n.a,{href:"#recipe-templates-key-concept",children:"Recipe Repository"}),"\nin order to ensure reproducibility, and share or review the\nchanges with your team."]}),"\n",(0,t.jsx)("figure",{style:{width:"60%"},children:(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.img,{src:i(52516).A+"",width:"2072",height:"1812"}),"\n",(0,t.jsx)("figcaption",{children:"Example Recipe.inspect() output, showing the dependency graph of recipe steps and artifacts each step produces."})]})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["Before testing changes in a staging or production environment, it is recommended that you\ncommit the changes to a branch of the ",(0,t.jsx)(n.a,{href:"#recipe-templates-key-concept",children:"Recipe Repository"}),"\nto ensure reproducibility."]})}),"\n",(0,t.jsx)(n.admonition,{type:"note",children:(0,t.jsxs)(n.p,{children:["By default, MLflow Recipes caches results from each ",(0,t.jsx)(n.a,{href:"#steps-key-concept",children:"Recipe Step"}),"\nwithin the ",(0,t.jsx)(n.code,{children:".mlflow"})," subdirectory of the home folder on the local filesystem.\nThe ",(0,t.jsx)(n.code,{children:"MLFLOW_RECIPES_EXECUTION_DIRECTORY"})," environment variable can be used to specify\nan alternative location for caching results."]})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h3,{id:"development-environments",children:"Development environments"}),"\n",(0,t.jsx)(n.p,{children:"We recommend using one of the following environment configurations to develop models with MLflow Recipes:"}),"\n",(0,t.jsxs)("dl",{children:[(0,t.jsx)("dt",{children:(0,t.jsx)(n.h4,{id:"databricks",children:"[Databricks]"})}),(0,t.jsxs)("dd",{children:[(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Edit YAML config and Python files in Databricks Repos. Open separate browser tabs for each\nfile module that you wish to modify. For example,\none for the recipe config file ",(0,t.jsx)(n.code,{children:"recipe.yaml"}),",\none for the profile config file ",(0,t.jsx)(n.code,{children:"profile/databricks.yaml"}),",\none for the driver notebook ",(0,t.jsx)(n.code,{children:"notebooks/databricks.py"}),",\nand one for the current step (e.g. train) under development ",(0,t.jsx)(n.code,{children:"steps/train.py"}),"."]}),"\n",(0,t.jsxs)(n.li,{children:["Use ",(0,t.jsx)(n.code,{children:"notebooks/databricks.py"})," as the driver to run recipe steps and inspect its output."]}),"\n",(0,t.jsx)(n.li,{children:"Pin the workspace browser for easy file navigation."}),"\n"]}),(0,t.jsx)("div",{style:{width:"60%"},children:(0,t.jsx)(n.p,{children:(0,t.jsx)(n.img,{src:i(51748).A+"",width:"3014",height:"2024"})})})]}),(0,t.jsx)("dt",{children:(0,t.jsx)(n.h4,{id:"local-with-jupyter-notebook",children:"[Local with Jupyter Notebook]"})}),(0,t.jsx)("dd",{children:(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["Use ",(0,t.jsx)(n.code,{children:"notebooks/jupyter.ipynb"})," as the driver to run recipe steps and inspect its output."]}),"\n",(0,t.jsxs)(n.li,{children:["Edit ",(0,t.jsx)(n.code,{children:"recipe.yaml"}),", ",(0,t.jsx)(n.code,{children:"steps/*.py"})," and ",(0,t.jsx)(n.code,{children:"profiles/*.yaml"})," accordingly with an editor of your\nchoice."]}),"\n",(0,t.jsxs)(n.li,{children:["To run the entire recipe, either run ",(0,t.jsx)(n.code,{children:"notebooks/jupyter.ipynb"})," or on commandline, invoke\n",(0,t.jsx)(n.code,{children:"mlflow recipes run --profile local"})," (change the current working directory to the project root first)."]}),"\n"]})}),(0,t.jsx)("dt",{children:(0,t.jsx)(n.h4,{id:"edit-locally-with-ide-vscode-and-run-on-databricks",children:"[Edit locally with IDE (VSCode) and run on Databricks]"})}),(0,t.jsxs)("dd",{children:[(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"Edit files on your local machine with VSCode and Jupyter plugin."}),"\n",(0,t.jsxs)(n.li,{children:["Use ",(0,t.jsx)(n.a,{href:"https://docs.databricks.com/dev-tools/dbx.html",children:"dbx"})," to sync them to\n",(0,t.jsx)(n.a,{href:"https://docs.databricks.com/repos/index.html",children:"Databricks Repos"})," as demonstrated below."]}),"\n",(0,t.jsxs)(n.li,{children:["On Databricks, use the ",(0,t.jsx)(n.code,{children:"notebooks/databricks.py"})," notebook as the driver to run recipe\nsteps and inspect their outputs."]}),"\n"]}),(0,t.jsxs)(n.p,{children:["Example workflow for efficiently editing a recipe on a local machine\nand synchronizing changes to ",(0,t.jsx)(n.a,{href:"https://docs.databricks.com/repos/index.html",children:"Databricks Repos"}),":"]}),(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"# Install the Databricks CLI, which is used to remotely access your Databricks Workspace\npip install databricks-cli\n# Configure remote access to your Databricks Workspace\ndatabricks configure\n# Install dbx, which is used to automatically sync changes to and from Databricks Repos\npip install dbx\n# Clone the MLflow Recipes Regression Template\ngit clone https://github.com/mlflow/recipes-regression-template\n# Enter the MLflow Recipes Regression Template directory and configure dbx within it\ncd recipes-regression-template\ndbx configure\n# Use dbx to enable syncing from the repository directory to Databricks Repos\ndbx sync repo -d recipes-regression-template\n# Iteratively make changes to files in the repository directory and observe that they\n# are automatically synced to Databricks Repos\n"})})]})]}),"\n",(0,t.jsx)(n.h2,{id:"recipe-templates",children:"Recipe Templates"}),"\n",(0,t.jsx)(n.p,{children:"MLflow Recipes currently offers the following predefined templates that can be easily customized\nto develop and deploy high-quality, production-ready models for your use cases:"}),"\n",(0,t.jsx)(l.A,{id:"regression-template",className:"anchor-with-sticky-navbar"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"MLflow Recipes Regression Template"}),": The MLflow Recipes Regression Template is designed for developing and scoring\nregression models. For more information, see the ",(0,t.jsx)(n.a,{href:"https://github.com/mlflow/recipes-regression-template/blob/main/README.md",children:"Regression Template reference guide"}),"."]}),"\n"]}),"\n",(0,t.jsx)(l.A,{id:"classification-template",class:"anchor-with-sticky-navbar"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:[(0,t.jsx)(n.strong,{children:"MLflow Recipes Classification Template"}),": The MLflow Recipes Classification Template is designed for developing and scoring\nclassification models. For more information, see the ",(0,t.jsx)(n.a,{href:"https://github.com/mlflow/recipes-classification-template/blob/main/README.md",children:"Classification Template reference guide"}),"."]}),"\n"]}),"\n",(0,t.jsx)(n.p,{children:"Additional recipes for a variety of ML problems and MLOps tasks are under active development."}),"\n",(0,t.jsx)(n.h2,{id:"detailed-reference-guide",children:"Detailed reference guide"}),"\n",(0,t.jsx)(n.h3,{id:"recipe-template-structure",children:"Template structure"}),"\n",(0,t.jsxs)(n.p,{children:["Recipe Templates are git repositories with a standardized, modular layout. The following\nexample provides an overview of the recipe repository structure. It is adapted from the\n",(0,t.jsx)(n.a,{href:"#regression-template",children:"MLflow Recipes Regression Template"}),"."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-plaintext",children:"\u251c\u2500\u2500 recipe.yaml\n\u251c\u2500\u2500 requirements.txt\n\u251c\u2500\u2500 steps\n\u2502   \u251c\u2500\u2500 ingest.py\n\u2502   \u251c\u2500\u2500 split.py\n\u2502   \u251c\u2500\u2500 transform.py\n\u2502   \u251c\u2500\u2500 train.py\n\u2502   \u251c\u2500\u2500 custom_metrics.py\n\u251c\u2500\u2500 profiles\n\u2502   \u251c\u2500\u2500 local.yaml\n\u2502   \u251c\u2500\u2500 databricks.yaml\n\u251c\u2500\u2500 tests\n\u2502   \u251c\u2500\u2500 ingest_test.py\n\u2502   \u251c\u2500\u2500 ...\n\u2502   \u251c\u2500\u2500 train_test.py\n\u2502   \u251c\u2500\u2500 ...\n"})}),"\n",(0,t.jsx)(n.p,{children:"The main components of the Recipe Template layout, which are common across all recipes, are:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"recipe.yaml"}),": The main recipe configuration file that declaratively defines the\nattributes and behavior of each recipe step, such as the input dataset to use for training\na model or the performance criteria for promoting a model to production. For reference,\nsee the ",(0,t.jsx)(n.a,{href:"https://github.com/mlflow/recipes-regression-template/blob/main/recipe.yaml",children:"recipe.yaml"}),"\nconfiguration file from the ",(0,t.jsx)(n.a,{href:"#regression-template",children:"MLflow Recipes Regression Template"}),"."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"requirements.txt"}),": A ",(0,t.jsx)(n.a,{href:"https://pip.pypa.io/en/stable/reference/requirements-file-format",children:"pip requirements file"}),"\nspecifying packages that must be installed in order to run the recipe."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"steps"}),": A directory containing Python code modules used by the recipe steps. For example,\nthe ",(0,t.jsx)(n.a,{href:"#regression-template",children:"MLflow Recipes Regression Template"})," defines the estimator type and parameters to use\nwhen training a model in ",(0,t.jsx)(n.a,{href:"https://github.com/mlflow/recipes-regression-template/blob/main/steps/train.py",children:"steps/train.py"}),"\nand defines custom metric computations in\n",(0,t.jsx)(n.a,{href:"https://github.com/mlflow/recipes-regression-template/blob/main/steps/custom_metrics.py",children:"steps/custom_metrics.py"}),"."]}),"\n",(0,t.jsx)(l.A,{id:"profiles-directory",class:"anchor-with-sticky-navbar"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"profiles"}),": A directory containing ",(0,t.jsx)(n.a,{href:"#profiles-key-concept",children:"Profile"})," customizations for\nthe configurations defined in ",(0,t.jsx)(n.code,{children:"recipe.yaml"}),". For example, the\n",(0,t.jsx)(n.a,{href:"#regression-template",children:"MLflow Recipes Regression Template"})," defines a\n",(0,t.jsx)(n.a,{href:"https://github.com/mlflow/recipes-regression-template/blob/main/profiles/local.yaml",children:"profiles/local.yaml profile"})," that\n",(0,t.jsx)(n.a,{href:"https://github.com/mlflow/recipes-regression-template/blob/main/profiles/local.yaml#L17",children:"customizes the dataset used for local model development"}),"\nand ",(0,t.jsx)(n.a,{href:"https://github.com/mlflow/recipes-regression-template/blob/main/profiles/local.yaml#L4-L7",children:"specifies a local MLflow Tracking store for logging model content"}),".\nThe ",(0,t.jsx)(n.a,{href:"#regression-template",children:"MLflow Recipes Regression Template"})," also\ndefines a |databricks profile| for development on Databricks."]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:[(0,t.jsx)(n.code,{children:"tests"}),": A directory containing Python test code for recipe steps. For example, the\n",(0,t.jsx)(n.a,{href:"#regression-template",children:"MLflow Recipes Regression Template"})," implements tests for the transformer and the estimator\ndefined in the respective ",(0,t.jsx)(n.code,{children:"steps/transform.py"})," and ",(0,t.jsx)(n.code,{children:"steps/train.py"})," modules."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.p,{children:["Shown below is an example ",(0,t.jsx)(n.a,{href:"https://github.com/mlflow/recipes-regression-template/blob/main/recipe.yaml",children:"recipe.yaml"}),"\nconfiguration file adapted from the ",(0,t.jsx)(n.a,{href:"#regression-template",children:"MLflow Recipes Regression Template"}),".\n",(0,t.jsx)(n.code,{children:"recipe.yaml"})," is the main configuration file for a recipe containing aggregated configurations for\nall recipe steps; ",(0,t.jsx)(n.a,{href:"#profiles-key-concept",children:"Profile"}),"-based substitutions and overrides are supported using\n",(0,t.jsx)(n.a,{href:"https://jinja.palletsprojects.com/",children:"Jinja2"})," templating syntax."]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'recipe: "regression/v1"\ntarget_col: "fare_amount"\nprimary_metrics: "root_mean_squared_error"\nsteps:\n  ingest: {{INGEST_CONFIG}}\n  split:\n    split_ratios: {{SPLIT_RATIOS|default([0.75, 0.125, 0.125])}}\n  transform:\n    using: custom\n    transformer_method: transformer_fn\n  train:\n    using: custom\n    estimator_method: estimator_fn\n  evaluate:\n    validation_criteria:\n      - metric: root_mean_squared_error\n        threshold: 10\n      - metric: weighted_mean_squared_error\n        threshold: 20\n  register:\n    allow_non_validated_model: false\ncustom_metrics:\n  - name: weighted_mean_squared_error\n    function: weighted_mean_squared_error\n    greater_is_better: False\n'})}),"\n",(0,t.jsx)(n.h3,{id:"working-with-profiles",children:"Working with profiles"}),"\n",(0,t.jsxs)(n.p,{children:["A profile is a collection of customizations for the configurations defined in the recipe's main\n",(0,t.jsx)(n.a,{href:"#recipe-template-structure",children:"recipe.yaml"})," file. Profiles are defined as YAML files\nwithin the recipe repository's ",(0,t.jsx)(n.a,{href:"#profiles-directory",children:"profiles directory"}),". When running a\nrecipe or inspecting its results, the desired profile is specified as an API or CLI argument."]}),"\n",(0,t.jsx)(n.p,{children:"Example API and CLI workflows for running recipes with different profile customizations"}),"\n",(0,t.jsxs)(o.A,{children:[(0,t.jsx)(c.A,{value:"python",label:"Python",default:!0,children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-python",children:'import os\nfrom mlflow.recipes import Recipe\n\nos.chdir("~/recipes-regression-template")\n# Run the regression recipe to train and evaluate the performance of an ElasticNet regressor\nregression_recipe_local_elasticnet = Recipe(profile="local-elasticnet")\nregression_recipe_local_elasticnet.run()\n# Run the recipe again to train and evaluate the performance of an SGD regressor\nregression_recipe_local_sgd = Recipe(profile="local-sgd")\nregression_recipe_local_sgd.run()\n# After finding the best model type and updating the \'shared-workspace\' profile accordingly,\n# run the recipe again to retrain the best model in a workspace where teammates can view it\nregression_recipe_shared = Recipe(profile="shared-workspace")\nregression_recipe_shared.run()\n'})})}),(0,t.jsx)(c.A,{value:"sh",label:"Sh",children:(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-sh",children:"git clone https://github.com/mlflow/recipes-regression-template\ncd recipes-regression-template\n# Run the regression recipe to train and evaluate the performance of an ElasticNet regressor\nmlflow recipes run --profile local-elasticnet\n# Run the recipe again to train and evaluate the performance of an SGD regressor\nmlflow recipes run --profile local-sgd\n# After finding the best model type and updating the 'shared-workspace' profile accordingly,\n# run the recipe again to retrain the best model in a workspace where teammates can view it\nmlflow recipes run --profile shared-workspace\n"})})})]}),"\n",(0,t.jsx)(n.p,{children:"The following profile customizations are supported:"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"overrides"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["If the ",(0,t.jsx)(n.code,{children:"recipe.yaml"})," configuration file defines a ",(0,t.jsx)(n.a,{href:"https://jinja.palletsprojects.com/",children:"Jinja2"}),"-templated\nattribute with a default value, a profile can override the value by mapping the attribute to a different\nvalue using YAML dictionary syntax. Note that override values may have arbitrarily nested\ntypes (e.g. lists, dictionaries, lists of dictionaries, ...)."]}),"\n",(0,t.jsxs)(n.p,{children:["Example ",(0,t.jsx)(n.code,{children:"recipe.yaml"})," configuration file defining an overridable\n",(0,t.jsx)(n.code,{children:"RMSE_THRESHOLD"})," attribute for validating model performance with a\ndefault value of ",(0,t.jsx)(n.code,{children:"10"})]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"steps:\n  evaluate:\n    validation_criteria:\n      - metric: root_mean_squared_error\n        # The maximum RMSE value on the test dataset that a model can have\n        # to be eligible for production deployment\n        threshold: { { RMSE_THRESHOLD|default(10) } }\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Example ",(0,t.jsx)(n.code,{children:"prod.yaml"})," profile that overrides ",(0,t.jsx)(n.code,{children:"RMSE_THRESHOLD"})," with\na custom value to more aggressively validate model quality for production"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"RMSE_THRESHOLD: 5.2\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"substitutions"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["If the ",(0,t.jsx)(n.code,{children:"recipe.yaml"})," configuration file defines a ",(0,t.jsx)(n.a,{href:"https://jinja.palletsprojects.com/",children:"Jinja2"}),"-templated\nattribute without a default value, a profile ",(0,t.jsx)(n.em,{children:"must"})," map the attribute to a specific value using\nYAML dictionary syntax. Note that substitute values may have arbitrarily nested types\n(e.g. lists, dictionaries, lists of dictionaries, ...)."]}),"\n",(0,t.jsxs)(n.p,{children:["Example ",(0,t.jsx)(n.code,{children:"recipe.yaml"})," configuration file defining a ",(0,t.jsx)(n.code,{children:"DATASET_INFO"}),"\nvariable whose value must be specified by the selected recipe profile"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"# Specifies the dataset to use for model training\ningest: { { INGEST_CONFIG } }\n"})}),"\n",(0,t.jsxs)(n.p,{children:["Example ",(0,t.jsx)(n.code,{children:"dev.yaml"})," profile that provides a value for ",(0,t.jsx)(n.code,{children:"DATASET_INFO"}),"\ncorresponding to a small dataset for development purposes"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:"INGEST_CONFIG:\n  location: ./data/taxi-small.parquet\n  format: parquet\n"})}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:(0,t.jsx)(n.strong,{children:"additions"})}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsxs)(n.p,{children:["If the ",(0,t.jsx)(n.code,{children:"recipe.yaml"})," configuration file does not define a particular attribute, a\nprofile may define it instead. This capability is helpful for providing values of\noptional configurations that, if unspecified, a recipe would otherwise ignore."]}),"\n",(0,t.jsxs)(n.p,{children:["Example ",(0,t.jsx)(n.code,{children:"local.yaml"})," profile that specifies a\n",(0,t.jsx)(n.a,{href:"https://www.sqlite.org/index.html",children:"sqlite"}),"-based\n",(0,t.jsx)(n.a,{href:"/tracking",children:"MLflow Tracking"})," store for local testing on a laptop"]}),"\n",(0,t.jsx)(n.pre,{children:(0,t.jsx)(n.code,{className:"language-yaml",children:'experiment:\n  tracking_uri: "sqlite:///metadata/mlflow/mlruns.db"\n  name: "sklearn_regression_experiment"\n  artifact_location: "./metadata/mlflow/mlartifacts"\n'})}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.admonition,{type:"warning",children:(0,t.jsxs)(n.p,{children:["If the ",(0,t.jsx)(n.code,{children:"recipe.yaml"})," configuration file defines an attribute that cannot be overridden\nor substituted (i.e. because its value is not specified using ",(0,t.jsx)(n.a,{href:"https://jinja.palletsprojects.com/",children:"Jinja2"}),"\ntemplating syntax), a profile must not define it. Defining such an attribute in a profile produces an error."]})})]})}function u(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(f,{...e})}):f(e)}}}]);