"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[512],{10493:(e,t,n)=>{n.d(t,{Zp:()=>s,AC:()=>l,WO:()=>c,_C:()=>p,$3:()=>m,jK:()=>d});var i=n(34164);const a={CardGroup:"CardGroup_P84T",MaxThreeColumns:"MaxThreeColumns_FO1r",AutofillColumns:"AutofillColumns_fKhQ",Card:"Card_aSCR",CardBordered:"CardBordered_glGF",CardBody:"CardBody_BhRs",TextColor:"TextColor_a8Tp",BoxRoot:"BoxRoot_Etgr",FlexWrapNowrap:"FlexWrapNowrap_f60k",FlexJustifyContentFlexStart:"FlexJustifyContentFlexStart_ZYv5",FlexDirectionRow:"FlexDirectionRow_T2qL",FlexAlignItemsCenter:"FlexAlignItemsCenter_EHVM",FlexFlex:"FlexFlex__JTE",Link:"Link_fVkl",MarginLeft4:"MarginLeft4_YQSJ",MarginTop4:"MarginTop4_jXKN",PaddingBottom4:"PaddingBottom4_O9gt",LogoCardContent:"LogoCardContent_kCQm",LogoCardImage:"LogoCardImage_JdcX",SmallLogoCardContent:"SmallLogoCardContent_LxhV",SmallLogoCardImage:"SmallLogoCardImage_tPZl",NewFeatureCardContent:"NewFeatureCardContent_Rq3d",NewFeatureCardHeading:"NewFeatureCardHeading_f6q3",NewFeatureCardHeadingSeparator:"NewFeatureCardHeadingSeparator_pSx8",NewFeatureCardTags:"NewFeatureCardTags_IFHO",NewFeatureCardWrapper:"NewFeatureCardWrapper_NQ0k",TitleCardContent:"TitleCardContent_l9MQ",TitleCardTitle:"TitleCardTitle__K8J",TitleCardSeparator:"TitleCardSeparator_IN2E",Cols1:"Cols1_Gr2U",Cols2:"Cols2_sRvc",Cols3:"Cols3_KjUS",Cols4:"Cols4_dKOj",Cols5:"Cols5_jDmj",Cols6:"Cols6_Q0OR"};var r=n(28774),o=n(74848);const l=({children:e,isSmall:t,cols:n})=>(0,o.jsx)("div",{className:(0,i.A)(a.CardGroup,t?a.AutofillColumns:n?a[`Cols${n}`]:a.MaxThreeColumns),children:e}),s=({children:e,link:t=""})=>t?(0,o.jsx)(r.A,{className:(0,i.A)(a.Link,a.Card,a.CardBordered),to:t,children:e}):(0,o.jsx)("div",{className:(0,i.A)(a.Card,a.CardBordered),children:e}),p=({headerText:e,link:t,text:n})=>(0,o.jsx)(s,{link:t,children:(0,o.jsxs)("span",{children:[(0,o.jsx)("div",{className:(0,i.A)(a.CardTitle,a.BoxRoot,a.PaddingBottom4),style:{pointerEvents:"none"},children:(0,o.jsx)("div",{className:(0,i.A)(a.BoxRoot,a.FlexFlex,a.FlexAlignItemsCenter,a.FlexDirectionRow,a.FlexJustifyContentFlexStart,a.FlexWrapNowrap),style:{marginLeft:"-4px",marginTop:"-4px"},children:(0,o.jsx)("div",{className:(0,i.A)(a.BoxRoot,a.BoxHideIfEmpty,a.MarginTop4,a.MarginLeft4),style:{pointerEvents:"auto"},children:(0,o.jsx)("span",{className:"",children:e})})})}),(0,o.jsx)("span",{className:(0,i.A)(a.TextColor,a.CardBody),children:(0,o.jsx)("p",{children:n})})]})}),c=({description:e,children:t,link:n})=>(0,o.jsx)(s,{link:n,children:(0,o.jsxs)("div",{className:a.LogoCardContent,children:[(0,o.jsx)("div",{className:a.LogoCardImage,children:t}),(0,o.jsx)("p",{className:a.TextColor,children:e})]})}),m=({children:e,link:t})=>(0,o.jsx)(s,{link:t,children:(0,o.jsx)("div",{className:a.SmallLogoCardContent,children:(0,o.jsx)("div",{className:(0,i.A)("max-height-img-container",a.SmallLogoCardImage),children:e})})}),d=({title:e,description:t,link:n=""})=>(0,o.jsx)(s,{link:n,children:(0,o.jsxs)("div",{className:a.TitleCardContent,children:[(0,o.jsx)("div",{className:(0,i.A)(a.TitleCardTitle),style:{textAlign:"left",fontWeight:"bold"},children:e}),(0,o.jsx)("hr",{className:(0,i.A)(a.TitleCardSeparator),style:{margin:"12px 0"}}),(0,o.jsx)("p",{className:(0,i.A)(a.TextColor),children:t})]})})},17527:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/prompt-evaluation-chart-8a93612e37184b8279c699fd6640013d.png"},49374:(e,t,n)=>{n.d(t,{B:()=>s});n(96540);const i=JSON.parse('{"mlflow.anthropic":"api_reference/python_api/mlflow.anthropic.html","mlflow.artifacts":"api_reference/python_api/mlflow.artifacts.html","mlflow.ag2":"api_reference/python_api/mlflow.ag2.html","mlflow.autogen":"api_reference/python_api/mlflow.autogen.html","mlflow.bedrock":"api_reference/python_api/mlflow.bedrock.html","mlflow.catboost":"api_reference/python_api/mlflow.catboost.html","mlflow.client":"api_reference/python_api/mlflow.client.html","mlflow.config":"api_reference/python_api/mlflow.config.html","mlflow.crewai":"api_reference/python_api/mlflow.crewai.html","mlflow.data":"api_reference/python_api/mlflow.data.html","mlflow.deployments":"api_reference/python_api/mlflow.deployments.html","mlflow.diviner":"api_reference/python_api/mlflow.diviner.html","mlflow.dspy":"api_reference/python_api/mlflow.dspy.html","mlflow.entities":"api_reference/python_api/mlflow.entities.html","mlflow.environment_variables":"api_reference/python_api/mlflow.environment_variables.html","mlflow.gateway":"api_reference/python_api/mlflow.gateway.html","mlflow.gemini":"api_reference/python_api/mlflow.gemini.html","mlflow.groq":"api_reference/python_api/mlflow.groq.html","mlflow.h2o":"api_reference/python_api/mlflow.h2o.html","mlflow.johnsnowlabs":"api_reference/python_api/mlflow.johnsnowlabs.html","mlflow.keras":"api_reference/python_api/mlflow.keras.html","mlflow.langchain":"api_reference/python_api/mlflow.langchain.html","mlflow.lightgbm":"api_reference/python_api/mlflow.lightgbm.html","mlflow.litellm":"api_reference/python_api/mlflow.litellm.html","mlflow.llama_index":"api_reference/python_api/mlflow.llama_index.html","mlflow.metrics":"api_reference/python_api/mlflow.metrics.html","mlflow.mistral":"api_reference/python_api/mlflow.mistral.html","mlflow.models":"api_reference/python_api/mlflow.models.html","mlflow.onnx":"api_reference/python_api/mlflow.onnx.html","mlflow.openai":"api_reference/python_api/mlflow.openai.html","mlflow.paddle":"api_reference/python_api/mlflow.paddle.html","mlflow.pmdarima":"api_reference/python_api/mlflow.pmdarima.html","mlflow.projects":"api_reference/python_api/mlflow.projects.html","mlflow.promptflow":"api_reference/python_api/mlflow.promptflow.html","mlflow.prophet":"api_reference/python_api/mlflow.prophet.html","mlflow.pyfunc":"api_reference/python_api/mlflow.pyfunc.html","mlflow.pyspark.ml":"api_reference/python_api/mlflow.pyspark.ml.html","mlflow.pytorch":"api_reference/python_api/mlflow.pytorch.html","mlflow":"api_reference/python_api/mlflow.html","mlflow.sagemaker":"api_reference/python_api/mlflow.sagemaker.html","mlflow.sentence_transformers":"api_reference/python_api/mlflow.sentence_transformers.html","mlflow.server":"api_reference/python_api/mlflow.server.html","mlflow.shap":"api_reference/python_api/mlflow.shap.html","mlflow.sklearn":"api_reference/python_api/mlflow.sklearn.html","mlflow.spacy":"api_reference/python_api/mlflow.spacy.html","mlflow.spark":"api_reference/python_api/mlflow.spark.html","mlflow.statsmodels":"api_reference/python_api/mlflow.statsmodels.html","mlflow.system_metrics":"api_reference/python_api/mlflow.system_metrics.html","mlflow.tensorflow":"api_reference/python_api/mlflow.tensorflow.html","mlflow.tracing":"api_reference/python_api/mlflow.tracing.html","mlflow.transformers":"api_reference/python_api/mlflow.transformers.html","mlflow.types":"api_reference/python_api/mlflow.types.html","mlflow.utils":"api_reference/python_api/mlflow.utils.html","mlflow.xgboost":"api_reference/python_api/mlflow.xgboost.html","mlflow.server.auth":"api_reference/auth/python-api.html"}');var a=n(86025),r=n(28774),o=n(74848);const l=e=>{const t=e.split(".");for(let n=t.length;n>0;n--){const e=t.slice(0,n).join(".");if(i[e])return e}return null};function s({fn:e,children:t}){const n=l(e);if(!n)return(0,o.jsx)(o.Fragment,{children:t});const s=(0,a.Ay)(`/${i[n]}#${e}`);return(0,o.jsx)(r.A,{to:s,target:"_blank",children:t??(0,o.jsxs)("code",{children:[e,"()"]})})}},56084:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/prompt-evaluation-result-7c106f17187fdc750439725d086c389b.png"},76599:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/create-prompt-ui-03c88144e65d28eb7847b2ae5d8dd49a.png"},80563:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>m,contentTitle:()=>c,default:()=>u,frontMatter:()=>p,metadata:()=>i,toc:()=>d});const i=JSON.parse('{"id":"prompt-version-mgmt/prompt-registry/evaluate-prompts","title":"Evaluate Prompts","description":"Learn strategies and best practices for evaluating different prompt versions to identify the most effective ones for your GenAI applications using MLflow.","source":"@site/docs/genai/prompt-version-mgmt/prompt-registry/evaluate-prompts.mdx","sourceDirName":"prompt-version-mgmt/prompt-registry","slug":"/prompt-version-mgmt/prompt-registry/evaluate-prompts","permalink":"/docs/latest/genai/prompt-version-mgmt/prompt-registry/evaluate-prompts","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Evaluate Prompts","description":"Learn strategies and best practices for evaluating different prompt versions to identify the most effective ones for your GenAI applications using MLflow."},"sidebar":"genAISidebar","previous":{"title":"Create and Edit Prompts","permalink":"/docs/latest/genai/prompt-version-mgmt/prompt-registry/create-and-edit-prompts"},"next":{"title":"Manage Prompt Lifecycles with Aliases","permalink":"/docs/latest/genai/prompt-version-mgmt/prompt-registry/manage-prompt-lifecycles-with-aliases"}}');var a=n(74848),r=n(28453),o=n(49374),l=(n(10493),n(14252),n(11470)),s=n(19365);const p={title:"Evaluate Prompts",description:"Learn strategies and best practices for evaluating different prompt versions to identify the most effective ones for your GenAI applications using MLflow."},c="Evaluate Prompts",m={},d=[{value:"Setting Up Prompt Evaluation Experiments",id:"setting-up-prompt-evaluation-experiments",level:2},{value:"Comparing Different Prompt Versions",id:"comparing-different-prompt-versions",level:2},{value:"Analyzing Evaluation Results",id:"analyzing-evaluation-results",level:2},{value:"Selecting the Most Effective Prompts",id:"selecting-the-most-effective-prompts",level:2},{value:"Key Takeaways",id:"key-takeaways",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Quickstart",id:"quickstart",level:2},{value:"1. Install Required Libraries",id:"1-install-required-libraries",level:3},{value:"1. Create a Prompt",id:"1-create-a-prompt",level:3},{value:"2. Prepare Evaluation Data",id:"2-prepare-evaluation-data",level:3},{value:"3. Define Prediction Function",id:"3-define-prediction-function",level:3},{value:"4. Run Evaluation",id:"4-run-evaluation",level:3},{value:"5. View Results",id:"5-view-results",level:3}];function h(e){const t={code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(t.header,{children:(0,a.jsx)(t.h1,{id:"evaluate-prompts",children:"Evaluate Prompts"})}),"\n",(0,a.jsx)(t.p,{children:"Creating effective prompts is an iterative process. Simply writing a prompt and deploying it is rarely sufficient. To build high-quality GenAI applications, you need to systematically evaluate different prompt variations to understand their impact on your application's output, quality, cost, and latency. This page discusses conceptual approaches and how MLflow's broader toolset (like Tracing and Evaluation) can be leveraged in the context of prompt evaluation, even if the Prompt Registry itself is primarily for storage and versioning."}),"\n",(0,a.jsx)(t.p,{children:"This page will cover:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"Setting up experiments for prompt evaluation."}),"\n",(0,a.jsx)(t.li,{children:"Strategies for comparing different prompt versions."}),"\n",(0,a.jsx)(t.li,{children:"Analyzing evaluation results to make informed decisions."}),"\n",(0,a.jsx)(t.li,{children:"Selecting the most effective prompts based on data."}),"\n"]}),"\n",(0,a.jsx)(t.h2,{id:"setting-up-prompt-evaluation-experiments",children:"Setting Up Prompt Evaluation Experiments"}),"\n",(0,a.jsx)(t.p,{children:"Effective prompt evaluation begins with a clear experimental setup. The goal is to isolate the impact of prompt changes on your application's behavior."}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Define Your Goal"}),": What are you trying to achieve by changing the prompt? (e.g., improve factual accuracy, reduce verbosity, enhance a specific skill, lower cost by using a cheaper model with a better prompt)."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Identify Key Metrics"}),": How will you measure success? Metrics can be:","\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Quality Metrics"}),": Relevance, coherence, helpfulness, accuracy, adherence to style guides. These can be assessed by human reviewers or automated LLM-as-a-judge metrics."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Performance Metrics"}),": Latency of the LLM response, token usage (cost)."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Task-Specific Metrics"}),": e.g., code generation correctness, summarization abstractiveness, question-answering precision."]}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Prepare an Evaluation Dataset"}),": You need a consistent set of inputs to test your prompt variations against. This dataset should be representative of the types of queries your application will handle. This could be curated from:","\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"Real user queries (collected via MLflow Tracing)."}),"\n",(0,a.jsx)(t.li,{children:"Manually crafted examples covering edge cases."}),"\n",(0,a.jsx)(t.li,{children:"Synthetic data generated to test specific behaviors."}),"\n",(0,a.jsx)(t.li,{children:(0,a.jsx)(t.em,{children:'Refer to the "Build an Evaluation Dataset" section in "Evaluate & Monitor" for more details.'})}),"\n"]}),"\n"]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Select Prompt Variations"}),": Choose the different prompt versions from the MLflow Prompt Registry that you want to compare. These could be different iterations of the same base prompt or entirely different approaches to the same task."]}),"\n"]}),"\n",(0,a.jsx)(t.h2,{id:"comparing-different-prompt-versions",children:"Comparing Different Prompt Versions"}),"\n",(0,a.jsx)(t.p,{children:"Once you have your setup, you can run your application with each selected prompt version against your evaluation dataset."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.strong,{children:"Workflow using MLflow tools:"})}),"\n",(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Application Instrumentation"}),": Ensure your application is instrumented with MLflow Tracing. This will capture detailed information about each execution, including the inputs, outputs, any intermediate steps, latency, and token counts."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Iterate and Log"}),": For each prompt version you want to evaluate:\na. Modify your application code to load the specific prompt version from the registry (e.g., ",(0,a.jsx)(t.code,{children:'mlflow.genai.load_prompt(uri="prompts:/my-prompt/1")'}),", then ",(0,a.jsx)(t.code,{children:'mlflow.genai.load_prompt(uri="prompts:/my-prompt/2")'}),").\nb. Run your application against each item in your evaluation dataset.\nc. The traces generated will capture the outputs produced using that specific prompt version."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsxs)(t.strong,{children:["Leverage ",(0,a.jsx)(t.code,{children:"mlflow.genai.evaluate()"})]}),": MLflow's ",(0,a.jsx)(t.code,{children:"mlflow.genai.evaluate()"})," API is a powerful tool here. You can configure it to:","\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:'Take your application (which internally loads a specific prompt version) as the "model" input.'}),"\n",(0,a.jsx)(t.li,{children:"Run it against your evaluation dataset."}),"\n",(0,a.jsx)(t.li,{children:"Apply predefined or custom metrics (including LLM judges for quality assessment and functions to parse cost/latency from traces)."}),"\n",(0,a.jsx)(t.li,{children:"Log all results, linking them back to the run, which can be associated with the prompt version being tested."}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,a.jsx)(t.h2,{id:"analyzing-evaluation-results",children:"Analyzing Evaluation Results"}),"\n",(0,a.jsx)(t.p,{children:"After running your evaluations, MLflow provides tools to analyze the results:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"MLflow UI"}),": Compare runs corresponding to different prompt versions. View logged metrics, parameters (like the prompt URI or version number you logged), and associated traces."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Traces"}),": For each evaluation, dive into the traces to see the exact inputs, intermediate steps (if any), and final outputs generated by your application with a specific prompt. This is crucial for qualitative analysis and understanding ",(0,a.jsx)(t.em,{children:"why"})," a prompt performed a certain way."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Metrics Comparison"}),": Systematically compare the quantitative metrics (quality scores, latency, cost) across different prompt versions."]}),"\n"]}),"\n",(0,a.jsx)(t.h2,{id:"selecting-the-most-effective-prompts",children:"Selecting the Most Effective Prompts"}),"\n",(0,a.jsxs)(t.p,{children:["Based on your analysis, you can make data-driven decisions about which prompt versions are most effective for different scenarios or which ones to promote for further testing or deployment (e.g., by updating an alias like ",(0,a.jsx)(t.code,{children:"staging"})," or ",(0,a.jsx)(t.code,{children:"production"})," to point to the winning version)."]}),"\n",(0,a.jsx)(t.p,{children:"Consider:"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Trade-offs"}),": Often, there are trade-offs. A prompt might produce higher quality responses but at a higher latency or cost. Your selection should align with your overall application objectives."]}),"\n",(0,a.jsxs)(t.li,{children:[(0,a.jsx)(t.strong,{children:"Iterative Refinement"}),": Evaluation results might highlight areas for further prompt improvement. Use these insights to create new prompt versions and repeat the evaluation cycle."]}),"\n"]}),"\n",(0,a.jsx)(t.h2,{id:"key-takeaways",children:"Key Takeaways"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"Systematic prompt evaluation is key to improving GenAI application quality."}),"\n",(0,a.jsx)(t.li,{children:"Define clear goals, metrics, and a representative evaluation dataset for your experiments."}),"\n",(0,a.jsxs)(t.li,{children:["Leverage MLflow Tracing to capture detailed execution data and ",(0,a.jsx)(t.code,{children:"mlflow.genai.evaluate()"})," to run evaluations and compute metrics across different prompt versions."]}),"\n",(0,a.jsx)(t.li,{children:"Analyze both quantitative metrics and qualitative trace data to understand prompt performance."}),"\n",(0,a.jsx)(t.li,{children:"Make data-driven decisions for selecting and refining prompts, considering trade-offs between quality, cost, and latency."}),"\n"]}),"\n",(0,a.jsx)(t.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,a.jsxs)(t.ul,{children:["\n",(0,a.jsx)(t.li,{children:"Understanding of basic evaluation metrics and principles."}),"\n",(0,a.jsx)(t.li,{children:"Access to an evaluation dataset relevant to your application."}),"\n",(0,a.jsx)(t.li,{children:"Familiarity with MLflow Tracing and MLflow Evaluation concepts."}),"\n",(0,a.jsx)(t.li,{children:"Prompts registered in the MLflow Prompt Registry that you wish to evaluate."}),"\n"]}),"\n",(0,a.jsx)(t.p,{children:"While the Prompt Registry itself is the system of record for your prompt templates, its true power in enhancing quality comes when its versioned prompts are used within a robust evaluation framework enabled by other MLflow components like Tracing and Evaluate."}),"\n",(0,a.jsx)(t.h2,{id:"quickstart",children:"Quickstart"}),"\n",(0,a.jsx)(t.h3,{id:"1-install-required-libraries",children:"1. Install Required Libraries"}),"\n",(0,a.jsx)(t.p,{children:"First install MLflow and OpenAI SDK. If you use different LLM providers, install the corresponding SDK instead."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-bash",children:"pip install mlflow>=2.21.0 openai -qU\n"})}),"\n",(0,a.jsx)(t.p,{children:"Also set OpenAI API key (or any other LLM providers e.g. Anthropic)."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'import os\nfrom getpass import getpass\n\nos.environ["OPENAI_API_KEY"] = getpass("Enter your OpenAI API key: ")\n'})}),"\n",(0,a.jsx)(t.h3,{id:"1-create-a-prompt",children:"1. Create a Prompt"}),"\n",(0,a.jsxs)(l.A,{children:[(0,a.jsx)(s.A,{value:"ui",label:"UI",default:!0,children:(0,a.jsxs)("div",{class:"flex-column",children:[(0,a.jsx)("div",{style:{width:"70%",margin:"20px"},children:(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Create Prompt UI",src:n(76599).A+"",width:"1239",height:"660"})})}),(0,a.jsxs)(t.ol,{children:["\n",(0,a.jsxs)(t.li,{children:["Run ",(0,a.jsx)(t.code,{children:"mlflow ui"})," in your terminal to start the MLflow UI."]}),"\n",(0,a.jsxs)(t.li,{children:["Navigate to the ",(0,a.jsx)(t.strong,{children:"Prompts"})," tab in the MLflow UI."]}),"\n",(0,a.jsxs)(t.li,{children:["Click on the ",(0,a.jsx)(t.strong,{children:"Create Prompt"})," button."]}),"\n",(0,a.jsx)(t.li,{children:"Fill in the prompt details such as name, prompt template text, and commit message (optional)."}),"\n",(0,a.jsxs)(t.li,{children:["Click ",(0,a.jsx)(t.strong,{children:"Create"})," to register the prompt."]}),"\n"]})]})}),(0,a.jsx)(s.A,{value:"python",label:"Python",default:!0,children:(0,a.jsxs)("div",{class:"flex-column",children:[(0,a.jsxs)(t.p,{children:["To create a new prompt using the Python API, use ",(0,a.jsx)(o.B,{fn:"mlflow.genai.register_prompt"})," API:"]}),(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'import mlflow\n\n# Use double curly braces for variables in the template\ninitial_template = """\\\nSummarize content you are provided with in {{ num_sentences }} sentences.\n\nSentences: {{ sentences }}\n"""\n\n# Register a new prompt\nprompt = mlflow.genai.register_prompt(\n    name="summarization-prompt",\n    template=initial_template,\n    # Optional: Provide a commit message to describe the changes\n    commit_message="Initial commit",\n)\n\n# The prompt object contains information about the registered prompt\nprint(f"Created prompt \'{prompt.name}\' (version {prompt.version})")\n'})})]})})]}),"\n",(0,a.jsx)(t.h3,{id:"2-prepare-evaluation-data",children:"2. Prepare Evaluation Data"}),"\n",(0,a.jsx)(t.p,{children:"Below, we create a small summarization dataset for demonstration purposes."}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'import pandas as pd\n\neval_data = pd.DataFrame(\n    {\n        "inputs": [\n            {\n                "data": "Artificial intelligence has transformed how businesses operate in the 21st century. Companies are leveraging AI for everything from customer service to supply chain optimization. The technology enables automation of routine tasks, freeing human workers for more creative endeavors. However, concerns about job displacement and ethical implications remain significant. Many experts argue that AI will ultimately create more jobs than it eliminates, though the transition may be challenging."\n            },\n            {\n                "data": "Climate change continues to affect ecosystems worldwide at an alarming rate. Rising global temperatures have led to more frequent extreme weather events including hurricanes, floods, and wildfires. Polar ice caps are melting faster than predicted, contributing to sea level rise that threatens coastal communities. Scientists warn that without immediate and dramatic reductions in greenhouse gas emissions, many of these changes may become irreversible. International cooperation remains essential but politically challenging."\n            },\n            {\n                "data": "The human genome project was completed in 2003 after 13 years of international collaborative research. It successfully mapped all of the genes of the human genome, approximately 20,000-25,000 genes in total. The project cost nearly $3 billion but has enabled countless medical advances and spawned new fields like pharmacogenomics. The knowledge gained has dramatically improved our understanding of genetic diseases and opened pathways to personalized medicine. Today, a complete human genome can be sequenced in under a day for about $1,000."\n            },\n            {\n                "data": "Remote work adoption accelerated dramatically during the COVID-19 pandemic. Organizations that had previously resisted flexible work arrangements were forced to implement digital collaboration tools and virtual workflows. Many companies reported surprising productivity gains, though concerns about company culture and collaboration persisted. After the pandemic, a hybrid model emerged as the preferred approach for many businesses, combining in-office and remote work. This shift has profound implications for urban planning, commercial real estate, and work-life balance."\n            },\n            {\n                "data": "Quantum computing represents a fundamental shift in computational capability. Unlike classical computers that use bits as either 0 or 1, quantum computers use quantum bits or qubits that can exist in multiple states simultaneously. This property, known as superposition, theoretically allows quantum computers to solve certain problems exponentially faster than classical computers. Major technology companies and governments are investing billions in quantum research. Fields like cryptography, material science, and drug discovery are expected to be revolutionized once quantum computers reach practical scale."\n            },\n        ],\n        "expectations": [\n            {\n                "expected_response": "AI has revolutionized business operations through automation and optimization, though ethical concerns about job displacement persist alongside predictions that AI will ultimately create more employment opportunities than it eliminates."\n            },\n            {\n                "expected_response": "Climate change is causing accelerating environmental damage through extreme weather events and melting ice caps, with scientists warning that without immediate reduction in greenhouse gas emissions, many changes may become irreversible."\n            },\n            {\n                "expected_response": "The Human Genome Project, completed in 2003, mapped approximately 20,000-25,000 human genes at a cost of $3 billion, enabling medical advances, improving understanding of genetic diseases, and establishing the foundation for personalized medicine."\n            },\n            {\n                "expected_response": "The COVID-19 pandemic forced widespread adoption of remote work, revealing unexpected productivity benefits despite collaboration challenges, and resulting in a hybrid work model that impacts urban planning, real estate, and work-life balance."\n            },\n            {\n                "expected_response": "Quantum computing uses qubits existing in multiple simultaneous states to potentially solve certain problems exponentially faster than classical computers, with major investment from tech companies and governments anticipating revolutionary applications in cryptography, materials science, and pharmaceutical research."\n            },\n        ],\n    }\n)\n'})}),"\n",(0,a.jsx)(t.h3,{id:"3-define-prediction-function",children:"3. Define Prediction Function"}),"\n",(0,a.jsx)(t.p,{children:"Define a function that takes a DataFrame of inputs and returns a list of predictions."}),"\n",(0,a.jsxs)(t.p,{children:["MLflow will pass the input columns (",(0,a.jsx)(t.code,{children:"inputs"})," only in this example) to the function. The output string will be compared with the ",(0,a.jsx)(t.code,{children:"targets"})," column to evaluate the model."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'import mlflow\nimport openai\n\n\ndef predict(data: str) -> str:\n    prompt = mlflow.genai.load_prompt("prompts:/summarization-prompt/1")\n    content = prompt.format(sentences=data, num_sentences=1)\n    completion = openai.chat.completions.create(\n        model="gpt-4o-mini",\n        messages=[{"role": "user", "content": content}],\n        temperature=0.1,\n    )\n    return completion.choices[0].message.content\n'})}),"\n",(0,a.jsx)(t.h3,{id:"4-run-evaluation",children:"4. Run Evaluation"}),"\n",(0,a.jsxs)(t.p,{children:["Run the ",(0,a.jsx)(o.B,{fn:"mlflow.genai.evaluate"})," API to evaluate the model with the prepared data and prompt. In this example, we will use the following two built-in metrics."]}),"\n",(0,a.jsx)(t.pre,{children:(0,a.jsx)(t.code,{className:"language-python",children:'from mlflow.genai.scorers import Correctness, RelevanceToQuery\n\nwith mlflow.start_run(run_name="prompt-evaluation"):\n    mlflow.log_param("model", "gpt-4o-mini")\n    mlflow.log_param("temperature", 0.1)\n\n    results = mlflow.genai.evaluate(\n        predict_fn=predict,\n        data=eval_data,\n        scorers=[\n            Correctness(),\n            RelevanceToQuery(),\n        ],\n    )\n'})}),"\n",(0,a.jsx)(t.h3,{id:"5-view-results",children:"5. View Results"}),"\n",(0,a.jsxs)(t.p,{children:["You can view the evaluation results in the MLflow UI. Navigate to the ",(0,a.jsx)(t.strong,{children:"Experiments"})," tab and click on the evaluation run (",(0,a.jsx)(t.code,{children:"prompt-evaluation"})," in this example) to view the evaluation result."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Evaluation Results",src:n(56084).A+"",width:"1610",height:"876"})}),"\n",(0,a.jsx)(t.p,{children:"If you have multiple Evaluation Runs, you can compare the metrics across runs in the chart view."}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Evaluation Chart",src:n(17527).A+"",width:"1552",height:"938"})}),"\n",(0,a.jsxs)(t.p,{children:["Moreover, you can navigate to the ",(0,a.jsx)(t.strong,{children:"Traces"})," tab in the evaluation run page to show all input and output responses from the LLM during evaluation, to understand how the model responds to different prompts."]}),"\n",(0,a.jsx)(t.p,{children:(0,a.jsx)(t.img,{alt:"Evaluation Chart",src:n(91236).A+"",width:"1747",height:"663"})})]})}function u(e={}){const{wrapper:t}={...(0,r.R)(),...e.components};return t?(0,a.jsx)(t,{...e,children:(0,a.jsx)(h,{...e})}):h(e)}},91236:(e,t,n)=>{n.d(t,{A:()=>i});const i=n.p+"assets/images/prompt-evaluation-trace-13f9389ee309540222047abd386aef79.png"}}]);