"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([["4513"],{35525(e,l,n){n.r(l),n.d(l,{metadata:()=>r,default:()=>u,frontMatter:()=>h,contentTitle:()=>w,toc:()=>g,assets:()=>_});var r=JSON.parse('{"id":"deep-learning/keras/index","title":"MLflow Keras 3.0 Integration","description":"Introduction","source":"@site/docs/classic-ml/deep-learning/keras/index.mdx","sourceDirName":"deep-learning/keras","slug":"/deep-learning/keras/","permalink":"/mlflow-website/docs/latest/ml/deep-learning/keras/","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":2,"frontMatter":{"sidebar_position":2,"sidebar_label":"Keras"},"sidebar":"classicMLSidebar","previous":{"title":"TensorFlow","permalink":"/mlflow-website/docs/latest/ml/deep-learning/tensorflow/"},"next":{"title":"MLflow Transformers Flavor","permalink":"/mlflow-website/docs/latest/ml/deep-learning/transformers/"}}'),o=n(74848),a=n(28453),t=n(33508),i=n(10440),s=n(77541),m=n(46858),p=n(61878),c=n(17133),f=n(60665),d=n(54725);let h={sidebar_position:2,sidebar_label:"Keras"},w="MLflow Keras 3.0 Integration",_={},g=[{value:"Introduction",id:"introduction",level:2},{value:"Why MLflow + Keras?",id:"why-mlflow--keras",level:2},{value:"Autologging",id:"autologging",level:2},{value:"Manual Logging with Keras Callback",id:"manual-logging-with-keras-callback",level:2},{value:"Model Logging",id:"model-logging",level:2},{value:"Model Registry Integration",id:"model-registry-integration",level:2},{value:"Learn More",id:"learn-more",level:2}];function y(e){let l={code:"code",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",...(0,a.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(l.header,{children:(0,o.jsx)(l.h1,{id:"mlflow-keras-30-integration",children:"MLflow Keras 3.0 Integration"})}),"\n",(0,o.jsx)(l.h2,{id:"introduction",children:"Introduction"}),"\n",(0,o.jsxs)(l.p,{children:[(0,o.jsx)(l.strong,{children:"Keras 3.0"})," is a high-level neural networks API that runs on TensorFlow, JAX, and PyTorch backends. It provides a user-friendly interface for building and training deep learning models with the flexibility to switch backends without changing your code."]}),"\n",(0,o.jsx)(l.p,{children:"MLflow's Keras integration provides experiment tracking, model versioning, and deployment capabilities for deep learning workflows."}),"\n",(0,o.jsx)(l.h2,{id:"why-mlflow--keras",children:"Why MLflow + Keras?"}),"\n",(0,o.jsx)(t.A,{features:[{icon:m.A,title:"Autologging",description:"Enable comprehensive experiment tracking with one line: mlflow.tensorflow.autolog() automatically logs metrics, parameters, and models."},{icon:p.A,title:"Experiment Tracking",description:"Track training metrics, hyperparameters, model architectures, and artifacts across all Keras experiments."},{icon:c.A,title:"Model Registry",description:"Version, stage, and deploy Keras models with MLflow's model registry and serving infrastructure."},{icon:f.A,title:"Multi-Backend Support",description:"Track experiments consistently across TensorFlow, JAX, and PyTorch backends."}]}),"\n",(0,o.jsx)(l.h2,{id:"autologging",children:"Autologging"}),"\n",(0,o.jsx)(l.p,{children:"Enable comprehensive autologging with a single line:"}),"\n",(0,o.jsx)(l.pre,{children:(0,o.jsx)(l.code,{className:"language-python",children:'import mlflow\nimport numpy as np\nfrom tensorflow import keras\n\n# Enable autologging\nmlflow.tensorflow.autolog()\n\n# Prepare sample data\nX_train = np.random.rand(1000, 20)\ny_train = np.random.randint(0, 2, 1000)\n\n# Define model\nmodel = keras.Sequential(\n    [\n        keras.layers.Dense(64, activation="relu", input_shape=(20,)),\n        keras.layers.Dense(32, activation="relu"),\n        keras.layers.Dense(1, activation="sigmoid"),\n    ]\n)\n\nmodel.compile(optimizer="adam", loss="binary_crossentropy", metrics=["accuracy"])\n\n# Training with automatic logging\nwith mlflow.start_run():\n    model.fit(X_train, y_train, epochs=10, batch_size=32, validation_split=0.2)\n'})}),"\n",(0,o.jsx)(l.p,{children:"Autologging captures training metrics, model parameters, optimizer configuration, and model artifacts automatically."}),"\n",(0,o.jsx)(l.p,{children:"Configure autologging behavior:"}),"\n",(0,o.jsx)(l.pre,{children:(0,o.jsx)(l.code,{className:"language-python",children:"mlflow.tensorflow.autolog(\n    log_models=True,\n    log_input_examples=True,\n    log_model_signatures=True,\n    log_every_n_steps=1,\n)\n"})}),"\n",(0,o.jsx)(l.h2,{id:"manual-logging-with-keras-callback",children:"Manual Logging with Keras Callback"}),"\n",(0,o.jsxs)(l.p,{children:["For more control, use ",(0,o.jsx)(d.B,{fn:"mlflow.tensorflow.MlflowCallback"}),":"]}),"\n",(0,o.jsx)(l.pre,{children:(0,o.jsx)(l.code,{className:"language-python",children:'import mlflow\nimport numpy as np\nfrom tensorflow import keras\n\n# Prepare sample data\nX_train = np.random.rand(100, 20)\ny_train = np.random.randint(0, 2, 100)\n\n# Define and compile model\nmodel = keras.Sequential(\n    [\n        keras.layers.Dense(64, activation="relu", input_shape=(20,)),\n        keras.layers.Dense(1, activation="sigmoid"),\n    ]\n)\n\nmodel.compile(optimizer="adam", loss="binary_crossentropy", metrics=["accuracy"])\n\n# Create an MLflow run and add the callback\nwith mlflow.start_run() as run:\n    model.fit(\n        X_train,\n        y_train,\n        epochs=10,\n        batch_size=32,\n        validation_split=0.2,\n        callbacks=[mlflow.tensorflow.MlflowCallback(run)],\n    )\n'})}),"\n",(0,o.jsx)(l.h2,{id:"model-logging",children:"Model Logging"}),"\n",(0,o.jsxs)(l.p,{children:["Save Keras models with ",(0,o.jsx)(d.B,{fn:"mlflow.tensorflow.log_model"}),":"]}),"\n",(0,o.jsx)(l.pre,{children:(0,o.jsx)(l.code,{className:"language-python",children:'import mlflow\nfrom tensorflow import keras\n\n# Define model\nmodel = keras.Sequential(\n    [\n        keras.layers.Dense(64, activation="relu", input_shape=(20,)),\n        keras.layers.Dense(1, activation="sigmoid"),\n    ]\n)\n\n# Train model (code omitted for brevity)\n\n# Log the model to MLflow\nmodel_info = mlflow.tensorflow.log_model(model, name="model")\n\n# Later, load the model for inference\nloaded_model = mlflow.tensorflow.load_model(model_info.model_uri)\npredictions = loaded_model.predict(X_test)\n'})}),"\n",(0,o.jsx)(l.h2,{id:"model-registry-integration",children:"Model Registry Integration"}),"\n",(0,o.jsx)(l.p,{children:"Register Keras models for version control and deployment:"}),"\n",(0,o.jsx)(l.pre,{children:(0,o.jsx)(l.code,{className:"language-python",children:'import mlflow\nfrom tensorflow import keras\nfrom mlflow import MlflowClient\n\nwith mlflow.start_run():\n    # Create a simple model for demonstration\n    model = keras.Sequential(\n        [\n            keras.layers.Conv2D(32, 3, activation="relu", input_shape=(28, 28, 1)),\n            keras.layers.MaxPooling2D(2),\n            keras.layers.Flatten(),\n            keras.layers.Dense(10, activation="softmax"),\n        ]\n    )\n\n    # Log model to registry\n    model_info = mlflow.tensorflow.log_model(\n        model, name="keras_model", registered_model_name="ImageClassifier"\n    )\n\n    # Tag for tracking\n    mlflow.set_tags({"model_type": "cnn", "dataset": "mnist", "framework": "keras"})\n\n# Set alias for production deployment\nclient = MlflowClient()\nclient.set_registered_model_alias(\n    name="ImageClassifier",\n    alias="champion",\n    version=model_info.registered_model_version,\n)\n'})}),"\n",(0,o.jsx)(l.h2,{id:"learn-more",children:"Learn More"}),"\n",(0,o.jsxs)(i.A,{children:[(0,o.jsx)(s.A,{icon:c.A,title:"Model Registry",description:"Version and manage Keras models",href:"/ml/model-registry"}),(0,o.jsx)(s.A,{icon:p.A,title:"MLflow Tracking",description:"Track experiments, parameters, and metrics",href:"/ml/tracking"})]})]})}function u(e={}){let{wrapper:l}={...(0,a.R)(),...e.components};return l?(0,o.jsx)(l,{...e,children:(0,o.jsx)(y,{...e})}):y(e)}},75689(e,l,n){n.d(l,{A:()=>s});var r=n(96540);let o=e=>{let l=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,l,n)=>n?n.toUpperCase():l.toLowerCase());return l.charAt(0).toUpperCase()+l.slice(1)},a=(...e)=>e.filter((e,l,n)=>!!e&&""!==e.trim()&&n.indexOf(e)===l).join(" ").trim();var t={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,r.forwardRef)(({color:e="currentColor",size:l=24,strokeWidth:n=2,absoluteStrokeWidth:o,className:i="",children:s,iconNode:m,...p},c)=>(0,r.createElement)("svg",{ref:c,...t,width:l,height:l,stroke:e,strokeWidth:o?24*Number(n)/Number(l):n,className:a("lucide",i),...!s&&!(e=>{for(let l in e)if(l.startsWith("aria-")||"role"===l||"title"===l)return!0})(p)&&{"aria-hidden":"true"},...p},[...m.map(([e,l])=>(0,r.createElement)(e,l)),...Array.isArray(s)?s:[s]])),s=(e,l)=>{let n=(0,r.forwardRef)(({className:n,...t},s)=>(0,r.createElement)(i,{ref:s,iconNode:l,className:a(`lucide-${o(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,n),...t}));return n.displayName=o(e),n}},60665(e,l,n){n.d(l,{A:()=>r});let r=(0,n(75689).A)("book-open",[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}]])},61878(e,l,n){n.d(l,{A:()=>r});let r=(0,n(75689).A)("git-branch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]])},17133(e,l,n){n.d(l,{A:()=>r});let r=(0,n(75689).A)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},46858(e,l,n){n.d(l,{A:()=>r});let r=(0,n(75689).A)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},54725(e,l,n){n.d(l,{B:()=>t});var r=n(74848);n(96540);var o=JSON.parse('{"mlflow.ag2":"api_reference/python_api/mlflow.ag2.html","mlflow.agno":"api_reference/python_api/mlflow.agno.html","mlflow.anthropic":"api_reference/python_api/mlflow.anthropic.html","mlflow.artifacts":"api_reference/python_api/mlflow.artifacts.html","mlflow.autogen":"api_reference/python_api/mlflow.autogen.html","mlflow.bedrock":"api_reference/python_api/mlflow.bedrock.html","mlflow.catboost":"api_reference/python_api/mlflow.catboost.html","mlflow.client":"api_reference/python_api/mlflow.client.html","mlflow.config":"api_reference/python_api/mlflow.config.html","mlflow.crewai":"api_reference/python_api/mlflow.crewai.html","mlflow.data":"api_reference/python_api/mlflow.data.html","mlflow.deployments":"api_reference/python_api/mlflow.deployments.html","mlflow.diviner":"api_reference/python_api/mlflow.diviner.html","mlflow.dspy":"api_reference/python_api/mlflow.dspy.html","mlflow.entities":"api_reference/python_api/mlflow.entities.html","mlflow.environment_variables":"api_reference/python_api/mlflow.environment_variables.html","mlflow.gateway":"api_reference/python_api/mlflow.gateway.html","mlflow.gemini":"api_reference/python_api/mlflow.gemini.html","mlflow.genai":"api_reference/python_api/mlflow.genai.html","mlflow.groq":"api_reference/python_api/mlflow.groq.html","mlflow.h2o":"api_reference/python_api/mlflow.h2o.html","mlflow.johnsnowlabs":"api_reference/python_api/mlflow.johnsnowlabs.html","mlflow.keras":"api_reference/python_api/mlflow.keras.html","mlflow.langchain":"api_reference/python_api/mlflow.langchain.html","mlflow.lightgbm":"api_reference/python_api/mlflow.lightgbm.html","mlflow.litellm":"api_reference/python_api/mlflow.litellm.html","mlflow.llama_index":"api_reference/python_api/mlflow.llama_index.html","mlflow.metrics":"api_reference/python_api/mlflow.metrics.html","mlflow.mistral":"api_reference/python_api/mlflow.mistral.html","mlflow.models":"api_reference/python_api/mlflow.models.html","mlflow.onnx":"api_reference/python_api/mlflow.onnx.html","mlflow.openai":"api_reference/python_api/mlflow.openai.html","mlflow.paddle":"api_reference/python_api/mlflow.paddle.html","mlflow.pmdarima":"api_reference/python_api/mlflow.pmdarima.html","mlflow.projects":"api_reference/python_api/mlflow.projects.html","mlflow.prophet":"api_reference/python_api/mlflow.prophet.html","mlflow.pydantic_ai":"api_reference/python_api/mlflow.pydantic_ai.html","mlflow.pyfunc":"api_reference/python_api/mlflow.pyfunc.html","mlflow.pyspark.ml":"api_reference/python_api/mlflow.pyspark.ml.html","mlflow.pytorch":"api_reference/python_api/mlflow.pytorch.html","mlflow":"api_reference/python_api/mlflow.html","mlflow.sagemaker":"api_reference/python_api/mlflow.sagemaker.html","mlflow.sentence_transformers":"api_reference/python_api/mlflow.sentence_transformers.html","mlflow.server":"api_reference/python_api/mlflow.server.html","mlflow.shap":"api_reference/python_api/mlflow.shap.html","mlflow.sklearn":"api_reference/python_api/mlflow.sklearn.html","mlflow.smolagents":"api_reference/python_api/mlflow.smolagents.html","mlflow.spacy":"api_reference/python_api/mlflow.spacy.html","mlflow.spark":"api_reference/python_api/mlflow.spark.html","mlflow.statsmodels":"api_reference/python_api/mlflow.statsmodels.html","mlflow.system_metrics":"api_reference/python_api/mlflow.system_metrics.html","mlflow.tensorflow":"api_reference/python_api/mlflow.tensorflow.html","mlflow.tracing":"api_reference/python_api/mlflow.tracing.html","mlflow.transformers":"api_reference/python_api/mlflow.transformers.html","mlflow.types":"api_reference/python_api/mlflow.types.html","mlflow.utils":"api_reference/python_api/mlflow.utils.html","mlflow.webhooks":"api_reference/python_api/mlflow.webhooks.html","mlflow.xgboost":"api_reference/python_api/mlflow.xgboost.html","mlflow.server.auth":"api_reference/auth/python-api.html","mlflow.server.cli":"api_reference/cli.html","mlflow.r":"api_reference/R-api.html","mlflow.java":"api_reference/java_api/index.html","mlflow.python":"api_reference/python_api/index.html","mlflow.rest":"api_reference/rest-api.html","mlflow.typescript":"api_reference/typescript_api/index.html","mlflow.llms.deployments.api":"api_reference/llms/deployments/api.html"}'),a=n(66497);function t({fn:e,children:l,hash:n}){let t=(e=>{let l=e.split(".");for(let e=l.length;e>0;e--){let n=l.slice(0,e).join(".");if(o[n])return n}return null})(e);if(!t)return(0,r.jsx)(r.Fragment,{children:l});let i=(0,a.default)(`/${o[t]}#${n??e}`);return(0,r.jsx)("a",{href:i,target:"_blank",children:l??(0,r.jsxs)("code",{children:[e,"()"]})})}},33508(e,l,n){n.d(l,{A:()=>o});var r=n(74848);n(96540);function o({features:e,col:l=2}){return(0,r.jsx)("div",{className:"featureHighlights_Ardf",style:{gridTemplateColumns:`repeat(${l}, 1fr)`},children:e.map((e,l)=>(0,r.jsxs)("div",{className:"highlightItem_XPnN",children:[e.icon&&(0,r.jsx)("div",{className:"highlightIcon_SUR8",children:(0,r.jsx)(e.icon,{size:24})}),(0,r.jsxs)("div",{className:"highlightContent_d0XP",children:[(0,r.jsx)("h4",{children:e.title}),(0,r.jsx)("p",{children:e.description})]})]},l))})}},77541(e,l,n){n.d(l,{A:()=>m});var r=n(74848);n(96540);var o=n(95310),a=n(34164);let t="tileImage_O4So";var i=n(66497),s=n(92802);function m({icon:e,image:l,imageDark:n,imageWidth:m,imageHeight:p,iconSize:c=32,containerHeight:f,title:d,description:h,href:w,linkText:_="Learn more \u2192",className:g}){if(!e&&!l)throw Error("TileCard requires either an icon or image prop");let y=f?{height:`${f}px`}:{},u={};return m&&(u.width=`${m}px`),p&&(u.height=`${p}px`),(0,r.jsxs)(o.A,{href:w,className:(0,a.A)("tileCard_NHsj",g),children:[(0,r.jsx)("div",{className:"tileIcon_pyoR",style:y,children:e?(0,r.jsx)(e,{size:c}):n?(0,r.jsx)(s.A,{sources:{light:(0,i.default)(l),dark:(0,i.default)(n)},alt:d,className:t,style:u}):(0,r.jsx)("img",{src:(0,i.default)(l),alt:d,className:t,style:u})}),(0,r.jsx)("h3",{children:d}),(0,r.jsx)("p",{children:h}),(0,r.jsx)("div",{className:"tileLink_iUbu",children:_})]})}},10440(e,l,n){n.d(l,{A:()=>a});var r=n(74848);n(96540);var o=n(34164);function a({children:e,className:l}){return(0,r.jsx)("div",{className:(0,o.A)("tilesGrid_hB9N",l),children:e})}},28453(e,l,n){n.d(l,{R:()=>t,x:()=>i});var r=n(96540);let o={},a=r.createContext(o);function t(e){let l=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(l):{...l,...e}},[l,e])}function i(e){let l;return l=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:t(e.components),r.createElement(a.Provider,{value:l},e.children)}}}]);