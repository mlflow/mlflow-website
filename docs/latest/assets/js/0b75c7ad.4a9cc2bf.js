"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([["8685"],{84631(e,t,n){n.r(t),n.d(t,{metadata:()=>r,default:()=>w,frontMatter:()=>f,contentTitle:()=>_,toc:()=>x,assets:()=>y});var r=JSON.parse('{"id":"traditional-ml/sklearn/index","title":"MLflow Scikit-learn Integration","description":"Introduction","source":"@site/docs/classic-ml/traditional-ml/sklearn/index.mdx","sourceDirName":"traditional-ml/sklearn","slug":"/traditional-ml/sklearn/","permalink":"/mlflow-website/docs/latest/ml/traditional-ml/sklearn/","draft":false,"unlisted":false,"tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_position":1,"sidebar_label":"Scikit-learn"},"sidebar":"classicMLSidebar","previous":{"title":"Notebooks","permalink":"/mlflow-website/docs/latest/ml/traditional-ml/tutorials/serving-multiple-models-with-pyfunc/notebooks/MME_Tutorial"},"next":{"title":"XGBoost","permalink":"/mlflow-website/docs/latest/ml/traditional-ml/xgboost/"}}'),i=n(74848),a=n(28453),s=n(33508),l=n(10440),o=n(77541),d=n(46858),c=n(17133),m=n(76316),h=n(61878),p=n(51004),u=n(99653),g=n(22864);let f={sidebar_position:1,sidebar_label:"Scikit-learn"},_="MLflow Scikit-learn Integration",y={},x=[{value:"Introduction",id:"introduction",level:2},{value:"Why MLflow + Scikit-learn?",id:"why-mlflow--scikit-learn",level:2},{value:"Getting Started",id:"getting-started",level:2},{value:"Autologging",id:"autologging",level:2},{value:"What Gets Logged",id:"what-gets-logged",level:3},{value:"Hyperparameter Tuning",id:"hyperparameter-tuning",level:2},{value:"Grid Search",id:"grid-search",level:3},{value:"Optuna Integration",id:"optuna-integration",level:3},{value:"Learn More",id:"learn-more",level:2}];function k(e){let t={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,a.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(t.header,{children:(0,i.jsx)(t.h1,{id:"mlflow-scikit-learn-integration",children:"MLflow Scikit-learn Integration"})}),"\n",(0,i.jsx)(t.h2,{id:"introduction",children:"Introduction"}),"\n",(0,i.jsxs)(t.p,{children:["Scikit-learn is a comprehensive machine learning library for Python, providing tools for classification, regression, clustering, and preprocessing. Built on NumPy, SciPy, and matplotlib, scikit-learn offers a consistent API across all estimators with unified ",(0,i.jsx)(t.code,{children:"fit()"}),", ",(0,i.jsx)(t.code,{children:"predict()"}),", and ",(0,i.jsx)(t.code,{children:"transform()"})," methods."]}),"\n",(0,i.jsx)(t.p,{children:"MLflow's integration with scikit-learn provides automatic experiment tracking, model management, and deployment capabilities for traditional machine learning workflows."}),"\n",(0,i.jsx)(t.h2,{id:"why-mlflow--scikit-learn",children:"Why MLflow + Scikit-learn?"}),"\n",(0,i.jsx)(s.A,{features:[{icon:d.A,title:"Automatic Logging",description:"Single line of code (mlflow.sklearn.autolog()) captures all parameters, metrics, cross-validation results, and models without manual instrumentation."},{icon:c.A,title:"Complete Model Recording",description:"Logs trained models with serialization format, input/output signatures, model dependencies, and Python environment for reproducible deployments."},{icon:m.A,title:"Hyperparameter Tuning",description:"Built-in support for GridSearchCV and RandomizedSearchCV with automatic child run creation for each parameter combination."},{icon:h.A,title:"Post-Training Metrics",description:"Automatically captures evaluation metrics computed after training, including sklearn.metrics function calls and model.score() evaluations."}]}),"\n",(0,i.jsx)(t.h2,{id:"getting-started",children:"Getting Started"}),"\n",(0,i.jsx)(t.p,{children:"Get started with scikit-learn and MLflow in just a few lines of code:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:'import mlflow\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.datasets import load_wine\nfrom sklearn.model_selection import train_test_split\n\n# Enable autologging\nmlflow.sklearn.autolog()\n\n# Load and prepare data\nwine = load_wine()\nX_train, X_test, y_train, y_test = train_test_split(\n    wine.data, wine.target, test_size=0.2, random_state=42\n)\n\n# Train model - MLflow automatically logs everything!\nwith mlflow.start_run():\n    model = RandomForestClassifier(n_estimators=100, max_depth=3, random_state=42)\n    model.fit(X_train, y_train)\n\n    # Evaluation metrics are automatically captured\n    train_score = model.score(X_train, y_train)\n    test_score = model.score(X_test, y_test)\n\n    print(f"Train accuracy: {train_score:.3f}, Test accuracy: {test_score:.3f}")\n'})}),"\n",(0,i.jsx)(t.p,{children:"Autologging captures all model parameters, training metrics, the trained model, and model signatures."}),"\n",(0,i.jsx)(t.admonition,{title:"Tracking Server Setup",type:"tip",children:(0,i.jsxs)(t.p,{children:["Running locally? MLflow stores experiments in the current directory by default. For team collaboration or remote tracking, ",(0,i.jsx)(t.strong,{children:(0,i.jsx)(t.a,{href:"/ml/tracking/tutorials/remote-server",children:"set up a tracking server"})}),"."]})}),"\n",(0,i.jsx)(t.h2,{id:"autologging",children:"Autologging"}),"\n",(0,i.jsx)(t.p,{children:"Enable autologging to automatically track scikit-learn experiments:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:"import mlflow\nfrom sklearn.ensemble import GradientBoostingClassifier\nfrom sklearn.datasets import load_breast_cancer\nfrom sklearn.model_selection import train_test_split\n\n# Load data\ncancer = load_breast_cancer()\nX_train, X_test, y_train, y_test = train_test_split(\n    cancer.data, cancer.target, test_size=0.2, random_state=42\n)\n\n# Enable autologging\nmlflow.sklearn.autolog()\n\nwith mlflow.start_run():\n    model = GradientBoostingClassifier(n_estimators=100, random_state=42)\n    model.fit(X_train, y_train)\n\n    # Model scoring is automatically captured\n    train_score = model.score(X_train, y_train)\n    test_score = model.score(X_test, y_test)\n"})}),"\n",(0,i.jsx)(t.h3,{id:"what-gets-logged",children:"What Gets Logged"}),"\n",(0,i.jsx)(t.p,{children:"When autologging is enabled, MLflow automatically captures:"}),"\n",(0,i.jsxs)(t.ul,{children:["\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Parameters"}),": All model parameters from ",(0,i.jsx)(t.code,{children:"estimator.get_params(deep=True)"})]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Metrics"}),": Training scores, classification/regression metrics, cross-validation results"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Models"}),": Serialized models with signatures and input examples"]}),"\n",(0,i.jsxs)(t.li,{children:[(0,i.jsx)(t.strong,{children:"Artifacts"}),": Cross-validation results, metric information, model metadata"]}),"\n"]}),"\n",(0,i.jsx)(t.p,{children:"For GridSearchCV and RandomizedSearchCV, MLflow creates child runs for parameter combinations and logs the best estimator separately."}),"\n",(0,i.jsx)(t.h2,{id:"hyperparameter-tuning",children:"Hyperparameter Tuning"}),"\n",(0,i.jsx)(t.h3,{id:"grid-search",children:"Grid Search"}),"\n",(0,i.jsx)(t.p,{children:"MLflow automatically creates child runs for hyperparameter tuning:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:'import mlflow\nfrom sklearn.datasets import load_digits\nfrom sklearn.ensemble import RandomForestClassifier\nfrom sklearn.model_selection import GridSearchCV, train_test_split\n\n# Load data\ndigits = load_digits()\nX_train, X_test, y_train, y_test = train_test_split(\n    digits.data, digits.target, test_size=0.2, random_state=42\n)\n\n# Enable autologging\nmlflow.sklearn.autolog(max_tuning_runs=10)\n\n# Define parameter grid\nparam_grid = {\n    "n_estimators": [50, 100, 200],\n    "max_depth": [5, 10, 15, None],\n    "min_samples_split": [2, 5, 10],\n}\n\nwith mlflow.start_run(run_name="RF Hyperparameter Tuning"):\n    rf = RandomForestClassifier(random_state=42)\n    grid_search = GridSearchCV(rf, param_grid, cv=5, scoring="accuracy", n_jobs=-1)\n    grid_search.fit(X_train, y_train)\n\n    best_score = grid_search.score(X_test, y_test)\n    print(f"Best params: {grid_search.best_params_}")\n    print(f"Best CV score: {grid_search.best_score_:.3f}")\n    print(f"Test score: {best_score:.3f}")\n'})}),"\n",(0,i.jsx)(t.h3,{id:"optuna-integration",children:"Optuna Integration"}),"\n",(0,i.jsx)(t.p,{children:"For advanced hyperparameter optimization:"}),"\n",(0,i.jsx)(t.pre,{children:(0,i.jsx)(t.code,{className:"language-python",children:'import mlflow\nimport optuna\nfrom sklearn.datasets import load_breast_cancer\nfrom sklearn.ensemble import GradientBoostingClassifier\nfrom sklearn.model_selection import train_test_split\n\n# Load data\ncancer = load_breast_cancer()\nX_train, X_test, y_train, y_test = train_test_split(\n    cancer.data, cancer.target, test_size=0.2, random_state=42\n)\n\nmlflow.sklearn.autolog()\n\n\ndef objective(trial):\n    params = {\n        "n_estimators": trial.suggest_int("n_estimators", 50, 200),\n        "max_depth": trial.suggest_int("max_depth", 3, 10),\n        "learning_rate": trial.suggest_float("learning_rate", 0.01, 0.3),\n    }\n\n    with mlflow.start_run(nested=True):\n        model = GradientBoostingClassifier(**params, random_state=42)\n        model.fit(X_train, y_train)\n        accuracy = model.score(X_test, y_test)\n        return accuracy\n\n\nwith mlflow.start_run():\n    study = optuna.create_study(direction="maximize")\n    study.optimize(objective, n_trials=20)\n\n    mlflow.log_params({f"best_{k}": v for k, v in study.best_params.items()})\n    mlflow.log_metric("best_accuracy", study.best_value)\n'})}),"\n",(0,i.jsx)(t.admonition,{title:"Nested Runs",type:"note",children:(0,i.jsxs)(t.p,{children:["The ",(0,i.jsx)(t.code,{children:"nested=True"})," parameter creates child runs for each trial under the parent run, enabling hierarchical organization of hyperparameter tuning experiments. Learn more about ",(0,i.jsx)(t.strong,{children:(0,i.jsx)(t.a,{href:"/ml/tracking/tracking-api#hierarchical-runs-with-parent-child-relationships",children:"hierarchical runs"})}),"."]})}),"\n",(0,i.jsx)(t.h2,{id:"learn-more",children:"Learn More"}),"\n",(0,i.jsxs)(l.A,{children:[(0,i.jsx)(o.A,{icon:p.A,title:"Model Registry",description:"Register and manage scikit-learn model versions with aliases for deployment workflows.",href:"/ml/model-registry"}),(0,i.jsx)(o.A,{icon:u.A,title:"Model Deployment",description:"Deploy scikit-learn models to production using MLflow's serving capabilities and cloud integrations.",href:"/ml/deployment"}),(0,i.jsx)(o.A,{icon:g.A,title:"Model Evaluation",description:"Evaluate scikit-learn models using MLflow's comprehensive evaluation framework with built-in metrics.",href:"/ml/evaluation"})]})]})}function w(e={}){let{wrapper:t}={...(0,a.R)(),...e.components};return t?(0,i.jsx)(t,{...e,children:(0,i.jsx)(k,{...e})}):k(e)}},75689(e,t,n){n.d(t,{A:()=>o});var r=n(96540);let i=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,n)=>n?n.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},a=(...e)=>e.filter((e,t,n)=>!!e&&""!==e.trim()&&n.indexOf(e)===t).join(" ").trim();var s={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let l=(0,r.forwardRef)(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:i,className:l="",children:o,iconNode:d,...c},m)=>(0,r.createElement)("svg",{ref:m,...s,width:t,height:t,stroke:e,strokeWidth:i?24*Number(n)/Number(t):n,className:a("lucide",l),...!o&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(c)&&{"aria-hidden":"true"},...c},[...d.map(([e,t])=>(0,r.createElement)(e,t)),...Array.isArray(o)?o:[o]])),o=(e,t)=>{let n=(0,r.forwardRef)(({className:n,...s},o)=>(0,r.createElement)(l,{ref:o,iconNode:t,className:a(`lucide-${i(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()}`,`lucide-${e}`,n),...s}));return n.displayName=i(e),n}},22864(e,t,n){n.d(t,{A:()=>r});let r=(0,n(75689).A)("chart-column",[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]])},51004(e,t,n){n.d(t,{A:()=>r});let r=(0,n(75689).A)("database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]])},61878(e,t,n){n.d(t,{A:()=>r});let r=(0,n(75689).A)("git-branch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]])},17133(e,t,n){n.d(t,{A:()=>r});let r=(0,n(75689).A)("package",[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]])},99653(e,t,n){n.d(t,{A:()=>r});let r=(0,n(75689).A)("rocket",[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]])},76316(e,t,n){n.d(t,{A:()=>r});let r=(0,n(75689).A)("trending-up",[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]])},46858(e,t,n){n.d(t,{A:()=>r});let r=(0,n(75689).A)("zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]])},33508(e,t,n){n.d(t,{A:()=>i});var r=n(74848);n(96540);function i({features:e,col:t=2}){return(0,r.jsx)("div",{className:"featureHighlights_Ardf",style:{gridTemplateColumns:`repeat(${t}, 1fr)`},children:e.map((e,t)=>(0,r.jsxs)("div",{className:"highlightItem_XPnN",children:[e.icon&&(0,r.jsx)("div",{className:"highlightIcon_SUR8",children:(0,r.jsx)(e.icon,{size:24})}),(0,r.jsxs)("div",{className:"highlightContent_d0XP",children:[(0,r.jsx)("h4",{children:e.title}),(0,r.jsx)("p",{children:e.description})]})]},t))})}},77541(e,t,n){n.d(t,{A:()=>d});var r=n(74848);n(96540);var i=n(95310),a=n(34164);let s="tileImage_O4So";var l=n(66497),o=n(92802);function d({icon:e,image:t,imageDark:n,imageWidth:d,imageHeight:c,iconSize:m=32,containerHeight:h,title:p,description:u,href:g,linkText:f="Learn more \u2192",className:_}){if(!e&&!t)throw Error("TileCard requires either an icon or image prop");let y=h?{height:`${h}px`}:{},x={};return d&&(x.width=`${d}px`),c&&(x.height=`${c}px`),(0,r.jsxs)(i.A,{href:g,className:(0,a.A)("tileCard_NHsj",_),children:[(0,r.jsx)("div",{className:"tileIcon_pyoR",style:y,children:e?(0,r.jsx)(e,{size:m}):n?(0,r.jsx)(o.A,{sources:{light:(0,l.default)(t),dark:(0,l.default)(n)},alt:p,className:s,style:x}):(0,r.jsx)("img",{src:(0,l.default)(t),alt:p,className:s,style:x})}),(0,r.jsx)("h3",{children:p}),(0,r.jsx)("p",{children:u}),(0,r.jsx)("div",{className:"tileLink_iUbu",children:f})]})}},10440(e,t,n){n.d(t,{A:()=>a});var r=n(74848);n(96540);var i=n(34164);function a({children:e,className:t}){return(0,r.jsx)("div",{className:(0,i.A)("tilesGrid_hB9N",t),children:e})}},28453(e,t,n){n.d(t,{R:()=>s,x:()=>l});var r=n(96540);let i={},a=r.createContext(i);function s(e){let t=r.useContext(a);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function l(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:s(e.components),r.createElement(a.Provider,{value:t},e.children)}}}]);