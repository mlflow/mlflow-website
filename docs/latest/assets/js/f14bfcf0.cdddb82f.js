"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[8089],{6911:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/search-traces-on-ui-b8c6e343054a11ab58c527547ee43974.png"},11470:(e,t,n)=>{n.d(t,{A:()=>v});var r=n(96540),s=n(34164),i=n(17559),l=n(23104),a=n(56347),c=n(205),o=n(57485),d=n(31682),h=n(70679);function m(e){return r.Children.toArray(e).filter(e=>"\n"!==e).map(e=>{if(!e||(0,r.isValidElement)(e)&&function(e){const{props:t}=e;return!!t&&"object"==typeof t&&"value"in t}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})?.filter(Boolean)??[]}function p(e){const{values:t,children:n}=e;return(0,r.useMemo)(()=>{const e=t??function(e){return m(e).map(({props:{value:e,label:t,attributes:n,default:r}})=>({value:e,label:t,attributes:n,default:r}))}(n);return function(e){const t=(0,d.XI)(e,(e,t)=>e.value===t.value);if(t.length>0)throw new Error(`Docusaurus error: Duplicate values "${t.map(e=>e.value).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e},[t,n])}function f({value:e,tabValues:t}){return t.some(t=>t.value===e)}function u({queryString:e=!1,groupId:t}){const n=(0,a.W6)(),s=function({queryString:e=!1,groupId:t}){if("string"==typeof e)return e;if(!1===e)return null;if(!0===e&&!t)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return t??null}({queryString:e,groupId:t});return[(0,o.aZ)(s),(0,r.useCallback)(e=>{if(!s)return;const t=new URLSearchParams(n.location.search);t.set(s,e),n.replace({...n.location,search:t.toString()})},[s,n])]}function x(e){const{defaultValue:t,queryString:n=!1,groupId:s}=e,i=p(e),[l,a]=(0,r.useState)(()=>function({defaultValue:e,tabValues:t}){if(0===t.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(e){if(!f({value:e,tabValues:t}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${e}" but none of its children has the corresponding value. Available values are: ${t.map(e=>e.value).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return e}const n=t.find(e=>e.default)??t[0];if(!n)throw new Error("Unexpected error: 0 tabValues");return n.value}({defaultValue:t,tabValues:i})),[o,d]=u({queryString:n,groupId:s}),[m,x]=function({groupId:e}){const t=function(e){return e?`docusaurus.tab.${e}`:null}(e),[n,s]=(0,h.Dv)(t);return[n,(0,r.useCallback)(e=>{t&&s.set(e)},[t,s])]}({groupId:s}),j=(()=>{const e=o??m;return f({value:e,tabValues:i})?e:null})();(0,c.A)(()=>{j&&a(j)},[j]);return{selectedValue:l,selectValue:(0,r.useCallback)(e=>{if(!f({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);a(e),d(e),x(e)},[d,x,i]),tabValues:i}}var j=n(92303);const _={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var g=n(74848);function w({className:e,block:t,selectedValue:n,selectValue:r,tabValues:i}){const a=[],{blockElementScrollPositionUntilNextRender:c}=(0,l.a_)(),o=e=>{const t=e.currentTarget,s=a.indexOf(t),l=i[s].value;l!==n&&(c(t),r(l))},d=e=>{let t=null;switch(e.key){case"Enter":o(e);break;case"ArrowRight":{const n=a.indexOf(e.currentTarget)+1;t=a[n]??a[0];break}case"ArrowLeft":{const n=a.indexOf(e.currentTarget)-1;t=a[n]??a[a.length-1];break}}t?.focus()};return(0,g.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":t},e),children:i.map(({value:e,label:t,attributes:r})=>(0,g.jsx)("li",{role:"tab",tabIndex:n===e?0:-1,"aria-selected":n===e,ref:e=>{a.push(e)},onKeyDown:d,onClick:o,...r,className:(0,s.A)("tabs__item",_.tabItem,r?.className,{"tabs__item--active":n===e}),children:t??e},e))})}function y({lazy:e,children:t,selectedValue:n}){const i=(Array.isArray(t)?t:[t]).filter(Boolean);if(e){const e=i.find(e=>e.props.value===n);return e?(0,r.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,g.jsx)("div",{className:"margin-top--md",children:i.map((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==n}))})}function b(e){const t=x(e);return(0,g.jsxs)("div",{className:(0,s.A)(i.G.tabs.container,"tabs-container",_.tabList),children:[(0,g.jsx)(w,{...t,...e}),(0,g.jsx)(y,{...t,...e})]})}function v(e){const t=(0,j.A)();return(0,g.jsx)(b,{...e,children:m(e.children)},String(t))}},19365:(e,t,n)=>{n.d(t,{A:()=>l});n(96540);var r=n(34164);const s={tabItem:"tabItem_Ymn6"};var i=n(74848);function l({children:e,hidden:t,className:n}){return(0,i.jsx)("div",{role:"tabpanel",className:(0,r.A)(s.tabItem,n),hidden:t,children:e})}},20139:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/search_syntax-8db1091a58dda699e58cd3846c12cace.png"},27441:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/tracing_search_traces-b3a85a28e78491294f0a3c747768a039.png"},28453:(e,t,n)=>{n.d(t,{R:()=>l,x:()=>a});var r=n(96540);const s={},i=r.createContext(s);function l(e){const t=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(t):{...t,...e}},[t,e])}function a(e){let t;return t=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),r.createElement(i.Provider,{value:t},e.children)}},28485:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/search-traces-assessments-on-ui-e09348c7f5985a54d8efd1ba117488b3.png"},49374:(e,t,n)=>{n.d(t,{B:()=>a});n(96540);const r=JSON.parse('{"mlflow.ag2":"api_reference/python_api/mlflow.ag2.html","mlflow.agno":"api_reference/python_api/mlflow.agno.html","mlflow.anthropic":"api_reference/python_api/mlflow.anthropic.html","mlflow.artifacts":"api_reference/python_api/mlflow.artifacts.html","mlflow.autogen":"api_reference/python_api/mlflow.autogen.html","mlflow.bedrock":"api_reference/python_api/mlflow.bedrock.html","mlflow.catboost":"api_reference/python_api/mlflow.catboost.html","mlflow.client":"api_reference/python_api/mlflow.client.html","mlflow.config":"api_reference/python_api/mlflow.config.html","mlflow.crewai":"api_reference/python_api/mlflow.crewai.html","mlflow.data":"api_reference/python_api/mlflow.data.html","mlflow.deployments":"api_reference/python_api/mlflow.deployments.html","mlflow.diviner":"api_reference/python_api/mlflow.diviner.html","mlflow.dspy":"api_reference/python_api/mlflow.dspy.html","mlflow.entities":"api_reference/python_api/mlflow.entities.html","mlflow.environment_variables":"api_reference/python_api/mlflow.environment_variables.html","mlflow.gateway":"api_reference/python_api/mlflow.gateway.html","mlflow.gemini":"api_reference/python_api/mlflow.gemini.html","mlflow.genai":"api_reference/python_api/mlflow.genai.html","mlflow.groq":"api_reference/python_api/mlflow.groq.html","mlflow.h2o":"api_reference/python_api/mlflow.h2o.html","mlflow.johnsnowlabs":"api_reference/python_api/mlflow.johnsnowlabs.html","mlflow.keras":"api_reference/python_api/mlflow.keras.html","mlflow.langchain":"api_reference/python_api/mlflow.langchain.html","mlflow.lightgbm":"api_reference/python_api/mlflow.lightgbm.html","mlflow.litellm":"api_reference/python_api/mlflow.litellm.html","mlflow.llama_index":"api_reference/python_api/mlflow.llama_index.html","mlflow.metrics":"api_reference/python_api/mlflow.metrics.html","mlflow.mistral":"api_reference/python_api/mlflow.mistral.html","mlflow.models":"api_reference/python_api/mlflow.models.html","mlflow.onnx":"api_reference/python_api/mlflow.onnx.html","mlflow.openai":"api_reference/python_api/mlflow.openai.html","mlflow.paddle":"api_reference/python_api/mlflow.paddle.html","mlflow.pmdarima":"api_reference/python_api/mlflow.pmdarima.html","mlflow.projects":"api_reference/python_api/mlflow.projects.html","mlflow.prophet":"api_reference/python_api/mlflow.prophet.html","mlflow.pydantic_ai":"api_reference/python_api/mlflow.pydantic_ai.html","mlflow.pyfunc":"api_reference/python_api/mlflow.pyfunc.html","mlflow.pyspark.ml":"api_reference/python_api/mlflow.pyspark.ml.html","mlflow.pytorch":"api_reference/python_api/mlflow.pytorch.html","mlflow":"api_reference/python_api/mlflow.html","mlflow.sagemaker":"api_reference/python_api/mlflow.sagemaker.html","mlflow.sentence_transformers":"api_reference/python_api/mlflow.sentence_transformers.html","mlflow.server":"api_reference/python_api/mlflow.server.html","mlflow.shap":"api_reference/python_api/mlflow.shap.html","mlflow.sklearn":"api_reference/python_api/mlflow.sklearn.html","mlflow.smolagents":"api_reference/python_api/mlflow.smolagents.html","mlflow.spacy":"api_reference/python_api/mlflow.spacy.html","mlflow.spark":"api_reference/python_api/mlflow.spark.html","mlflow.statsmodels":"api_reference/python_api/mlflow.statsmodels.html","mlflow.system_metrics":"api_reference/python_api/mlflow.system_metrics.html","mlflow.tensorflow":"api_reference/python_api/mlflow.tensorflow.html","mlflow.tracing":"api_reference/python_api/mlflow.tracing.html","mlflow.transformers":"api_reference/python_api/mlflow.transformers.html","mlflow.types":"api_reference/python_api/mlflow.types.html","mlflow.utils":"api_reference/python_api/mlflow.utils.html","mlflow.webhooks":"api_reference/python_api/mlflow.webhooks.html","mlflow.xgboost":"api_reference/python_api/mlflow.xgboost.html","mlflow.server.auth":"api_reference/auth/python-api.html","mlflow.server.cli":"api_reference/cli.html","mlflow.r":"api_reference/R-api.html","mlflow.java":"api_reference/java_api/index.html","mlflow.python":"api_reference/python_api/index.html","mlflow.rest":"api_reference/rest-api.html","mlflow.typescript":"api_reference/typescript_api/index.html","mlflow.llms.deployments.api":"api_reference/llms/deployments/api.html"}');var s=n(86025),i=n(74848);const l=e=>{const t=e.split(".");for(let n=t.length;n>0;n--){const e=t.slice(0,n).join(".");if(r[e])return e}return null};function a({fn:e,children:t,hash:n}){const a=l(e);if(!a)return(0,i.jsx)(i.Fragment,{children:t});const c=(0,s.default)(`/${r[a]}#${n??e}`);return(0,i.jsx)("a",{href:c,target:"_blank",children:t??(0,i.jsxs)("code",{children:[e,"()"]})})}},87309:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>h,contentTitle:()=>d,default:()=>f,frontMatter:()=>o,metadata:()=>r,toc:()=>m});const r=JSON.parse('{"id":"tracing/search-traces","title":"Search Traces","description":"This guide will walk you through how to search for traces in MLflow using both the MLflow UI and Python API. This resource will be valuable if you\'re interested in querying specific traces based on their metadata, tags, execution time, status, or other trace attributes.","source":"@site/docs/genai/tracing/search-traces.mdx","sourceDirName":"tracing","slug":"/tracing/search-traces","permalink":"/mlflow-website/docs/latest/genai/tracing/search-traces","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{},"sidebar":"genAISidebar","previous":{"title":"MLflow Tracing UI","permalink":"/mlflow-website/docs/latest/genai/tracing/observe-with-traces/ui"},"next":{"title":"Overview","permalink":"/mlflow-website/docs/latest/genai/tracing/opentelemetry/"}}');var s=n(74848),i=n(28453),l=n(49374),a=n(11470),c=n(19365);const o={},d="Search Traces",h={},m=[{value:"Search Traces Overview",id:"search-traces-overview",level:2},{value:"Filtering Traces in the UI",id:"filtering-traces-in-the-ui",level:2},{value:"Search Query Syntax",id:"search-query-syntax",level:2},{value:"Visual Representation of Search Components:",id:"visual-representation-of-search-components",level:3},{value:"Supported Filters and Comparators",id:"supported-filters-and-comparators",level:3},{value:"Example Queries",id:"example-queries",level:3},{value:"Full Text Search",id:"full-text-search",level:4},{value:"Filter by Name",id:"filter-by-name",level:4},{value:"Filter by Status",id:"filter-by-status",level:4},{value:"Filter by Execution Time",id:"filter-by-execution-time",level:4},{value:"Filter by Timestamp",id:"filter-by-timestamp",level:4},{value:"Filter by Tags",id:"filter-by-tags",level:4},{value:"Filter by Run Association",id:"filter-by-run-association",level:4},{value:"Filter by Span Attributes",id:"filter-by-span-attributes",level:4},{value:"Filter by Feedback",id:"filter-by-feedback",level:4},{value:"Filter by Expectations",id:"filter-by-expectations",level:4},{value:"Filter by End Time",id:"filter-by-end-time",level:4},{value:"Combine Multiple Conditions",id:"combine-multiple-conditions",level:4},{value:"Programmatic Search with Python",id:"programmatic-search-with-python",level:2},{value:"Return Format",id:"return-format",level:3},{value:"1. DataFrame",id:"1-dataframe",level:4},{value:"2. List of Trace Objects",id:"2-list-of-trace-objects",level:4},{value:"Ordering Results",id:"ordering-results",level:3},{value:"Pagination",id:"pagination",level:3},{value:"Important Notes",id:"important-notes",level:2},{value:"MLflow Version Compatibility",id:"mlflow-version-compatibility",level:3},{value:"Performance Tips",id:"performance-tips",level:3},{value:"Backend Considerations",id:"backend-considerations",level:3}];function p(e){const t={admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(t.header,{children:(0,s.jsx)(t.h1,{id:"search-traces",children:"Search Traces"})}),"\n",(0,s.jsx)(t.p,{children:"This guide will walk you through how to search for traces in MLflow using both the MLflow UI and Python API. This resource will be valuable if you're interested in querying specific traces based on their metadata, tags, execution time, status, or other trace attributes."}),"\n",(0,s.jsxs)(t.p,{children:["MLflow's trace search functionality allows you to leverage SQL-like syntax to filter your traces based on a variety of conditions. While the ",(0,s.jsx)(t.code,{children:"OR"})," keyword is not supported, the search functionality is powerful enough to handle complex queries for trace discovery and analysis."]}),"\n",(0,s.jsx)(t.admonition,{type:"important",children:(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"Local File Store offers only limited search capabilities and can become slow as data volume grows."})," As of MLflow 3.6.0, the FileStore is deprecated. We recommend migrating to a SQL-backed store or Databricks for improved performance and more robust search functionality."]})}),"\n",(0,s.jsx)(t.h2,{id:"search-traces-overview",children:"Search Traces Overview"}),"\n",(0,s.jsxs)(t.p,{children:["When working with MLflow tracing in production environments, you'll often have thousands of traces across different experiments representing various model inferences, LLM calls, or ML pipeline executions. The ",(0,s.jsx)(t.code,{children:"search_traces"})," API helps you find specific traces based on their execution characteristics, metadata, tags, and other attributes - making trace analysis and debugging much more efficient."]}),"\n",(0,s.jsx)(t.h2,{id:"filtering-traces-in-the-ui",children:"Filtering Traces in the UI"}),"\n",(0,s.jsx)(t.p,{children:"The UI search supports all the same filter syntax as the API, allowing you to search by:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"Trace inputs"}),"\n",(0,s.jsx)(t.li,{children:"Trace attributes: trace name, status, end time, execution time, run_id"}),"\n",(0,s.jsx)(t.li,{children:"Trace tags and metadata"}),"\n",(0,s.jsx)(t.li,{children:"Trace assessments: feedback or expectations"}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:"Use the filters dropdown in the MLflow Trace UI to filter traces by various criteria:"}),"\n",(0,s.jsx)("div",{class:"center-div",style:{width:"100%"},children:(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"search components",src:n(27441).A+"",width:"2948",height:"1332"})})}),"\n",(0,s.jsx)(t.p,{children:"For example, searching for traces that with ERROR state:"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Search Traces UI",src:n(6911).A+"",width:"2948",height:"1332"})}),"\n",(0,s.jsx)(t.p,{children:"Search for trace inputs:"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Search Traces Inputs UI",src:n(98867).A+"",width:"2948",height:"1332"})}),"\n",(0,s.jsx)(t.p,{children:"Search for trace assessments by key and value:"}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"Search Traces By Assessments UI",src:n(28485).A+"",width:"3734",height:"1290"})}),"\n",(0,s.jsx)(t.h2,{id:"search-query-syntax",children:"Search Query Syntax"}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"search_traces"})," API uses a SQL-like Domain Specific Language (DSL) for querying traces."]}),"\n",(0,s.jsx)(t.h3,{id:"visual-representation-of-search-components",children:"Visual Representation of Search Components:"}),"\n",(0,s.jsx)("div",{class:"center-div",style:{width:"30%"},children:(0,s.jsx)(t.p,{children:(0,s.jsx)(t.img,{alt:"search components",src:n(20139).A+"",width:"439",height:"142"})})}),"\n",(0,s.jsx)(t.h3,{id:"supported-filters-and-comparators",children:"Supported Filters and Comparators"}),"\n",(0,s.jsxs)(t.table,{children:[(0,s.jsx)(t.thead,{children:(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.th,{children:"Field Type"}),(0,s.jsx)(t.th,{children:"Fields"}),(0,s.jsx)(t.th,{children:"Operators"}),(0,s.jsx)(t.th,{children:"Examples"})]})}),(0,s.jsxs)(t.tbody,{children:[(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"Trace Status"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"trace.status"})}),(0,s.jsxs)(t.td,{children:[(0,s.jsx)(t.code,{children:"="}),", ",(0,s.jsx)(t.code,{children:"!="})]}),(0,s.jsx)(t.td,{children:'trace.status = "OK"'})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"Trace Timestamps"})}),(0,s.jsxs)(t.td,{children:[(0,s.jsx)(t.code,{children:"trace.timestamp_ms"}),", ",(0,s.jsx)(t.code,{children:"trace.execution_time_ms"}),", ",(0,s.jsx)(t.code,{children:"trace.end_time_ms"})]}),(0,s.jsxs)(t.td,{children:[(0,s.jsx)(t.code,{children:"="}),", ",(0,s.jsx)(t.code,{children:"!="}),", ",(0,s.jsx)(t.code,{children:">"}),", ",(0,s.jsx)(t.code,{children:"<"}),", ",(0,s.jsx)(t.code,{children:">="}),", ",(0,s.jsx)(t.code,{children:"<="})]}),(0,s.jsx)(t.td,{children:"trace.end_time_ms > 1762408895531"})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"Trace IDs"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"trace.run_id"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"="})}),(0,s.jsx)(t.td,{children:'trace.run_id = "run_id"'})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"String Fields"})}),(0,s.jsxs)(t.td,{children:[(0,s.jsx)(t.code,{children:"trace.client_request_id"}),", ",(0,s.jsx)(t.code,{children:"trace.name"})]}),(0,s.jsxs)(t.td,{children:[(0,s.jsx)(t.code,{children:"="}),", ",(0,s.jsx)(t.code,{children:"!="}),", ",(0,s.jsx)(t.code,{children:"LIKE"}),", ",(0,s.jsx)(t.code,{children:"ILIKE"}),", ",(0,s.jsx)(t.code,{children:"RLIKE"})]}),(0,s.jsx)(t.td,{children:'trace.name LIKE "%Generate%"'})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"Span Name/Type"})}),(0,s.jsxs)(t.td,{children:[(0,s.jsx)(t.code,{children:"span.name"}),", ",(0,s.jsx)(t.code,{children:"span.type"})]}),(0,s.jsxs)(t.td,{children:[(0,s.jsx)(t.code,{children:"="}),", ",(0,s.jsx)(t.code,{children:"!="}),", ",(0,s.jsx)(t.code,{children:"LIKE"}),", ",(0,s.jsx)(t.code,{children:"ILIKE"}),", ",(0,s.jsx)(t.code,{children:"RLIKE"})]}),(0,s.jsx)(t.td,{children:'span.type RLIKE "^LLM"'})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"Span Attributes"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"span.attributes.<key>"})}),(0,s.jsxs)(t.td,{children:[(0,s.jsx)(t.code,{children:"LIKE"}),", ",(0,s.jsx)(t.code,{children:"ILIKE"})]}),(0,s.jsx)(t.td,{children:'span.attributes.model RLIKE "^gpt"'})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"Tags"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"tag.<key>"})}),(0,s.jsxs)(t.td,{children:[(0,s.jsx)(t.code,{children:"="}),", ",(0,s.jsx)(t.code,{children:"!="}),", ",(0,s.jsx)(t.code,{children:"LIKE"}),", ",(0,s.jsx)(t.code,{children:"ILIKE"}),", ",(0,s.jsx)(t.code,{children:"RLIKE"})]}),(0,s.jsx)(t.td,{children:'tag.key = "value"'})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"Metadata"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"metadata.<key>"})}),(0,s.jsxs)(t.td,{children:[(0,s.jsx)(t.code,{children:"="}),", ",(0,s.jsx)(t.code,{children:"!="}),", ",(0,s.jsx)(t.code,{children:"LIKE"}),", ",(0,s.jsx)(t.code,{children:"ILIKE"}),", ",(0,s.jsx)(t.code,{children:"RLIKE"})]}),(0,s.jsx)(t.td,{children:'metadata.user_id LIKE "user%"'})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"Feedback"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"feedback.<name>"})}),(0,s.jsxs)(t.td,{children:[(0,s.jsx)(t.code,{children:"="}),", ",(0,s.jsx)(t.code,{children:"!="}),", ",(0,s.jsx)(t.code,{children:"LIKE"}),", ",(0,s.jsx)(t.code,{children:"ILIKE"}),", ",(0,s.jsx)(t.code,{children:"RLIKE"})]}),(0,s.jsx)(t.td,{children:'feedback.rating = "excellent"'})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"Expectations"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"expectation.<name>"})}),(0,s.jsxs)(t.td,{children:[(0,s.jsx)(t.code,{children:"="}),", ",(0,s.jsx)(t.code,{children:"!="}),", ",(0,s.jsx)(t.code,{children:"LIKE"}),", ",(0,s.jsx)(t.code,{children:"ILIKE"}),", ",(0,s.jsx)(t.code,{children:"RLIKE"})]}),(0,s.jsx)(t.td,{children:'expectation.result = "pass"'})]}),(0,s.jsxs)(t.tr,{children:[(0,s.jsx)(t.td,{children:(0,s.jsx)(t.strong,{children:"Full Text"})}),(0,s.jsx)(t.td,{children:(0,s.jsx)(t.code,{children:"trace.text"})}),(0,s.jsxs)(t.td,{children:[(0,s.jsx)(t.code,{children:"LIKE"})," (with ",(0,s.jsx)(t.code,{children:"%"})," wildcards)"]}),(0,s.jsx)(t.td,{children:'trace.text LIKE "%tell me a storty"'})]})]})]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Value Syntax:"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:["String values must be quoted: ",(0,s.jsx)(t.code,{children:"status = 'OK'"})]}),"\n",(0,s.jsxs)(t.li,{children:["Numeric values don't need quotes: ",(0,s.jsx)(t.code,{children:"execution_time_ms > 1000"})]}),"\n",(0,s.jsx)(t.li,{children:"Tag and metadata values must be quoted as strings"}),"\n",(0,s.jsxs)(t.li,{children:["Full text search must use ",(0,s.jsx)(t.code,{children:"LIKE"})," with ",(0,s.jsx)(t.code,{children:"%"})," wildcards"]}),"\n"]}),"\n",(0,s.jsx)(t.p,{children:(0,s.jsx)(t.strong,{children:"Pattern Matching Operators:"})}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"LIKE"}),": Case-sensitive pattern matching (use ",(0,s.jsx)(t.code,{children:"%"})," for wildcards)"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"ILIKE"}),": Case-insensitive pattern matching (use ",(0,s.jsx)(t.code,{children:"%"})," for wildcards)"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"RLIKE"}),": Regular expression matching"]}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"example-queries",children:"Example Queries"}),"\n",(0,s.jsx)(t.h4,{id:"full-text-search",children:"Full Text Search"}),"\n",(0,s.jsx)(t.p,{children:"Search for any contents existing in your trace."}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"# Search for traces containing specific text\nmlflow.search_traces(filter_string=\"trace.text LIKE '%authentication error%'\")\n\n# Search for multiple terms\nmlflow.search_traces(filter_string=\"trace.text LIKE '%timeout%'\")\n"})}),"\n",(0,s.jsx)(t.h4,{id:"filter-by-name",children:"Filter by Name"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"# Exact match\nmlflow.search_traces(filter_string=\"trace.name = 'predict'\")\n\n# Pattern matching with LIKE\nmlflow.search_traces(filter_string=\"trace.name LIKE '%inference%'\")\n\n# Case-insensitive pattern matching with ILIKE\nmlflow.search_traces(filter_string=\"trace.name ILIKE '%PREDICT%'\")\n\n# Regular expression matching with RLIKE\nmlflow.search_traces(filter_string=\"trace.name RLIKE '^(predict|inference)_[0-9]+'\")\n"})}),"\n",(0,s.jsx)(t.h4,{id:"filter-by-status",children:"Filter by Status"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"# Get successful traces\nmlflow.search_traces(filter_string=\"trace.status = 'OK'\")\n\n# Get failed traces\nmlflow.search_traces(filter_string=\"trace.status = 'ERROR'\")\n\n# Get in-progress traces\nmlflow.search_traces(filter_string=\"trace.status != 'OK'\")\n"})}),"\n",(0,s.jsx)(t.h4,{id:"filter-by-execution-time",children:"Filter by Execution Time"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'# Find slow traces (> 1 second)\nmlflow.search_traces(filter_string="trace.execution_time_ms > 1000")\n\n# Performance range\nmlflow.search_traces(\n    filter_string="trace.execution_time_ms >= 200 AND trace.execution_time_ms <= 800"\n)\n\n# Equal to specific duration\nmlflow.search_traces(filter_string="trace.execution_time_ms = 500")\n'})}),"\n",(0,s.jsx)(t.h4,{id:"filter-by-timestamp",children:"Filter by Timestamp"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'import time\n\n# Get traces from last hour\ntimestamp = int(time.time() * 1000)\nmlflow.search_traces(filter_string=f"trace.timestamp_ms > {timestamp - 3600000}")\n\n# Exact timestamp match\nmlflow.search_traces(filter_string=f"trace.timestamp_ms = {timestamp}")\n\n# Timestamp range\nmlflow.search_traces(\n    filter_string=f"trace.timestamp_ms >= {timestamp - 7200000} AND trace.timestamp_ms <= {timestamp - 3600000}"\n)\n'})}),"\n",(0,s.jsx)(t.h4,{id:"filter-by-tags",children:"Filter by Tags"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"# Exact match\nmlflow.search_traces(filter_string=\"tag.model_name = 'gpt-4'\")\n\n# Pattern matching with LIKE (case-sensitive)\nmlflow.search_traces(filter_string=\"tag.model_name LIKE 'gpt-%'\")\n\n# Case-insensitive pattern matching with ILIKE\nmlflow.search_traces(filter_string=\"tag.environment ILIKE '%prod%'\")\n\n# Regular expression matching with RLIKE\nmlflow.search_traces(filter_string=\"tag.version RLIKE '^v[0-9]+\\\\.[0-9]+'\")\n"})}),"\n",(0,s.jsx)(t.h4,{id:"filter-by-run-association",children:"Filter by Run Association"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"# Find traces associated with a specific run\nmlflow.search_traces(filter_string=\"trace.run_id = 'run_id_123456'\")\n"})}),"\n",(0,s.jsx)(t.h4,{id:"filter-by-span-attributes",children:"Filter by Span Attributes"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"# Filter by span name\nmlflow.search_traces(filter_string=\"span.name = 'llm_call'\")\n\n# Pattern matching on span name\nmlflow.search_traces(filter_string=\"span.name LIKE '%embedding%'\")\n\n# Filter by span type\nmlflow.search_traces(filter_string=\"span.type = 'LLM'\")\n\n# Filter by custom span attributes (requires wildcards with LIKE/ILIKE)\nmlflow.search_traces(filter_string=\"span.attributes.model_version LIKE '%v2%'\")\nmlflow.search_traces(filter_string=\"span.attributes.temperature LIKE '%0.7%'\")\nmlflow.search_traces(filter_string=\"span.attributes.model_version ILIKE '%V2%'\")\n"})}),"\n",(0,s.jsx)(t.h4,{id:"filter-by-feedback",children:"Filter by Feedback"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"# Filter by feedback ratings\nmlflow.search_traces(filter_string=\"feedback.rating = 'positive'\")\n\n# Pattern matching on feedback\nmlflow.search_traces(filter_string=\"feedback.user_comment LIKE '%helpful%'\")\n"})}),"\n",(0,s.jsx)(t.h4,{id:"filter-by-expectations",children:"Filter by Expectations"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:"# Filter by expectation values\nmlflow.search_traces(filter_string=\"expectation.accuracy = 'high'\")\n\n# Pattern matching on expectations\nmlflow.search_traces(filter_string=\"expectation.label ILIKE '%success%'\")\n"})}),"\n",(0,s.jsx)(t.h4,{id:"filter-by-end-time",children:"Filter by End Time"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'import time\n\n# Get traces that completed in the last hour\nend_time = int(time.time() * 1000)\nmlflow.search_traces(filter_string=f"trace.end_time_ms > {end_time - 3600000}")\n\n# Find traces that ended within a specific time range\nmlflow.search_traces(\n    filter_string=f"trace.end_time_ms >= {end_time - 7200000} AND trace.end_time_ms <= {end_time - 3600000}"\n)\n'})}),"\n",(0,s.jsx)(t.h4,{id:"combine-multiple-conditions",children:"Combine Multiple Conditions"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'# Complex query with tags and status\nmlflow.search_traces(filter_string="trace.status = \'OK\' AND tag.importance = \'high\'")\n\n# Production error analysis with execution time\nmlflow.search_traces(\n    filter_string="""\n        tag.environment = \'production\'\n        AND trace.status = \'ERROR\'\n        AND trace.execution_time_ms > 500\n    """\n)\n\n# Advanced query with span attributes and feedback\nmlflow.search_traces(\n    filter_string="""\n        span.name LIKE \'%llm%\'\n        AND feedback.rating = \'positive\'\n        AND trace.execution_time_ms < 1000\n    """\n)\n\n# Search with pattern matching and time range\nmlflow.search_traces(\n    filter_string="""\n        trace.name ILIKE \'%inference%\'\n        AND trace.timestamp_ms > 1700000000000\n        AND span.attributes.model_version LIKE \'%v2%\'\n    """\n)\n'})}),"\n",(0,s.jsx)(t.h2,{id:"programmatic-search-with-python",children:"Programmatic Search with Python"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(l.B,{fn:"mlflow.search_traces"})," provides convenient trace search functionality:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'import mlflow\n\n# Basic search with default DataFrame output\ntraces_df = mlflow.search_traces(filter_string="trace.status = \'OK\'")\n\n# Return as list of Trace objects\ntraces_list = mlflow.search_traces(\n    filter_string="trace.status = \'OK\'", return_type="list"\n)\n'})}),"\n",(0,s.jsx)(t.admonition,{type:"note",children:(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"return_type"})," parameter is available in MLflow 2.21.1+. For older versions, use ",(0,s.jsx)(l.B,{fn:"mlflow.client.MlflowClient.search_traces"})," for list output."]})}),"\n",(0,s.jsx)(t.h3,{id:"return-format",children:"Return Format"}),"\n",(0,s.jsx)(t.h4,{id:"1-dataframe",children:"1. DataFrame"}),"\n",(0,s.jsxs)(t.p,{children:["The ",(0,s.jsx)(t.code,{children:"search_traces"})," API returns a pandas DataFrame by default with the following columns:"]}),"\n",(0,s.jsxs)(a.A,{children:[(0,s.jsx)(c.A,{value:"mlflow-3",label:"MLflow 3.x",children:(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"trace_id"})," - Primary identifier"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"trace"})," - Trace object"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"client_request_id"})," - Client request ID"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"state"})," - Trace state (OK, ERROR, IN_PROGRESS, STATE_UNSPECIFIED)"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"request_time"})," - Start time in milliseconds"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"execution_duration"})," - Duration in milliseconds"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"inputs"})," - Input to traced logic"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"outputs"})," - Output of traced logic"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"expectations"})," - A dictionary of ground truth labels annotated on the trace"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"trace_metadata"})," - Key-value metadata"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"tags"})," - Associated tags"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"assessments"})," - List of assessment objects attached on the trace"]}),"\n"]})}),(0,s.jsx)(c.A,{value:"mlflow-2",label:"MLflow 2.x",children:(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"request_id"})," - Primary identifier"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"trace"})," - Trace object"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"timestamp_ms"})," - Start time in milliseconds"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"status"})," - Trace status"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"execution_time_ms"})," - Duration in milliseconds"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"request"})," - Input to traced logic"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"response"})," - Output of traced logic"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"request_metadata"})," - Key-value metadata"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"spans"})," - Spans in trace"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"tags"})," - Associated tags"]}),"\n"]})})]}),"\n",(0,s.jsx)(t.h4,{id:"2-list-of-trace-objects",children:"2. List of Trace Objects"}),"\n",(0,s.jsxs)(t.p,{children:["Alternatively, you can specify ",(0,s.jsx)(t.code,{children:'return_type="list"'})," to get a list of ",(0,s.jsx)(l.B,{fn:"mlflow.entities.Trace"})," objects instead of a DataFrame."]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'traces = mlflow.search_traces(filter_string="trace.status = \'OK\'", return_type="list")\n# list[mlflow.entities.Trace]\n'})}),"\n",(0,s.jsx)(t.h3,{id:"ordering-results",children:"Ordering Results"}),"\n",(0,s.jsx)(t.p,{children:"MLflow supports ordering results by the following keys:"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"timestamp_ms"})," (default: DESC) - Trace start time"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"execution_time_ms"})," - Trace duration"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"status"})," - Trace execution status"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.code,{children:"request_id"})," - Trace identifier"]}),"\n"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'# Order by timestamp (most recent first)\ntraces = mlflow.search_traces(order_by=["timestamp_ms DESC"])\n\n# Multiple ordering criteria\ntraces = mlflow.search_traces(order_by=["timestamp_ms DESC", "status ASC"])\n'})}),"\n",(0,s.jsx)(t.h3,{id:"pagination",children:"Pagination"}),"\n",(0,s.jsxs)(t.p,{children:[(0,s.jsx)(l.B,{fn:"mlflow.client.MlflowClient.search_traces"})," supports pagination:"]}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-python",children:'from mlflow import MlflowClient\n\nclient = MlflowClient()\npage_token = None\nall_traces = []\n\nwhile True:\n    results = client.search_traces(\n        experiment_ids=["1"],\n        filter_string="status = \'OK\'",\n        max_results=100,\n        page_token=page_token,\n    )\n\n    all_traces.extend(results)\n\n    if not results.token:\n        break\n    page_token = results.token\n\nprint(f"Found {len(all_traces)} total traces")\n'})}),"\n",(0,s.jsx)(t.h2,{id:"important-notes",children:"Important Notes"}),"\n",(0,s.jsx)(t.h3,{id:"mlflow-version-compatibility",children:"MLflow Version Compatibility"}),"\n",(0,s.jsx)(t.admonition,{title:"Schema Changes in MLflow 3",type:"note",children:(0,s.jsxs)(t.p,{children:[(0,s.jsx)(t.strong,{children:"DataFrame Schema"}),": The format depends on the MLflow version used to ",(0,s.jsx)(t.strong,{children:"call"})," the ",(0,s.jsx)(t.code,{children:"search_traces"})," API, not the version used to log the traces. MLflow 3.x uses different column names than 2.x."]})}),"\n",(0,s.jsx)(t.h3,{id:"performance-tips",children:"Performance Tips"}),"\n",(0,s.jsxs)(t.ol,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Use timestamp filters"})," to limit search space"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Limit max_results"})," for faster queries when ordering"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Use pagination"})," for large result sets"]}),"\n"]}),"\n",(0,s.jsx)(t.h3,{id:"backend-considerations",children:"Backend Considerations"}),"\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"SQL Store Backend"}),": Supports the full search syntax documented above, including:","\n",(0,s.jsxs)(t.ul,{children:["\n",(0,s.jsx)(t.li,{children:"All trace, span, metadata, tag, feedback, and expectation filters"}),"\n",(0,s.jsx)(t.li,{children:"Pattern matching operators (LIKE, ILIKE, RLIKE)"}),"\n",(0,s.jsxs)(t.li,{children:["Full text search with ",(0,s.jsx)(t.code,{children:"trace.text"})]}),"\n",(0,s.jsx)(t.li,{children:"Optimized performance with proper indexing on timestamp"}),"\n"]}),"\n"]}),"\n",(0,s.jsxs)(t.li,{children:[(0,s.jsx)(t.strong,{children:"Local File Store"}),": Limited search capabilities. May be slower with large datasets. Not recommended, only suitable for storing small number of traces."]}),"\n"]})]})}function f(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(p,{...e})}):p(e)}},98867:(e,t,n)=>{n.d(t,{A:()=>r});const r=n.p+"assets/images/search-traces-inputs-on-ui-4f7e2a743c22391ec9bb20939949557e.png"}}]);