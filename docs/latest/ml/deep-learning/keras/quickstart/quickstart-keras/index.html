<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-classic-ml docs-version-current docs-doc-page docs-doc-id-deep-learning/keras/quickstart/quickstart-keras-ipynb" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Get Started with Keras 3.0 + MLflow | MLflow</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mlflow.org/mlflow-website/docs/latest/ml/deep-learning/keras/quickstart/quickstart-keras/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-classic-ml-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-classic-ml-current"><meta data-rh="true" property="og:title" content="Get Started with Keras 3.0 + MLflow | MLflow"><meta data-rh="true" name="description" content="Download this notebook"><meta data-rh="true" property="og:description" content="Download this notebook"><link data-rh="true" rel="icon" href="/mlflow-website/docs/latest/images/favicon.ico"><link data-rh="true" rel="canonical" href="https://mlflow.org/mlflow-website/docs/latest/ml/deep-learning/keras/quickstart/quickstart-keras/"><link data-rh="true" rel="alternate" href="https://mlflow.org/mlflow-website/docs/latest/ml/deep-learning/keras/quickstart/quickstart-keras/" hreflang="en"><link data-rh="true" rel="alternate" href="https://mlflow.org/mlflow-website/docs/latest/ml/deep-learning/keras/quickstart/quickstart-keras/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://XKVLO8P882-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Deep Learning","item":"https://mlflow.org/mlflow-website/docs/latest/ml/deep-learning/"},{"@type":"ListItem","position":2,"name":"Keras","item":"https://mlflow.org/mlflow-website/docs/latest/ml/deep-learning/keras/"},{"@type":"ListItem","position":3,"name":"Quickstart","item":"https://mlflow.org/mlflow-website/docs/latest/ml/deep-learning/keras/quickstart/quickstart-keras"}]}</script><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=GTM-N6WMTTJ"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","GTM-N6WMTTJ",{anonymize_ip:!0}),gtag("config","AW-16857946923",{anonymize_ip:!0})</script>
<link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var g=t.getElementsByTagName(a)[0],m=t.createElement(a);m.async=!0,m.src="https://www.googletagmanager.com/gtm.js?id=GTM-N6WMTTJ",g.parentNode.insertBefore(m,g)}(window,document,"script","dataLayer")</script>



<link rel="search" type="application/opensearchdescription+xml" title="MLflow" href="/mlflow-website/docs/latest/opensearch.xml">






<script src="/mlflow-website/docs/latest/js/runllm.js" defer="defer"></script><link rel="stylesheet" href="/mlflow-website/docs/latest/assets/css/styles.ef026542.css">
<script src="/mlflow-website/docs/latest/assets/js/runtime~main.59433d39.js" defer="defer"></script>
<script src="/mlflow-website/docs/latest/assets/js/main.5f13b89b.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-N6WMTTJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>


<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/mlflow-website/docs/latest/"><div class="navbar__logo"><img src="/mlflow-website/docs/latest/images/logo-light.svg" alt="MLflow Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/mlflow-website/docs/latest/images/logo-dark.svg" alt="MLflow Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link docsDropdown_VGp6" data-active="ml"><div style="display:flex;gap:8px;align-items:center"><div class="dropdownCircle_n91F" style="width:10px;height:10px;background-color:var(--ml-color-primary);border-radius:4px"></div>ML Docs</div></a><ul class="dropdown__menu"><li><a aria-current="page" class="dropdown__link ml-docs-link dropdown__link--active" href="/mlflow-website/docs/latest/ml/"><div style="display:flex;gap:8px;align-items:center"><div style="width:10px;height:10px;background-color:var(--ml-color-primary);border-radius:4px"></div>ML Docs</div></a></li><li><a class="dropdown__link genai-docs-link" href="/mlflow-website/docs/latest/genai/"><div style="display:flex;gap:8px;align-items:center"><div style="width:10px;height:10px;background-color:var(--genai-color-primary);border-radius:4px"></div>GenAI Docs</div></a></li></ul></div><a href="https://mlflow.org/docs/latest/api_reference/index.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API Reference</a><a class="navbar__item navbar__link" href="/mlflow-website/docs/latest/community/">Community</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/mlflow/mlflow" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link github-link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Command+K)"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20" aria-hidden="true"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-top-level-category"><a class="menu__link" href="/mlflow-website/docs/latest/ml/">MLflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a href="https://mlflow.org/docs/latest/genai/mlflow-3" target="_blank" rel="noopener noreferrer" class="menu__link menuExternalLink_NmtK">MLflow 3.0<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/mlflow-website/docs/latest/ml/getting-started/">Getting Started</a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item sidebar-top-level-category"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" href="/mlflow-website/docs/latest/ml/traditional-ml/">Machine Learning</a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/mlflow-website/docs/latest/ml/traditional-ml/">Traditional ML</a><button aria-label="Expand sidebar category &#x27;Traditional ML&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/mlflow-website/docs/latest/ml/deep-learning/">Deep Learning</a><button aria-label="Collapse sidebar category &#x27;Deep Learning&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/mlflow-website/docs/latest/ml/deep-learning/keras/">Keras</a><button aria-label="Collapse sidebar category &#x27;Keras&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/mlflow-website/docs/latest/ml/deep-learning/keras/quickstart/quickstart-keras/">Quickstart</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/mlflow-website/docs/latest/ml/deep-learning/keras/guide/">Keras within MLflow</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/mlflow-website/docs/latest/ml/deep-learning/pytorch/">PyTorch</a><button aria-label="Expand sidebar category &#x27;PyTorch&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/mlflow-website/docs/latest/ml/deep-learning/tensorflow/">TensorFlow</a><button aria-label="Expand sidebar category &#x27;TensorFlow&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/mlflow-website/docs/latest/ml/deep-learning/transformers/">Transformers</a><button aria-label="Expand sidebar category &#x27;Transformers&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/mlflow-website/docs/latest/ml/deep-learning/sentence-transformers/">Sentence Transformers</a><button aria-label="Expand sidebar category &#x27;Sentence Transformers&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/mlflow-website/docs/latest/ml/deep-learning/spacy/">spaCy</a><button aria-label="Expand sidebar category &#x27;spaCy&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item sidebar-top-level-category"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="true" href="/mlflow-website/docs/latest/ml/tracking/">Build </a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" tabindex="0" href="/mlflow-website/docs/latest/ml/tracking/">MLflow Tracking</a><button aria-label="Expand sidebar category &#x27;MLflow Tracking&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/mlflow-website/docs/latest/ml/model/">MLflow Model</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mlflow-website/docs/latest/ml/dataset/">MLflow Datasets</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/mlflow-website/docs/latest/ml/evaluation/">Evaluate</a><button aria-label="Expand sidebar category &#x27;Evaluate&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/mlflow-website/docs/latest/ml/model-registry/">Deploy</a></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/mlflow-website/docs/latest/ml/webhooks/">Webhooks</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/mlflow-website/docs/latest/ml/tracking/#tracking-setup">Team Collaboration</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class="menu__list-item-collapsible"><a href="https://mlflow.org/docs/latest/api_reference/python_api/index.html" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false">API References</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class="menu__list-item-collapsible"><a href="https://github.com/mlflow/mlflow/blob/master/CONTRIBUTING.md" target="_blank" rel="noopener noreferrer" class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false">More</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/mlflow-website/docs/latest/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Machine Learning</span></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/mlflow-website/docs/latest/ml/deep-learning/"><span>Deep Learning</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/mlflow-website/docs/latest/ml/deep-learning/keras/"><span>Keras</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Quickstart</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Get Started with Keras 3.0 + MLflow</h1></header>
<a class="button button--primary" style="margin-bottom:1rem;display:block;width:min-content" href="https://raw.githubusercontent.com/mlflow/mlflow/master/docs/docs/classic-ml/deep-learning/keras/quickstart/quickstart-keras.ipynb" download="">Download this notebook</a>
<p>This tutorial is an end-to-end tutorial on training a MINST classifier with <strong>Keras 3.0</strong> and logging results with <strong>MLflow</strong>. It will demonstrate the use of <code>mlflow.keras.MlflowCallback</code>, and how to subclass it to implement custom logging logic.</p>
<p><strong>Keras</strong> is a high-level api that is designed to be simple, flexible, and powerful - allowing everyone from beginners to advanced users to quickly build, train, and evaluate models. <strong>Keras 3.0</strong>, or Keras Core, is a full rewrite of the Keras codebase that rebases it on top of a modular backend architecture. It makes it possible to run Keras workflows on top of arbitrary frameworks — starting with TensorFlow, JAX, and PyTorch.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="install-packages">Install Packages<a href="#install-packages" class="hash-link" aria-label="Direct link to Install Packages" title="Direct link to Install Packages">​</a></h2>
<p><code>pip install -q keras mlflow jax jaxlib torch tensorflow</code></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="import-packages--configure-backend">Import Packages / Configure Backend<a href="#import-packages--configure-backend" class="hash-link" aria-label="Direct link to Import Packages / Configure Backend" title="Direct link to Import Packages / Configure Backend">​</a></h2>
<p>Keras 3.0 is inherently multi-backend, so you will need to set the backend environment variable <strong>before</strong> importing the package.</p>
<div style="flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%"><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># You can use &#x27;tensorflow&#x27;, &#x27;torch&#x27; or &#x27;jax&#x27; as backend. Make sure to set the environment variable before importing.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;KERAS_BACKEND&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;tensorflow&quot;</span><br></span></code></pre></div></div></div>
<div style="flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%"><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> keras</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> np</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> mlflow</span><br></span></code></pre></div></div></div>
<pre style="margin:0;border-radius:0;background:none;font-size:0.85rem;flex-grow:1;padding:var(--padding-sm)">Using TensorFlow backend</pre>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="load-dataset">Load Dataset<a href="#load-dataset" class="hash-link" aria-label="Direct link to Load Dataset" title="Direct link to Load Dataset">​</a></h2>
<p>We will use the MNIST dataset. This is a dataset of handwritten digits and will be used for an image classification task. There are 10 classes corresponding to the 10 digits.</p>
<div style="flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%"><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">x_train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">x_test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> y_test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">datasets</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">mnist</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">load_data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">x_train </span><span class="token operator">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">expand_dims</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">x_train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> axis</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">x_test </span><span class="token operator">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">expand_dims</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">x_test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> axis</span><span class="token operator">=</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">x_train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">shape</span><br></span></code></pre></div></div></div>
<pre style="margin:0;border-radius:0;background:none;font-size:0.85rem;flex-grow:1;padding:var(--padding-sm)">(28, 28, 1)</pre>
<div style="flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%"><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token comment" style="color:rgb(98, 114, 164)"># Visualize Dataset</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> matplotlib</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pyplot </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> plt</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">grid </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">fig</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> axes </span><span class="token operator">=</span><span class="token plain"> plt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">subplots</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">grid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> grid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> figsize</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">6</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">6</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> i </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">range</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">grid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> j </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">range</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">grid</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      axes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">j</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">imshow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">x_train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">i </span><span class="token operator">*</span><span class="token plain"> grid </span><span class="token operator">+</span><span class="token plain"> j</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      axes</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">i</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">j</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">set_title</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;label=</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">y_train</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string-interpolation interpolation">i </span><span class="token string-interpolation interpolation operator">*</span><span class="token string-interpolation interpolation"> grid </span><span class="token string-interpolation interpolation operator">+</span><span class="token string-interpolation interpolation"> j</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">plt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">tight_layout</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div></div>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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t+6kuQQCAX3xxRdNyjspKUkxMTEtft3AP/NSHVRXV+vYsWOqqKjQ888/r7/85S+aOXNm834g6LC8VAueY9AkK1euNJLM/v37jTHGHD161JozZ84c07lzZ1NTUxOMTZw40Ugyv/3tb4Ox2tpaM2LECNO7d29TV1dnjDHmiSeeMFFRUeb11193HHPFihVGknnzzTeDsX79+plZs2YFx/v37zeSmnTLz88P+frefvttI8msXLmymT8ZdCReroM5c+YE74+KijIzZswwX3zxRUt+TOgAvFwLxnjrdwJndFooPj4++P+rqqpUW1urc845R4888oj27NnjWMjVqVMnzZkzJziOjY3VnDlzNHfuXBUWFmrs2LFas2aNhgwZosGDB+vIkSPBueedd54kKT8/X+PGjQuZS2pqql555ZUm5e2lBWaIPC/Vwfz58zVjxgyVlJTomWeeUUNDg+rq6pp0PMBLteA1NDot9P777+u2227Tpk2bVFlZ6bivoqLCMU5LS1OXLl0csUGDBkmSDhw4oLFjx2rfvn3avXu3evXqFfL5Dh06dNJc4uLilJOT05KXAZwWL9XB4MGDNXjwYEnSVVddpcmTJ+viiy/Wtm3b5PP5WnxcdAxeqgWvodFpgfLyck2cOFGJiYlaunSpBgwYoLi4OO3YsUO33nqrAoFAs48ZCAR01lln6d577w15f3p6+kkf29DQoMOHDzfpeZKTkxUbG9vs/IATeb0OZsyYoTlz5mjv3r369re/3aTjomPyei20dzQ6LfDaa6/p888/13PPPacJEyYE4/v37w85v6SkRNXV1Y4Ofu/evZIad7SUpAEDBuidd97R+eef3+y/HouLi5WZmdmkufn5+Zo0aVKzjg+E4vU6OHbsmCT7r3HgRF6vhfaORqcFoqOjJUnGmGCsrq5ODz/8cMj5x48f1yOPPKIFCxYE5z7yyCPq1auXsrKyJEmXX365XnrpJf3+97+39u04duyYAoGAdarza3wei0jwSh0cOnRIvXv3dtxfX1+vxx9/XPHx8frOd77TpGOi4/JKLXgVjU4LjBs3Tt27d9esWbN04403yufz6YknnnC8yf9ZWlqa7rrrLh04cECDBg3S6tWrtWvXLj366KPBy/p++tOf6plnntF1112n/Px8jR8/Xg0NDdqzZ4+eeeYZvfzyyxo5cmTI45/O57EPPfSQysvL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" alt="" class="img_ev3q"></p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="build-model">Build Model<a href="#build-model" class="hash-link" aria-label="Direct link to Build Model" title="Direct link to Build Model">​</a></h2>
<p>We will use the Keras 3.0 sequential API to build a simple CNN.</p>
<div style="flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%"><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">NUM_CLASSES </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">10</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">INPUT_SHAPE </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">initialize_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Sequential</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Input</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">shape</span><span class="token operator">=</span><span class="token plain">INPUT_SHAPE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Conv2D</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> kernel_size</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> activation</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;relu&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Conv2D</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> kernel_size</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> activation</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;relu&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Conv2D</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">32</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> kernel_size</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> activation</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;relu&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">GlobalAveragePooling2D</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">layers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Dense</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">NUM_CLASSES</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> activation</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;softmax&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">model </span><span class="token operator">=</span><span class="token plain"> initialize_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">summary</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div></div>
<div style="flex-grow:1;min-width:0;font-size:0.8rem;width:100%"><div><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold">Model: "sequential"</span>
</pre>
</div></div>
<div style="flex-grow:1;min-width:0;font-size:0.8rem;width:100%"><div><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace">┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━┓
┃<span style="font-weight: bold"> Layer (type)                    </span>┃<span style="font-weight: bold"> Output Shape              </span>┃<span style="font-weight: bold">    Param # </span>┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━┩
│ conv2d (<span style="color: #0087ff; text-decoration-color: #0087ff">Conv2D</span>)                 │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">26</span>, <span style="color: #00af00; text-decoration-color: #00af00">26</span>, <span style="color: #00af00; text-decoration-color: #00af00">32</span>)        │        <span style="color: #00af00; text-decoration-color: #00af00">320</span> │
├─────────────────────────────────┼───────────────────────────┼────────────┤
│ conv2d_1 (<span style="color: #0087ff; text-decoration-color: #0087ff">Conv2D</span>)               │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">24</span>, <span style="color: #00af00; text-decoration-color: #00af00">24</span>, <span style="color: #00af00; text-decoration-color: #00af00">32</span>)        │      <span style="color: #00af00; text-decoration-color: #00af00">9,248</span> │
├─────────────────────────────────┼───────────────────────────┼────────────┤
│ conv2d_2 (<span style="color: #0087ff; text-decoration-color: #0087ff">Conv2D</span>)               │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">22</span>, <span style="color: #00af00; text-decoration-color: #00af00">22</span>, <span style="color: #00af00; text-decoration-color: #00af00">32</span>)        │      <span style="color: #00af00; text-decoration-color: #00af00">9,248</span> │
├─────────────────────────────────┼───────────────────────────┼────────────┤
│ global_average_pooling2d        │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">32</span>)                │          <span style="color: #00af00; text-decoration-color: #00af00">0</span> │
│ (<span style="color: #0087ff; text-decoration-color: #0087ff">GlobalAveragePooling2D</span>)        │                           │            │
├─────────────────────────────────┼───────────────────────────┼────────────┤
│ dense (<span style="color: #0087ff; text-decoration-color: #0087ff">Dense</span>)                   │ (<span style="color: #00d7ff; text-decoration-color: #00d7ff">None</span>, <span style="color: #00af00; text-decoration-color: #00af00">10</span>)                │        <span style="color: #00af00; text-decoration-color: #00af00">330</span> │
└─────────────────────────────────┴───────────────────────────┴────────────┘
</pre>
</div></div>
<div style="flex-grow:1;min-width:0;font-size:0.8rem;width:100%"><div><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Total params: </span><span style="color: #00af00; text-decoration-color: #00af00">19,146</span> (74.79 KB)
</pre>
</div></div>
<div style="flex-grow:1;min-width:0;font-size:0.8rem;width:100%"><div><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">19,146</span> (74.79 KB)
</pre>
</div></div>
<div style="flex-grow:1;min-width:0;font-size:0.8rem;width:100%"><div><pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="font-weight: bold"> Non-trainable params: </span><span style="color: #00af00; text-decoration-color: #00af00">0</span> (0.00 B)
</pre>
</div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="train-model-default-callback">Train Model (Default Callback)<a href="#train-model-default-callback" class="hash-link" aria-label="Direct link to Train Model (Default Callback)" title="Direct link to Train Model (Default Callback)">​</a></h2>
<p>We will fit the model on the dataset, using MLflow&#x27;s <code>mlflow.keras.MlflowCallback</code> to log metrics during training.</p>
<div style="flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%"><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">BATCH_SIZE </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">64</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># adjust this based on the memory of your machine</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">EPOCHS </span><span class="token operator">=</span><span class="token plain"> </span><span class="token number">3</span><br></span></code></pre></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="log-per-epoch">Log Per Epoch<a href="#log-per-epoch" class="hash-link" aria-label="Direct link to Log Per Epoch" title="Direct link to Log Per Epoch">​</a></h3>
<p>An epoch defined as one pass through the entire training dataset.</p>
<div style="flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%"><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">model </span><span class="token operator">=</span><span class="token plain"> initialize_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">compile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  loss</span><span class="token operator">=</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">losses</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">SparseCategoricalCrossentropy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  optimizer</span><span class="token operator">=</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">optimizers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Adam</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  metrics</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;accuracy&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">run </span><span class="token operator">=</span><span class="token plain"> mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">start_run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  x_train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  y_train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  batch_size</span><span class="token operator">=</span><span class="token plain">BATCH_SIZE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  epochs</span><span class="token operator">=</span><span class="token plain">EPOCHS</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  validation_split</span><span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  callbacks</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">MlflowCallback</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">end_run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div></div>
<pre style="margin:0;border-radius:0;background:none;font-size:0.85rem;flex-grow:1;padding:var(--padding-sm)">Epoch 1/3
[1m844/844[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m30s[0m 34ms/step - accuracy: 0.5922 - loss: 1.2862 - val_accuracy: 0.9427 - val_loss: 0.2075
Epoch 2/3
[1m844/844[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m28s[0m 33ms/step - accuracy: 0.9330 - loss: 0.2286 - val_accuracy: 0.9348 - val_loss: 0.2020
Epoch 3/3
[1m844/844[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m28s[0m 33ms/step - accuracy: 0.9499 - loss: 0.1671 - val_accuracy: 0.9558 - val_loss: 0.1491</pre>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="log-results">Log Results<a href="#log-results" class="hash-link" aria-label="Direct link to Log Results" title="Direct link to Log Results">​</a></h3>
<p>The callback for the run would log <strong>parameters</strong>, <strong>metrics</strong> and <strong>artifacts</strong> to MLflow dashboard.</p>
<p><img decoding="async" loading="lazy" src="https://i.imgur.com/YLGFDJEl.png" alt="run page" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="log-per-batch">Log Per Batch<a href="#log-per-batch" class="hash-link" aria-label="Direct link to Log Per Batch" title="Direct link to Log Per Batch">​</a></h3>
<p>Within each epoch, the training dataset is broken down to batches based on the defined <code>BATCH_SIZE</code>. If we set the callback to not log based on epochs with <code>log_every_epoch=False</code>, and to log every 5 batches with <code>log_every_n_steps=5</code>, we can adjust the logging to be based on the batches.</p>
<div style="flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%"><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">model </span><span class="token operator">=</span><span class="token plain"> initialize_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">compile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  loss</span><span class="token operator">=</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">losses</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">SparseCategoricalCrossentropy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  optimizer</span><span class="token operator">=</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">optimizers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Adam</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  metrics</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;accuracy&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">with</span><span class="token plain"> mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">start_run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      x_train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      y_train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      batch_size</span><span class="token operator">=</span><span class="token plain">BATCH_SIZE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      epochs</span><span class="token operator">=</span><span class="token plain">EPOCHS</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      validation_split</span><span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      callbacks</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">MlflowCallback</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> log_every_epoch</span><span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> log_every_n_steps</span><span class="token operator">=</span><span class="token number">5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div></div>
<pre style="margin:0;border-radius:0;background:none;font-size:0.85rem;flex-grow:1;padding:var(--padding-sm)">Epoch 1/3
[1m844/844[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m30s[0m 34ms/step - accuracy: 0.6151 - loss: 1.2100 - val_accuracy: 0.9373 - val_loss: 0.2144
Epoch 2/3
[1m844/844[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m29s[0m 34ms/step - accuracy: 0.9274 - loss: 0.2459 - val_accuracy: 0.9608 - val_loss: 0.1338
Epoch 3/3
[1m844/844[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m28s[0m 34ms/step - accuracy: 0.9477 - loss: 0.1738 - val_accuracy: 0.9577 - val_loss: 0.1454</pre>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="log-results-1">Log Results<a href="#log-results-1" class="hash-link" aria-label="Direct link to Log Results" title="Direct link to Log Results">​</a></h3>
<p>If we <strong>log per epoch</strong>, we will only have three datapoints, since there are only 3 epochs:</p>
<p><img decoding="async" loading="lazy" src="https://i.imgur.com/rFDj8SHl.png" alt="log per epoch" class="img_ev3q"></p>
<p>By <strong>logging per batch</strong>, we can get more datapoints, but they can be noisier:</p>
<p><img decoding="async" loading="lazy" src="https://i.imgur.com/ZCYXLqll.png" alt="log per batch" class="img_ev3q"></p>
<div style="flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%"><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">class</span><span class="token plain"> </span><span class="token class-name">MlflowCallbackLogPerBatch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">MlflowCallback</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">on_batch_end</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> batch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> logs</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">log_every_n_steps </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">is</span><span class="token plain"> </span><span class="token boolean">None</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">or</span><span class="token plain"> logs </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">is</span><span class="token plain"> </span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">batch </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">%</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">log_every_n_steps </span><span class="token operator">==</span><span class="token plain"> </span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">metrics_logger</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">record_metrics</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">logs</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">_log_step</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">_log_step </span><span class="token operator">+=</span><span class="token plain"> self</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">log_every_n_steps</span><br></span></code></pre></div></div></div>
<div style="flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%"><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">model </span><span class="token operator">=</span><span class="token plain"> initialize_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token builtin" style="color:rgb(189, 147, 249)">compile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  loss</span><span class="token operator">=</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">losses</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">SparseCategoricalCrossentropy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  optimizer</span><span class="token operator">=</span><span class="token plain">keras</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">optimizers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">Adam</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  metrics</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;accuracy&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">with</span><span class="token plain"> mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">start_run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      x_train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      y_train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      batch_size</span><span class="token operator">=</span><span class="token plain">BATCH_SIZE</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      epochs</span><span class="token operator">=</span><span class="token plain">EPOCHS</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      validation_split</span><span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      callbacks</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">MlflowCallbackLogPerBatch</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> log_every_epoch</span><span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> log_every_n_steps</span><span class="token operator">=</span><span class="token number">5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div></div>
<pre style="margin:0;border-radius:0;background:none;font-size:0.85rem;flex-grow:1;padding:var(--padding-sm)">Epoch 1/3
[1m844/844[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m29s[0m 34ms/step - accuracy: 0.5645 - loss: 1.4105 - val_accuracy: 0.9187 - val_loss: 0.2826
Epoch 2/3
[1m844/844[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m29s[0m 34ms/step - accuracy: 0.9257 - loss: 0.2615 - val_accuracy: 0.9602 - val_loss: 0.1368
Epoch 3/3
[1m844/844[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m29s[0m 34ms/step - accuracy: 0.9456 - loss: 0.1800 - val_accuracy: 0.9678 - val_loss: 0.1037</pre>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="evaluation">Evaluation<a href="#evaluation" class="hash-link" aria-label="Direct link to Evaluation" title="Direct link to Evaluation">​</a></h2>
<p>Similar to training, you can use the callback to log the evaluation result.</p>
<div style="flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%"><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">with</span><span class="token plain"> mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">start_run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">evaluate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">x_test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> y_test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> callbacks</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">keras_core</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">MlflowCallback</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div></div>
<pre style="margin:0;border-radius:0;background:none;font-size:0.85rem;flex-grow:1;padding:var(--padding-sm)">[1m313/313[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m1s[0m 4ms/step - accuracy: 0.9541 - loss: 0.1487</pre></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/mlflow/mlflow/edit/master/docs/docs/classic-ml/deep-learning/keras/quickstart/quickstart-keras.ipynb" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/mlflow-website/docs/latest/ml/deep-learning/keras/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Keras</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/mlflow-website/docs/latest/ml/deep-learning/keras/guide/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Keras within MLflow</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#install-packages" class="table-of-contents__link toc-highlight">Install Packages</a></li><li><a href="#import-packages--configure-backend" class="table-of-contents__link toc-highlight">Import Packages / Configure Backend</a></li><li><a href="#load-dataset" class="table-of-contents__link toc-highlight">Load Dataset</a></li><li><a href="#build-model" class="table-of-contents__link toc-highlight">Build Model</a></li><li><a href="#train-model-default-callback" class="table-of-contents__link toc-highlight">Train Model (Default Callback)</a><ul><li><a href="#log-per-epoch" class="table-of-contents__link toc-highlight">Log Per Epoch</a></li><li><a href="#log-results" class="table-of-contents__link toc-highlight">Log Results</a></li><li><a href="#log-per-batch" class="table-of-contents__link toc-highlight">Log Per Batch</a></li><li><a href="#log-results-1" class="table-of-contents__link toc-highlight">Log Results</a></li></ul></li><li><a href="#evaluation" class="table-of-contents__link toc-highlight">Evaluation</a></li></ul></div></div></div></div></main></div></div></div><footer class="relative pb-30 flex flex-col pt-30 bg-bottom bg-no-repeat bg-cover bg-size-[auto_360px] 2xl:bg-size-[100%_360px] bg-brand-black"><div style="position:absolute;width:100%;bottom:0;pointer-events:none;mask-composite:intersect;height:360px;background-image:repeating-linear-gradient(
        to right,
        rgba(0, 0, 0, 0.05),
        rgba(0, 0, 0, 0.25) 18px,
        transparent 2px,
        transparent 10px
      ),
      radial-gradient(
        circle at bottom center,
        oklch(0.7533 0.11 216.4) 0%,
        transparent 60%
      ),
      linear-gradient(to right, color-mix(in srgb, oklch(0.7533 0.11 216.4), navy 40%), color-mix(in srgb, oklch(0.7533 0.11 216.4), teal 40%));mask-image:radial-gradient(ellipse at center bottom, black 60%, transparent 80%),
      linear-gradient(to top, black 10%, transparent 40%)"></div><div class="z-1"><div class="flex flex-row justify-between items-start md:items-center px-6 lg:px-20 gap-10 xs:gap-0 max-w-container"><div class="flex flex-col gap-8"><svg xmlns="http://www.w3.org/2000/svg" width="109" height="40" fill="none" viewBox="0 0 109 40" class="h-[36px] shrink-0"><path fill="#fff" d="M0 31.032v-15.53h3.543v1.968c.893-1.594 2.84-2.425 4.593-2.425 2.042 0 3.828.926 4.658 2.745 1.216-2.043 3.034-2.745 5.043-2.745 2.81 0 5.49 1.787 5.49 5.904v10.083h-3.574v-9.478c0-1.818-.926-3.19-3-3.19-1.947 0-3.224 1.53-3.224 3.445v9.22H9.893v-9.475c0-1.786-.898-3.18-3.003-3.18-1.977 0-3.223 1.467-3.223 3.444v9.221ZM27.855 31.032V7.929h3.703v23.103ZM30.07 39.487c.833.232 1.582.383 3.17.383 2.953 0 6.436-1.665 7.353-6.339l3.786-18.739h5.629l.687-3.117h-5.686l.765-3.725c.586-2.892 2.186-4.358 4.754-4.358.668 0 .48.058 1.076.17L52.427.57c-.793-.237-1.503-.379-3.049-.379a7.32 7.32 0 0 0-4.528 1.484c-1.441 1.114-2.393 2.75-2.827 4.863l-1.066 5.137h-5.034l-.411 3.12h4.823L36.859 32.12c-.383 1.965-1.5 4.315-4.708 4.315-.727 0-.463-.055-1.121-.162ZM53.342 30.905H49.64l5.074-23.309h3.701ZM71.807 16.477A7.962 7.962 0 0 0 60.97 27.904l2.425-1.78a5.005 5.005 0 0 1 3.845-8.145v1.895ZM62.618 29.472a7.962 7.962 0 0 0 10.836-11.428l-2.425 1.78a5.005 5.005 0 0 1-3.845 8.145v-1.894ZM78.092 15.493h4.044l.823 10.612 5.759-10.612 3.839.055 1.508 10.557 5.074-10.612 3.701.055-7.678 15.493H91.46l-1.783-11.106-5.895 11.106h-3.84ZM105.072 15.768h-.766v-.266h1.845v.272h-.765v2.243h-.314ZM106.614 15.502h.383l.482 1.34q.091.259.178.524h.018c.059-.176.113-.352.172-.524l.478-1.34h.383v2.515h-.298V16.63c0-.22.024-.523.04-.747h-.016l-.191.574-.475 1.304h-.208l-.481-1.302-.191-.574h-.015c.017.224.042.527.042.747v1.387h-.291Z"></path></svg><div class="text-xs text-left md:text-nowrap md:w-0">© 2025 MLflow Project, a Series of LF Projects, LLC.</div></div><div class="flex flex-col flex-wrap justify-end md:text-right md:flex-row gap-x-10 lg:gap-x-20 gap-y-5 w-2/5 md:w-auto md:pt-2 max-w-fit"><div><a href="https://mlflow.org" target="_blank" rel="noopener noreferrer" class="text-[15px] font-medium no-underline hover:no-underline transition-opacity hover:opacity-80 text-white visited:text-white">Components</a></div><div><a href="https://mlflow.org/releases" target="_blank" rel="noopener noreferrer" class="text-[15px] font-medium no-underline hover:no-underline transition-opacity hover:opacity-80 text-white visited:text-white">Releases</a></div><div><a href="https://mlflow.org/blog" target="_blank" rel="noopener noreferrer" class="text-[15px] font-medium no-underline hover:no-underline transition-opacity hover:opacity-80 text-white visited:text-white">Blog</a></div><div><a class="text-[15px] font-medium no-underline hover:no-underline transition-opacity hover:opacity-80 text-white visited:text-white" href="/mlflow-website/docs/latest/">Docs</a></div><div><a href="https://mlflow.org/ambassadors" target="_blank" rel="noopener noreferrer" class="text-[15px] font-medium no-underline hover:no-underline transition-opacity hover:opacity-80 text-white visited:text-white">Ambassador Program</a></div></div></div></div></footer></div>
</body>
</html>