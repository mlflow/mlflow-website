<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-classic-ml docs-version-current docs-doc-page docs-doc-id-deployment/deploy-model-to-kubernetes/tutorial" data-has-hydrated=false><head><meta charset=UTF-8><meta name=generator content="Docusaurus v3.9.2"><title data-rh=true>Develop ML model with MLflow and deploy to Kubernetes | MLflow</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"/><meta data-rh=true name=twitter:card content=summary_large_image /><meta data-rh=true property=og:url content=https://mlflow.org/mlflow-website/docs/latest/ml/deployment/deploy-model-to-kubernetes/tutorial/ /><meta data-rh=true property=og:locale content=en /><meta data-rh=true name=docusaurus_locale content=en /><meta data-rh=true name=docsearch:language content=en /><meta data-rh=true name=docusaurus_version content=current /><meta data-rh=true name=docusaurus_tag content=docs-classic-ml-current /><meta data-rh=true name=docsearch:version content=current /><meta data-rh=true name=docsearch:docusaurus_tag content=docs-classic-ml-current /><meta data-rh=true property=og:title content="Develop ML model with MLflow and deploy to Kubernetes | MLflow"/><meta data-rh=true name=description content="This tutorial assumes that you have access to a Kubernetes cluster. However, you can also complete this tutorial on your local machine"/><meta data-rh=true property=og:description content="This tutorial assumes that you have access to a Kubernetes cluster. However, you can also complete this tutorial on your local machine"/><link data-rh=true rel=icon href=/mlflow-website/docs/latest/images/favicon.ico /><link data-rh=true rel=canonical href=https://mlflow.org/mlflow-website/docs/latest/ml/deployment/deploy-model-to-kubernetes/tutorial/ /><link data-rh=true rel=alternate href=https://mlflow.org/mlflow-website/docs/latest/ml/deployment/deploy-model-to-kubernetes/tutorial/ hreflang=en /><link data-rh=true rel=alternate href=https://mlflow.org/mlflow-website/docs/latest/ml/deployment/deploy-model-to-kubernetes/tutorial/ hreflang=x-default /><link data-rh=true rel=preconnect href=https://XKVLO8P882-dsn.algolia.net crossorigin=anonymous /><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://mlflow.org/mlflow-website/docs/latest/ml/deployment/","name":"MLflow Serving","position":1},{"@type":"ListItem","item":"https://mlflow.org/mlflow-website/docs/latest/ml/deployment/deploy-model-to-kubernetes/","name":"Deploy MLflow Model to Kubernetes","position":2},{"@type":"ListItem","item":"https://mlflow.org/mlflow-website/docs/latest/ml/deployment/deploy-model-to-kubernetes/tutorial","name":"Develop ML model with MLflow and deploy to Kubernetes","position":3}]}</script><link rel=preconnect href=https://www.google-analytics.com><link rel=preconnect href=https://www.googletagmanager.com><script async src="https://www.googletagmanager.com/gtag/js?id=GTM-N6WMTTJ"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","GTM-N6WMTTJ",{anonymize_ip:!0}),gtag("config","AW-16857946923",{anonymize_ip:!0})</script><link rel=preconnect href=https://www.googletagmanager.com><script>window.dataLayer=window.dataLayer||[],function(e,t,a,n,r){e[n]=e[n]||[],e[n].push({"gtm.start":new Date().getTime(),event:"gtm.js"});var d=t.getElementsByTagName(a)[0],g=t.createElement(a);g.async=!0,g.src="https://www.googletagmanager.com/gtm.js?id="+r+("dataLayer"!=n?"&l="+n:""),d.parentNode.insertBefore(g,d)}(window,document,"script","dataLayer","GTM-N6WMTTJ")</script><link rel=search type=application/opensearchdescription+xml title=MLflow href=/mlflow-website/docs/latest/opensearch.xml><script src=/mlflow-website/docs/latest/js/runllm.js defer></script><link rel=stylesheet href=/mlflow-website/docs/latest/assets/css/styles.65681509.css /><script src=/mlflow-website/docs/latest/assets/js/runtime~main.a0db6d66.js defer></script><script src=/mlflow-website/docs/latest/assets/js/main.5d15b684.js defer></script></head><body class=navigation-with-keyboard><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-N6WMTTJ" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript>


<svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/mlflow-website/docs/latest/><div class=navbar__logo><img src=/mlflow-website/docs/latest/images/logo-light.svg alt="MLflow Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"/><img src=/mlflow-website/docs/latest/images/logo-dark.svg alt="MLflow Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"/></div></a><div class="navbar__item dropdown dropdown--hoverable"><a href=# aria-haspopup=true aria-expanded=false role=button class="navbar__link docsDropdown_VGp6" data-active=ml><div style=display:flex;gap:8px;align-items:center><div class=dropdownCircle_n91F style=width:10px;height:10px;background-color:var(--ml-color-primary);border-radius:4px></div>ML Docs</div></a><ul class=dropdown__menu><li><a aria-current=page class="dropdown__link ml-docs-link dropdown__link--active" href=/mlflow-website/docs/latest/ml/><div style=display:flex;gap:8px;align-items:center><div style=width:10px;height:10px;background-color:var(--ml-color-primary);border-radius:4px></div>ML Docs</div></a><li><a class="dropdown__link genai-docs-link" href=/mlflow-website/docs/latest/genai/><div style=display:flex;gap:8px;align-items:center><div style=width:10px;height:10px;background-color:var(--genai-color-primary);border-radius:4px></div>GenAI Docs</div></a></ul></div><a href=https://mlflow.org/docs/latest/api_reference/index.html target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">API Reference</a><a class="navbar__item navbar__link" href=/mlflow-website/docs/latest/self-hosting/>Self-Hosting</a><a class="navbar__item navbar__link" href=/mlflow-website/docs/latest/community/>Community</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href=https://github.com/mlflow/mlflow target=_blank rel="noopener noreferrer" class="navbar__item navbar__link github-link">GitHub<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts=Meta+k><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 24 24" aria-hidden=true><circle cx=11 cy=11 r=8 stroke=currentColor fill=none stroke-width=1.4 /><path d="m21 21-4.3-4.3" stroke=currentColor fill=none stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-top-level-category"><a class=menu__link href=/mlflow-website/docs/latest/ml/><span title=MLflow class=linkLabel_WmDU>MLflow</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/mlflow-website/docs/latest/ml/getting-started/><span title="Getting Started" class=categoryLinkLabel_W154>Getting Started</span></a><button aria-label="Expand sidebar category 'Getting Started'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item sidebar-top-level-category"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=true href=/mlflow-website/docs/latest/ml/traditional-ml/><span title="Machine Learning" class=categoryLinkLabel_W154>Machine Learning</span></a></div><ul class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex=0 href=/mlflow-website/docs/latest/ml/traditional-ml/><span title="Traditional ML" class=categoryLinkLabel_W154>Traditional ML</span></a><button aria-label="Expand sidebar category 'Traditional ML'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex=0 href=/mlflow-website/docs/latest/ml/deep-learning/><span title="Deep Learning" class=categoryLinkLabel_W154>Deep Learning</span></a><button aria-label="Expand sidebar category 'Deep Learning'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item sidebar-top-level-category"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=true href=/mlflow-website/docs/latest/ml/tracking/><span title="Build " class=categoryLinkLabel_W154>Build </span></a></div><ul class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex=0 href=/mlflow-website/docs/latest/ml/tracking/><span title="MLflow Tracking" class=categoryLinkLabel_W154>MLflow Tracking</span></a><button aria-label="Expand sidebar category 'MLflow Tracking'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false tabindex=0 href=/mlflow-website/docs/latest/ml/model/><span title="MLflow Model" class=categoryLinkLabel_W154>MLflow Model</span></a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/mlflow-website/docs/latest/ml/dataset/><span title="MLflow Datasets" class=linkLabel_WmDU>MLflow Datasets</span></a></ul><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-top-level-category"><a class=menu__link href=/mlflow-website/docs/latest/ml/evaluation/><span title=Evaluate class=linkLabel_WmDU>Evaluate</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item sidebar-top-level-category"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role=button aria-expanded=true href=/mlflow-website/docs/latest/ml/model-registry/><span title=Deploy class=categoryLinkLabel_W154>Deploy</span></a></div><ul class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex=0 href=/mlflow-website/docs/latest/ml/model-registry/><span title="MLflow Model Registry" class=categoryLinkLabel_W154>MLflow Model Registry</span></a><button aria-label="Expand sidebar category 'MLflow Model Registry'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex=0 href=/mlflow-website/docs/latest/ml/deployment/><span title="MLflow Serving" class=categoryLinkLabel_W154>MLflow Serving</span></a><button aria-label="Collapse sidebar category 'MLflow Serving'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/mlflow-website/docs/latest/ml/deployment/deploy-model-locally/><span title="Deploy MLflow Model as a Local Inference Server" class=linkLabel_WmDU>Deploy MLflow Model as a Local Inference Server</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex=0 href=/mlflow-website/docs/latest/ml/deployment/deploy-model-to-kubernetes/><span title="Deploy MLflow Model to Kubernetes" class=categoryLinkLabel_W154>Deploy MLflow Model to Kubernetes</span></a><button aria-label="Collapse sidebar category 'Deploy MLflow Model to Kubernetes'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/mlflow-website/docs/latest/ml/deployment/deploy-model-to-kubernetes/tutorial/><span title="Develop ML model with MLflow and deploy to Kubernetes" class=linkLabel_WmDU>Develop ML model with MLflow and deploy to Kubernetes</span></a></ul><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/mlflow-website/docs/latest/ml/deployment/deploy-model-to-sagemaker/><span title="Deploy MLflow Model to Amazon SageMaker" class=linkLabel_WmDU>Deploy MLflow Model to Amazon SageMaker</span></a></ul><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/mlflow-website/docs/latest/ml/docker/><span title=Docker class=linkLabel_WmDU>Docker</span></a></ul><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class=menu__link href=/mlflow-website/docs/latest/ml/webhooks/><span title=Webhooks class=linkLabel_WmDU>Webhooks</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/mlflow-website/docs/latest/self-hosting/><span title="Team Collaboration" class=categoryLinkLabel_W154>Team Collaboration</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class=menu__list-item-collapsible><a href=https://mlflow.org/docs/latest/api_reference/python_api/index.html target=_blank rel="noopener noreferrer" class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false><span title="API References" class=categoryLinkLabel_W154>API References</span></a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-top-level-category"><a class=menu__link href=/mlflow-website/docs/latest/ml/mlflow-3/><span title="MLflow 3 Migration Guide" class=linkLabel_WmDU>MLflow 3 Migration Guide</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class=menu__list-item-collapsible><a href=https://github.com/mlflow/mlflow/blob/master/CONTRIBUTING.md target=_blank rel="noopener noreferrer" class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false><span title=More class=categoryLinkLabel_W154>More</span></a></div></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><div class=breadcrumbsWrapper_xlkt><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/mlflow-website/docs/latest/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><span class=breadcrumbs__link>Deploy</span><li class=breadcrumbs__item><a class=breadcrumbs__link href=/mlflow-website/docs/latest/ml/deployment/><span>MLflow Serving</span></a><li class=breadcrumbs__item><a class=breadcrumbs__link href=/mlflow-website/docs/latest/ml/deployment/deploy-model-to-kubernetes/><span>Deploy MLflow Model to Kubernetes</span></a><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>Develop ML model with MLflow and deploy to Kubernetes</span></ul></nav></div><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Develop ML model with MLflow and deploy to Kubernetes</h1></header>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>note</div><div class=admonitionContent_BuS1><p>This tutorial assumes that you have access to a Kubernetes cluster. However, you can also complete this tutorial on your local machine
by using local cluster emulation tools such as <a href=https://kind.sigs.k8s.io/docs/user/quick-start target=_blank rel="noopener noreferrer" class="">Kind</a> or <a href=https://minikube.sigs.k8s.io/docs/start target=_blank rel="noopener noreferrer" class="">Minikube</a>.</div></div>
<p>This guide demonstrates how to use MLflow end-to-end for:</p>
<ul>
<li class="">Training a linear regression model with <a class="" href=/mlflow-website/docs/latest/ml/tracking/>MLflow Tracking</a>.</li>
<li class="">Conducting hyper-parameter tuning to find the best model.</li>
<li class="">Packaging the model weights and dependencies as an <a class="" href=/mlflow-website/docs/latest/ml/model/>MLflow Model</a>.</li>
<li class="">Testing model serving locally with <a href=https://mlserver.readthedocs.io/en/latest/ target=_blank rel="noopener noreferrer" class="">mlserver</a> using the <a href=/mlflow-website/docs/latest/api_reference/cli.html#mlflow-models-serve target=_blank>mlflow models serve</a> command.</li>
<li class="">Deploying the model to a Kubernetes cluster using <a href=https://kserve.github.io/website/ target=_blank rel="noopener noreferrer" class="">KServe</a> with MLflow.</li>
</ul>
<p>We will cover an end-to-end model development process including model training and testing within this tutorial.
If you already have a model and simply want to learn how to deploy it to Kubernetes, you can skip to <a href=#step-6-test-model-serving-locally class="">Step 6 - Test Model Serving Locally</a>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=introduction-scalable-model-serving-with-kserve-and-mlserver>Introduction: Scalable Model Serving with KServe and MLServer<a href=#introduction-scalable-model-serving-with-kserve-and-mlserver class=hash-link aria-label="Direct link to Introduction: Scalable Model Serving with KServe and MLServer" title="Direct link to Introduction: Scalable Model Serving with KServe and MLServer" translate=no>​</a></h2>
<p>MLflow provides an easy-to-use interface for deploying models within a FastAPI-based inference server. You can deploy the same inference
server to a Kubernetes cluster by containerizing it using the <code>mlflow models build-docker</code> command. However, this approach may not be scalable
and could be unsuitable for production use cases. FastAPI is not designed for high performance and scale (<a class="" href=/mlflow-website/docs/latest/ml/deployment/deploy-model-locally/#serving-frameworks>why?</a>), and also
manually managing multiple instances of inference servers is backbreaking.</p>
<p>Fortunately, MLflow offers a solution for this. MLflow provides an alternative inference engine that is better suited for larger-scale inference deployments with its support for <a href=https://mlserver.readthedocs.io/en/latest target=_blank rel="noopener noreferrer" class="">MLServer</a>,
which enables one-step deployment to popular serverless model serving frameworks on Kubernetes, such as <a href=https://kserve.github.io/website target=_blank rel="noopener noreferrer" class="">KServe</a>, and
<a href=https://docs.seldon.io/projects/seldon-core/en/latest target=_blank rel="noopener noreferrer" class="">Seldon Core</a>.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=what-is-kserve>What is KServe?<a href=#what-is-kserve class=hash-link aria-label="Direct link to What is KServe?" title="Direct link to What is KServe?" translate=no>​</a></h3>
<p><a href=https://kserve.github.io/website target=_blank rel="noopener noreferrer" class="">KServe</a>, formally known as KFServing, provides performant, scalable, and highly-abstracted interfaces for common machine learning frameworks like Tensorflow, XGBoost, scikit-learn, and Pytorch.
It offers advanced features that aid in operating large-scale machine learning systems, such as <strong>autoscaling</strong>, <strong>canary rollout</strong>, <strong>A/B testing</strong>, <strong>monitoring</strong>,
<strong>explainability</strong>, and more, leveraging the Kubernetes ecosystem, including <a href=https://knative.dev target=_blank rel="noopener noreferrer" class="">KNative</a> and <a href=https://istio.io target=_blank rel="noopener noreferrer" class="">Istio</a>.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=benefits-of-using-mlflow-with-kserve>Benefits of using MLflow with KServe<a href=#benefits-of-using-mlflow-with-kserve class=hash-link aria-label="Direct link to Benefits of using MLflow with KServe" title="Direct link to Benefits of using MLflow with KServe" translate=no>​</a></h3>
<p>While KServe enables highly scalable and production-ready model serving, deploying your model there might require some effort.
MLflow simplifies the process of deploying models to a Kubernetes cluster with KServe and MLServer. Additionally, it offers seamless <strong>end-to-end model management</strong>
as a single place to manage the entire ML lifecycle. This includes <a class="" href=/mlflow-website/docs/latest/ml/tracking/>experiment tracking</a>, <a class="" href=/mlflow-website/docs/latest/ml/model/>model packaging</a>,
<a class="" href=/mlflow-website/docs/latest/ml/model-registry/>versioning</a>, <a class="" href=/mlflow-website/docs/latest/ml/evaluation/>evaluation</a>, and <a class="" href=/mlflow-website/docs/latest/ml/deployment/>deployment</a>, which we will cover in this tutorial.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=step-1-installing-mlflow-and-additional-dependencies>Step 1: Installing MLflow and Additional Dependencies<a href=#step-1-installing-mlflow-and-additional-dependencies class=hash-link aria-label="Direct link to Step 1: Installing MLflow and Additional Dependencies" title="Direct link to Step 1: Installing MLflow and Additional Dependencies" translate=no>​</a></h2>
<p>First, please install mlflow to your local machine using the following command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for bash code with copy and toggle buttons"><span class=languageLabel_zr_I>bash</span></div><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">pip </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">mlserver</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><br/></span></code></pre></div></div>
<p><code>[extras]</code> will install additional dependencies required for this tutorial including <a href=https://mlserver.readthedocs.io/en/latest target=_blank rel="noopener noreferrer" class="">mlserver</a> and
<a href=https://scikit-learn.org/stable target=_blank rel="noopener noreferrer" class="">scikit-learn</a>. Note that scikit-learn is not required for deployment, just for training the example model used in this tutorial.</p>
<p>You can check if MLflow is installed correctly by running:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for bash code with copy and toggle buttons"><span class=languageLabel_zr_I>bash</span></div><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">mlflow </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--version</span><br/></span></code></pre></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=step-2-setting-up-a-kubernetes-cluster>Step 2: Setting Up a Kubernetes Cluster<a href=#step-2-setting-up-a-kubernetes-cluster class=hash-link aria-label="Direct link to Step 2: Setting Up a Kubernetes Cluster" title="Direct link to Step 2: Setting Up a Kubernetes Cluster" translate=no>​</a></h2>
<div class="theme-tabs-container tabs-container tabList__CuJ"><ul role=tablist aria-orientation=horizontal class=tabs><li role=tab tabindex=0 aria-selected=true class="tabs__item tabItem_LNqP tabs__item--active">Kubernetes Cluster<li role=tab tabindex=-1 aria-selected=false class="tabs__item tabItem_LNqP">Local Machine Emulation</ul><div class=margin-top--md><div role=tabpanel class=tabItem_Ymn6><p>If you already have access to a Kubernetes cluster, you can install KServe to your cluster by following <a href=https://github.com/kserve/kserve#hammer_and_wrench-installation target=_blank rel="noopener noreferrer" class="">the official instructions</a>.</div><div role=tabpanel class=tabItem_Ymn6 hidden><p>You can follow <a href=https://kserve.github.io/website/latest/get_started target=_blank rel="noopener noreferrer" class="">KServe QuickStart</a> to set up a local cluster with <a href=https://kind.sigs.k8s.io/docs/user/quick-start target=_blank rel="noopener noreferrer" class="">Kind</a> and install KServe on it.</div></div></div>
<p>Now that you have a Kubernetes cluster running as a deployment target, let's move on to creating the MLflow Model to deploy.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=step-3-training-the-model>Step 3: Training the Model<a href=#step-3-training-the-model class=hash-link aria-label="Direct link to Step 3: Training the Model" title="Direct link to Step 3: Training the Model" translate=no>​</a></h2>
<p>In this tutorial, we will train and deploy a simple regression model that predicts the quality of wine.</p>
<p>Let's start from training a model with the default hyperparameters. Execute the following code in a notebook or as a Python script.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>note</div><div class=admonitionContent_BuS1><p>For the sake of convenience, we use the <a href=/mlflow-website/docs/latest/api_reference/python_api/mlflow.sklearn.html#mlflow.sklearn.autolog target=_blank><code>mlflow.sklearn.autolog<!-- -->()</code></a> function.
This function allows MLflow to automatically log the appropriate set of model parameters and metrics during training. To learn more about the auto-logging feature
or how to log manually instead, see the <a class="" href=/mlflow-website/docs/latest/ml/tracking/>MLflow Tracking documentation</a>.</div></div>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> mlflow</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> numpy </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> np</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> sklearn </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> datasets</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> metrics</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">linear_model </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> ElasticNet</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">model_selection </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> train_test_split</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">eval_metrics</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">pred</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> actual</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    rmse </span><span class="token operator">=</span><span class="token plain"> np</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sqrt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">metrics</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">mean_squared_error</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">actual</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> pred</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    mae </span><span class="token operator">=</span><span class="token plain"> metrics</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">mean_absolute_error</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">actual</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> pred</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    r2 </span><span class="token operator">=</span><span class="token plain"> metrics</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">r2_score</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">actual</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> pred</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> rmse</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> mae</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> r2</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Set th experiment name</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">set_experiment</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">"wine-quality"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Enable auto-logging to MLflow</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sklearn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">autolog</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Load wine quality dataset</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">X</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> y </span><span class="token operator">=</span><span class="token plain"> datasets</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">load_wine</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">return_X_y</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> X_test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> y_test </span><span class="token operator">=</span><span class="token plain"> train_test_split</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">X</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> y</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> test_size</span><span class="token operator">=</span><span class="token number">0.25</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Start a run and train a model</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">with</span><span class="token plain"> mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">start_run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">run_name</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">"default-params"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    lr </span><span class="token operator">=</span><span class="token plain"> ElasticNet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    lr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    y_pred </span><span class="token operator">=</span><span class="token plain"> lr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">X_test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    rmse</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> mae</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> r2 </span><span class="token operator">=</span><span class="token plain"> eval_metrics</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">y_pred</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> y_test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br/></span></code></pre></div></div>
<p>Now you have trained a model, let's check if the parameters and metrics are logged correctly, via the MLflow UI.
You can start the MLflow UI by running the following command in your terminal:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for bash code with copy and toggle buttons"><span class=languageLabel_zr_I>bash</span></div><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">mlflow server </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--port</span><span class="token plain"> </span><span class="token number">5000</span><br/></span></code></pre></div></div>
<p>Then visit <a href=http://localhost:5000 target=_blank rel="noopener noreferrer" class="">http://localhost:5000</a> to open the UI.</p>
<div class=center-div style=width:80%><p><img decoding=async loading=lazy src=/mlflow-website/docs/latest/assets/images/tracking-ui-default-620cdc67da31f91f653210afe78de3b8.png width=1131 height=627 class=img_ev3q /></div>
<p>Please open the experient named "wine-quality" on the left, then click the run named "default-params" in the table.
For this case, you should see parameters including <code>alpha</code> and <code>l1_ratio</code> and metrics like <code>training_score</code> and <code>mean_absolute_error_X_test</code>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=step-4-running-hyperparameter-tuning>Step 4: Running Hyperparameter Tuning<a href=#step-4-running-hyperparameter-tuning class=hash-link aria-label="Direct link to Step 4: Running Hyperparameter Tuning" title="Direct link to Step 4: Running Hyperparameter Tuning" translate=no>​</a></h2>
<p>Now that we have established a baseline model, let's attempt to improve its performance by tuning the hyperparameters.
We will conduct a random search to identify the optimal combination of <code>alpha</code> and <code>l1_ratio</code>.</p>
<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> scipy</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">stats </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> uniform</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> sklearn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">model_selection </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> RandomizedSearchCV</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">lr </span><span class="token operator">=</span><span class="token plain"> ElasticNet</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Define distribution to pick parameter values from</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">distributions </span><span class="token operator">=</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">dict</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    alpha</span><span class="token operator">=</span><span class="token plain">uniform</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">loc</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> scale</span><span class="token operator">=</span><span class="token number">10</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># sample alpha uniformly from [-5.0, 5.0]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    l1_ratio</span><span class="token operator">=</span><span class="token plain">uniform</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># sample l1_ratio uniformlyfrom [0, 1.0]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Initialize random search instance</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">clf </span><span class="token operator">=</span><span class="token plain"> RandomizedSearchCV</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    estimator</span><span class="token operator">=</span><span class="token plain">lr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    param_distributions</span><span class="token operator">=</span><span class="token plain">distributions</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Optimize for mean absolute error</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    scoring</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">"neg_mean_absolute_error"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Use 5-fold cross validation</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    cv</span><span class="token operator">=</span><span class="token number">5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Try 100 samples. Note that MLflow only logs the top 5 runs.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    n_iter</span><span class="token operator">=</span><span class="token number">100</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Start a parent run</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">with</span><span class="token plain"> mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">start_run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">run_name</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">"hyperparameter-tuning"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    search </span><span class="token operator">=</span><span class="token plain"> clf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">fit</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">X_train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> y_train</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    </span><span class="token comment" style="color:rgb(98, 114, 164)"># Evaluate the best model on test dataset</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    y_pred </span><span class="token operator">=</span><span class="token plain"> clf</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">best_estimator_</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">X_test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    rmse</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> mae</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> r2 </span><span class="token operator">=</span><span class="token plain"> eval_metrics</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">y_pred</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> y_test</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">log_metrics</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">            </span><span class="token string" style="color:rgb(255, 121, 198)">"mean_squared_error_X_test"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> rmse</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">            </span><span class="token string" style="color:rgb(255, 121, 198)">"mean_absolute_error_X_test"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> mae</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">            </span><span class="token string" style="color:rgb(255, 121, 198)">"r2_score_X_test"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> r2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">        </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br/></span></code></pre></div></div>
<p>When you reopen the MLflow UI, you should notice that the run "hyperparameter-tuning" contains 5 child runs. MLflow utilizes parent-child relationship, which is particularly
useful for grouping a set of runs, such as those in hyper parameter tuning. Here the auto-logging is enabled and MLflow automatically create child runs for the top 5 runs
based on the <code>scoring</code> metric, which is negative mean absolute error in this example.</p>
<div class=center-div style=width:80%><p><img decoding=async loading=lazy src=/mlflow-website/docs/latest/assets/images/hyper-parameter-tuning-ui-88db40c21c63fb307e84629607985a73.png width=2348 height=1006 class=img_ev3q /></div>
<p>To compare the results and identify the best model, you can utilize the visualization feature in the MLflow UI.</p>
<ol>
<li class="">Select the first job ("default-params") and the parent job for hyperparameter tuning ("hyperparameter-turning").</li>
<li class="">Click on the "Chart" tab to visualize the metrics in a chart.</li>
<li class="">By default, a few bar charts for a predefined set of metrics are displayed.</li>
<li class="">You can add different chart, such as a scatter plot, to compare multiple metrics. For example, we can see the best model from hyperparameter tuning outperforms the default parameter model, in the mean squared error on the test dataset:</li>
</ol>
<p>You can check the best combination of hyperparameters by looking at the parent run "hyperparameter-tuning".
In this example, the best model was <code>alpha=0.11714084185001972</code> and <code>l1_ratio=0.3599780644783639</code> (you may see different results).</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>note</div><div class=admonitionContent_BuS1><p>To learn more about hyperparameter tuning with MLflow, please refer to <a class="" href=/mlflow-website/docs/latest/ml/traditional-ml/tutorials/hyperparameter-tuning/>Hyperparameter Tuning with MLflow and Optuna</a>.</div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=step-5-packaging-the-model-and-dependencies>Step 5: Packaging the Model and Dependencies<a href=#step-5-packaging-the-model-and-dependencies class=hash-link aria-label="Direct link to Step 5: Packaging the Model and Dependencies" title="Direct link to Step 5: Packaging the Model and Dependencies" translate=no>​</a></h2>
<p>Since we are using autologging, MLflow automatically logs the <a class="" href=/mlflow-website/docs/latest/ml/model/>Model</a> for each run. This process conveniently packages the model weight
and dependencies in a ready-to-deploy format.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>note</div><div class=admonitionContent_BuS1><p>In practice, it is also recommended to use <a class="" href=/mlflow-website/docs/latest/ml/model-registry/>MLflow Model Registry</a> for registering and managing your models.</div></div>
<p>Let's take a brief look at how this format appears. You can view the logged model through the <code>Artifacts</code> tab on the Run detail page.</p>
<div class="language-text codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for text code with copy and toggle buttons"><span class=languageLabel_zr_I>text</span></div><pre tabindex=0 class="prism-code language-text codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">model</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">├── MLmodel</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">├── model.pkl</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">├── conda.yaml</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">├── python_env.yaml</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">└── requirements.txt</span><br/></span></code></pre></div></div>
<p><code>model.pkl</code> is the file containing the serialized model weight. <code>MLmodel</code> includes general metadata that instructs MLflow on how to load the model.
The other files specify the dependencies required to run the model.</p>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>note</div><div class=admonitionContent_BuS1><p>If you opt for manual logging, you will need to log the model explicitly using the <a href=/mlflow-website/docs/latest/api_reference/python_api/mlflow.sklearn.html#mlflow.sklearn.log_model target=_blank><code>mlflow.sklearn.log_model</code></a>
function, as shown below:<div class="language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">sklearn</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">log_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">lr</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> name</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">"model"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br/></span></code></pre></div></div></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=step-6-test-model-serving-locally>Step 6: Testing Model Serving Locally<a href=#step-6-test-model-serving-locally class=hash-link aria-label="Direct link to Step 6: Testing Model Serving Locally" title="Direct link to Step 6: Testing Model Serving Locally" translate=no>​</a></h2>
<p>Before deploying the model, let's first test that the model can be served locally. As outlined in the
<a class="" href=/mlflow-website/docs/latest/ml/deployment/deploy-model-locally/>Deploy MLflow Model Locally</a>, you can run a local inference server with just a single command.
Remember to use the <code>enable-mlserver</code> flag, which instructs MLflow to use MLServer as the inference server. This ensures the model runs in the
same manner as it would in Kubernetes.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for bash code with copy and toggle buttons"><span class=languageLabel_zr_I>bash</span></div><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">mlflow models serve </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-m</span><span class="token plain"> models:/</span><span class="token operator">&lt;</span><span class="token plain">model_id_for_your_best_iteration</span><span class="token operator">></span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-p</span><span class="token plain"> </span><span class="token number">1234</span><span class="token plain"> --enable-mlserver</span><br/></span></code></pre></div></div>
<p>This command starts a local server listening on port 1234. You can send a request to the server using <code>curl</code> command:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for bash code with copy and toggle buttons"><span class=languageLabel_zr_I>bash</span></div><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-X</span><span class="token plain"> POST </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-H</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"Content-Type:application/json"</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--data</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">'{"inputs": [[14.23, 1.71, 2.43, 15.6, 127.0, 2.8, 3.06, 0.28, 2.29, 5.64, 1.04, 3.92, 1065.0]]}'</span><span class="token plain"> http://127.0.0.1:1234/invocations</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string" style="color:rgb(255, 121, 198)">"predictions"</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">-0.03416275504140387</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br/></span></code></pre></div></div>
<p>For more information about the request format and response formats, refer to the <a class="" href=/mlflow-website/docs/latest/ml/deployment/deploy-model-locally/#local-inference-server-spec>Inference Server Specification</a>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=step-7-deploying-the-model-to-kserve>Step 7: Deploying the Model to KServe<a href=#step-7-deploying-the-model-to-kserve class=hash-link aria-label="Direct link to Step 7: Deploying the Model to KServe" title="Direct link to Step 7: Deploying the Model to KServe" translate=no>​</a></h2>
<p>Finally, we are all set to deploy the model to the Kubernetes cluster.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=create-namespace>Create Namespace<a href=#create-namespace class=hash-link aria-label="Direct link to Create Namespace" title="Direct link to Create Namespace" translate=no>​</a></h3>
<p>First, create a test namespace for deploying KServe resources and your model:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for bash code with copy and toggle buttons"><span class=languageLabel_zr_I>bash</span></div><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">kubectl create namespace mlflow-kserve-test</span><br/></span></code></pre></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=create-deployment-configuration>Create Deployment Configuration<a href=#create-deployment-configuration class=hash-link aria-label="Direct link to Create Deployment Configuration" title="Direct link to Create Deployment Configuration" translate=no>​</a></h3>
<p>Create a YAML file describing the model deployment to KServe.</p>
<p>There are two ways to specify the model for deployment in KServe configuration file:</p>
<ol>
<li class="">Build a Docker image with the model and specify the image URI.</li>
<li class="">Specify the model URI directly (this only works if your model is stored in remote storage).</li>
</ol>
<p>Please open the tabs below for details on each approach.</p>
<div class="theme-tabs-container tabs-container tabList__CuJ"><ul role=tablist aria-orientation=horizontal class=tabs><li role=tab tabindex=0 aria-selected=true class="tabs__item tabItem_LNqP tabs__item--active">Using Docker Image<li role=tab tabindex=-1 aria-selected=false class="tabs__item tabItem_LNqP">Using Model URI</ul><div class=margin-top--md><div role=tabpanel class=tabItem_Ymn6><h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=register-docker-account>Register Docker Account<a href=#register-docker-account class=hash-link aria-label="Direct link to Register Docker Account" title="Direct link to Register Docker Account" translate=no>​</a></h4><p>Since KServe cannot resolve a locally built Docker image, you need to push the image to a Docker registry.
For this tutorial, we'll push the image to <a href=https://hub.docker.com target=_blank rel="noopener noreferrer" class="">Docker Hub</a>, but you can use any other Docker registry,
such as <a href=https://aws.amazon.com/ecr target=_blank rel="noopener noreferrer" class="">Amazon ECR</a> or a private registry.<p>If you don't have a Docker Hub account yet, create one at <a href=https://hub.docker.com/signup target=_blank rel="noopener noreferrer" class="">https://hub.docker.com/signup</a>.<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=build-a-docker-image>Build a Docker Image<a href=#build-a-docker-image class=hash-link aria-label="Direct link to Build a Docker Image" title="Direct link to Build a Docker Image" translate=no>​</a></h4><p>Build a ready-to-deploy Docker image with the <code>mlflow models build-docker</code> command:<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for bash code with copy and toggle buttons"><span class=languageLabel_zr_I>bash</span></div><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">mlflow models build-docker </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-m</span><span class="token plain"> runs:/</span><span class="token operator">&lt;</span><span class="token plain">run_id_for_your_best_run</span><span class="token operator">></span><span class="token plain">/model </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-n</span><span class="token plain"> </span><span class="token operator">&lt;</span><span class="token plain">your_dockerhub_user_name</span><span class="token operator">></span><span class="token plain">/mlflow-wine-classifier --enable-mlserver</span><br/></span></code></pre></div></div><p>This command builds a Docker image with the model and dependencies, tagging it as <code>mlflow-wine-classifier:latest</code>.<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=push-the-docker-image>Push the Docker Image<a href=#push-the-docker-image class=hash-link aria-label="Direct link to Push the Docker Image" title="Direct link to Push the Docker Image" translate=no>​</a></h4><p>After building the image, push it to Docker Hub (or to another registry using the appropriate command):<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for bash code with copy and toggle buttons"><span class=languageLabel_zr_I>bash</span></div><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token function" style="color:rgb(80, 250, 123)">docker</span><span class="token plain"> push </span><span class="token operator">&lt;</span><span class="token plain">your_dockerhub_user_name</span><span class="token operator">></span><span class="token plain">/mlflow-wine-classifier</span><br/></span></code></pre></div></div><h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=write-deployment-configuration>Write Deployment Configuration<a href=#write-deployment-configuration class=hash-link aria-label="Direct link to Write Deployment Configuration" title="Direct link to Write Deployment Configuration" translate=no>​</a></h4><p>Then create a YAML file like this:<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for yaml code with copy and toggle buttons"><span class=languageLabel_zr_I>yaml</span></div><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"serving.kserve.io/v1beta1"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"InferenceService"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"mlflow-wine-classifier"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"mlflow-kserve-test"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token key atrule">predictor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    </span><span class="token key atrule">containers</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"mlflow-wine-classifier"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">        </span><span class="token key atrule">image</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"&lt;your_docker_user_name>/mlflow-wine-classifier"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">        </span><span class="token key atrule">ports</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">          </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">containerPort</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">            </span><span class="token key atrule">protocol</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> TCP</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">        </span><span class="token key atrule">env</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">          </span><span class="token punctuation" style="color:rgb(248, 248, 242)">-</span><span class="token plain"> </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> PROTOCOL</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">            </span><span class="token key atrule">value</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"v2"</span><br/></span></code></pre></div></div></div><div role=tabpanel class=tabItem_Ymn6 hidden><h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=get-remote-model-uri>Get Remote Model URI<a href=#get-remote-model-uri class=hash-link aria-label="Direct link to Get Remote Model URI" title="Direct link to Get Remote Model URI" translate=no>​</a></h4><p>KServe configuration allows direct specification of the model URI. However, it doesn't resolve MLflow-specific URI schemas like <code>runs:/</code> and <code>model:/</code>,
nor local file URIs like <code>file:///</code>. We need to specify the model URI in a remote storage URI format e.g. <code>s3://xxx</code> or <code>gs://xxx</code>.
By default, MLflow stores the model in the local file system, so you need to configure MLflow to store the model in remote storage.
Please refer to <a class="" href=/mlflow-website/docs/latest/ml/tracking/#artifact-stores>Artifact Store</a> for setup instructions.<p>After configuring the artifact store, load and re-log the best model to the new artifact store, or repeat the model training steps.<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=create-deployment-configuration-1>Create Deployment Configuration<a href=#create-deployment-configuration-1 class=hash-link aria-label="Direct link to Create Deployment Configuration" title="Direct link to Create Deployment Configuration" translate=no>​</a></h4><p>With the remote model URI, create a YAML file:<div class="language-yaml codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for yaml code with copy and toggle buttons"><span class=languageLabel_zr_I>yaml</span></div><pre tabindex=0 class="prism-code language-yaml codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token key atrule">apiVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"serving.kserve.io/v1beta1"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token key atrule">kind</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"InferenceService"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token key atrule">metadata</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"mlflow-wine-classifier"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"mlflow-kserve-test"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token key atrule">spec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token key atrule">predictor</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    </span><span class="token key atrule">model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      </span><span class="token key atrule">modelFormat</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">        </span><span class="token key atrule">name</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> mlflow</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      </span><span class="token key atrule">protocolVersion</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> v2</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      </span><span class="token key atrule">storageUri</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"&lt;your_model_uri>"</span><br/></span></code></pre></div></div></div></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=deploy-inference-service>Deploy Inference Service<a href=#deploy-inference-service class=hash-link aria-label="Direct link to Deploy Inference Service" title="Direct link to Deploy Inference Service" translate=no>​</a></h3>
<p>Run the following <code>kubectl</code> command to deploy a new <code>InferenceService</code> to your Kubernetes cluster:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for bash code with copy and toggle buttons"><span class=languageLabel_zr_I>bash</span></div><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">$ kubectl apply </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token plain"> YOUR_CONFIG_FILE.yaml</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">inferenceservice.serving.kserve.io/mlflow-wine-classifier created</span><br/></span></code></pre></div></div>
<p>You can check the status of the deployment by running:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for bash code with copy and toggle buttons"><span class=languageLabel_zr_I>bash</span></div><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">$ kubectl get inferenceservice mlflow-wine-classifier</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">NAME                     URL                                                     READY   PREV   LATEST   PREVROLLEDOUTREVISION   LATESTREADYREVISION</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">mlflow-wine-classifier   http://mlflow-wine-classifier.mlflow-kserve-test.local   True             </span><span class="token number">100</span><span class="token plain">                    mlflow-wine-classifier-100</span><br/></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class=admonitionHeading_Gvgb><span class=admonitionIcon_Rf37><svg viewBox="0 0 14 16"><path fill-rule=evenodd d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"/></svg></span>note</div><div class=admonitionContent_BuS1><p>It may take a few minutes for the deployment status to be ready. For detailed deployment status and logs,
run <code>kubectl get inferenceservice mlflow-wine-classifier -oyaml</code>.</div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=test-the-deployment>Test the Deployment<a href=#test-the-deployment class=hash-link aria-label="Direct link to Test the Deployment" title="Direct link to Test the Deployment" translate=no>​</a></h3>
<p>Once the deployment is ready, you can send a test request to the server.</p>
<p>First, create a JSON file with test data and save it as <code>test-input.json</code>. Ensure the request data is formatted for the <a href=https://kserve.github.io/website/latest/reference/swagger-ui/#modelinferrequestinferinputtensor target=_blank rel="noopener noreferrer" class="">V2 Inference Protocol</a>,
because we created the model with <code>protocolVersion: v2</code>. The request should look like this:</p>
<div class="language-json codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for json code with copy and toggle buttons"><span class=languageLabel_zr_I>json</span></div><pre tabindex=0 class="prism-code language-json codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token property">"inputs"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      </span><span class="token property">"name"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"input"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      </span><span class="token property">"shape"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">13</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      </span><span class="token property">"datatype"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"FP32"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      </span><span class="token property">"data"</span><span class="token operator">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">14.23</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.71</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">2.43</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">15.6</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">127.0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">2.8</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">3.06</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">0.28</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">2.29</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">5.64</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1.04</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">3.92</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token number">1065.0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">    </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><br/></span></code></pre></div></div>
<p>Then send the request to your inference service:</p>
<div class="theme-tabs-container tabs-container tabList__CuJ"><ul role=tablist aria-orientation=horizontal class=tabs><li role=tab tabindex=0 aria-selected=true class="tabs__item tabItem_LNqP tabs__item--active">Kubernetes Cluster<li role=tab tabindex=-1 aria-selected=false class="tabs__item tabItem_LNqP">Local Machine Emulation</ul><div class=margin-top--md><div role=tabpanel class=tabItem_Ymn6><p>Assuming your cluster is exposed via LoadBalancer, follow <a href=https://kserve.github.io/website/0.10/get_started/first_isvc/#4-determine-the-ingress-ip-and-ports target=_blank rel="noopener noreferrer" class="">these instructions</a> to find the Ingress IP and port.
Then send a test request using <code>curl</code> command:<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for bash code with copy and toggle buttons"><span class=languageLabel_zr_I>bash</span></div><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">$ </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SERVICE_HOSTNAME</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">kubectl get inferenceservice mlflow-wine-classifier </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-n</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> mlflow-kserve-test </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-o</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">jsonpath</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">=</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">'{.status.url}'</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-d</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">"/"</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable number" style="color:rgb(189, 147, 249);font-style:italic">3</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-v</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-H</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"Host: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${SERVICE_HOSTNAME}</span><span class="token string" style="color:rgb(255, 121, 198)">"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-H</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"Content-Type: application/json"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-d</span><span class="token plain"> @./test-input.json </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  http://</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${INGRESS_HOST}</span><span class="token builtin class-name" style="color:rgb(189, 147, 249)">:</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${INGRESS_PORT}</span><span class="token plain">/v2/models/mlflow-wine-classifier/infer</span><br/></span></code></pre></div></div></div><div role=tabpanel class=tabItem_Ymn6 hidden><p>Typically, Kubernetes clusters expose services via LoadBalancer, but a local cluster created by <code>kind</code> doesn't have one.
In this case, you can access the inference service via port-forwarding.<p>Open a new terminal and run the following command to forward the port:<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for bash code with copy and toggle buttons"><span class=languageLabel_zr_I>bash</span></div><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">$ </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">INGRESS_GATEWAY_SERVICE</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">kubectl get svc </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-n</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> istio-system </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">--selector</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">=</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">"app=istio-ingressgateway"</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-o</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">jsonpath</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">=</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">'{.items[0].metadata.name}'</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">$ kubectl port-forward </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-n</span><span class="token plain"> istio-system svc/</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">${INGRESS_GATEWAY_SERVICE}</span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain">:80</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">Forwarding from </span><span class="token number">127.0</span><span class="token plain">.0.1:8080 -</span><span class="token operator">></span><span class="token plain"> </span><span class="token number">8080</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">Forwarding from </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">::1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain">:8080 -</span><span class="token operator">></span><span class="token plain"> </span><span class="token number">8080</span><br/></span></code></pre></div></div><p>Then, in the original terminal, send a test request to the server:<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for bash code with copy and toggle buttons"><span class=languageLabel_zr_I>bash</span></div><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">$ </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">SERVICE_HOSTNAME</span><span class="token operator">=</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">$(</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">kubectl get inferenceservice mlflow-wine-classifier </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-n</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> mlflow-kserve-test </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-o</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">jsonpath</span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">=</span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">'{.status.url}'</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable operator" style="color:rgb(189, 147, 249);font-style:italic">|</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable function" style="color:rgb(80, 250, 123);font-style:italic">cut</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-d</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable string" style="color:rgb(255, 121, 198);font-style:italic">"/"</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-f</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic"> </span><span class="token variable number" style="color:rgb(189, 147, 249);font-style:italic">3</span><span class="token variable" style="color:rgb(189, 147, 249);font-style:italic">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">$ </span><span class="token function" style="color:rgb(80, 250, 123)">curl</span><span class="token plain"> </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-v</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-H</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"Host: </span><span class="token string variable" style="color:rgb(189, 147, 249);font-style:italic">${SERVICE_HOSTNAME}</span><span class="token string" style="color:rgb(255, 121, 198)">"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-H</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"Content-Type: application/json"</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token parameter variable" style="color:rgb(189, 147, 249);font-style:italic">-d</span><span class="token plain"> @./test-input.json </span><span class="token punctuation" style="color:rgb(248, 248, 242)">\</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  http://localhost:8080/v2/models/mlflow-wine-classifier/infer</span><br/></span></code></pre></div></div></div></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=troubleshooting>Troubleshooting<a href=#troubleshooting class=hash-link aria-label="Direct link to Troubleshooting" title="Direct link to Troubleshooting" translate=no>​</a></h2>
<p>If you have any trouble during deployment, please consult with the <a href=https://kserve.github.io/website target=_blank rel="noopener noreferrer" class="">KServe official documentation</a>
and their <a href=https://kserve.github.io/website/0.10/modelserving/v1beta1/mlflow/v2 target=_blank rel="noopener noreferrer" class="">MLflow Deployment Guide</a>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=conclusion>Conclusion<a href=#conclusion class=hash-link aria-label="Direct link to Conclusion" title="Direct link to Conclusion" translate=no>​</a></h2>
<p>Congratulations on completing the guide! In this tutorial, you have learned how to use MLflow for training a model, running hyperparameter tuning,
and deploying the model to Kubernetes cluster.</p>
<p><strong>Further readings</strong>:</p>
<ul>
<li class=""><a class="" href=/mlflow-website/docs/latest/ml/tracking/>MLflow Tracking</a> - Explore more about MLflow Tracking and various ways to manage experiments and models, such as team collaboration.</li>
<li class=""><a class="" href=/mlflow-website/docs/latest/ml/model-registry/>MLflow Model Registry</a> - Discover more about MLflow Model Registry for managing model versions and stages in a centralized model store.</li>
<li class=""><a class="" href=/mlflow-website/docs/latest/ml/deployment/>MLflow Deployment</a> - Learn more about MLflow deployment and different deployment targets.</li>
<li class=""><a href=https://kserve.github.io/website/ target=_blank rel="noopener noreferrer" class="">KServe official documentation</a> - Dive deeper into KServe and its advanced features, including autoscaling, canary rollout, A/B testing, monitoring, explainability, etc.</li>
<li class=""><a href=https://docs.seldon.io/projects/seldon-core/en/latest/ target=_blank rel="noopener noreferrer" class="">Seldon Core official documentation</a> - Learn about Seldon Core, an alternative serverless model serving framework we support for Kubernetes.</li>
</ul></div></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/mlflow-website/docs/latest/ml/deployment/deploy-model-to-kubernetes/><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Deploy MLflow Model to Kubernetes</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/mlflow-website/docs/latest/ml/deployment/deploy-model-to-sagemaker/><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Deploy MLflow Model to Amazon SageMaker</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#introduction-scalable-model-serving-with-kserve-and-mlserver class="table-of-contents__link toc-highlight">Introduction: Scalable Model Serving with KServe and MLServer</a><ul><li><a href=#what-is-kserve class="table-of-contents__link toc-highlight">What is KServe?</a><li><a href=#benefits-of-using-mlflow-with-kserve class="table-of-contents__link toc-highlight">Benefits of using MLflow with KServe</a></ul><li><a href=#step-1-installing-mlflow-and-additional-dependencies class="table-of-contents__link toc-highlight">Step 1: Installing MLflow and Additional Dependencies</a><li><a href=#step-2-setting-up-a-kubernetes-cluster class="table-of-contents__link toc-highlight">Step 2: Setting Up a Kubernetes Cluster</a><li><a href=#step-3-training-the-model class="table-of-contents__link toc-highlight">Step 3: Training the Model</a><li><a href=#step-4-running-hyperparameter-tuning class="table-of-contents__link toc-highlight">Step 4: Running Hyperparameter Tuning</a><li><a href=#step-5-packaging-the-model-and-dependencies class="table-of-contents__link toc-highlight">Step 5: Packaging the Model and Dependencies</a><li><a href=#step-6-test-model-serving-locally class="table-of-contents__link toc-highlight">Step 6: Testing Model Serving Locally</a><li><a href=#step-7-deploying-the-model-to-kserve class="table-of-contents__link toc-highlight">Step 7: Deploying the Model to KServe</a><ul><li><a href=#create-namespace class="table-of-contents__link toc-highlight">Create Namespace</a><li><a href=#create-deployment-configuration class="table-of-contents__link toc-highlight">Create Deployment Configuration</a><li><a href=#deploy-inference-service class="table-of-contents__link toc-highlight">Deploy Inference Service</a><li><a href=#test-the-deployment class="table-of-contents__link toc-highlight">Test the Deployment</a></ul><li><a href=#troubleshooting class="table-of-contents__link toc-highlight">Troubleshooting</a><li><a href=#conclusion class="table-of-contents__link toc-highlight">Conclusion</a></ul></div></div></div></div></main></div></div></div><footer class="relative pb-30 flex flex-col pt-30 bg-bottom bg-no-repeat bg-cover bg-size-[auto_360px] 2xl:bg-size-[100%_360px] bg-brand-black"><div style="position:absolute;width:100%;bottom:0;pointer-events:none;mask-composite:intersect;height:360px;background-image:repeating-linear-gradient(
        to right,
        rgba(0, 0, 0, 0.05),
        rgba(0, 0, 0, 0.25) 18px,
        transparent 2px,
        transparent 10px
      ),
      radial-gradient(
        circle at bottom center,
        oklch(0.7533 0.11 216.4) 0%,
        transparent 60%
      ),
      linear-gradient(to right, color-mix(in srgb, oklch(0.7533 0.11 216.4), navy 40%), color-mix(in srgb, oklch(0.7533 0.11 216.4), teal 40%));mask-image:radial-gradient(ellipse at center bottom, black 60%, transparent 80%),
      linear-gradient(to top, black 10%, transparent 40%)"></div><div class=z-1><div class="flex flex-row justify-between items-start md:items-center px-6 lg:px-20 gap-10 xs:gap-0 max-w-container"><div class="flex flex-col gap-8"><svg xmlns=http://www.w3.org/2000/svg width=109 height=40 fill=none viewBox="0 0 109 40" class="h-[36px] shrink-0"><path fill=#fff d="M0 31.032v-15.53h3.543v1.968c.893-1.594 2.84-2.425 4.593-2.425 2.042 0 3.828.926 4.658 2.745 1.216-2.043 3.034-2.745 5.043-2.745 2.81 0 5.49 1.787 5.49 5.904v10.083h-3.574v-9.478c0-1.818-.926-3.19-3-3.19-1.947 0-3.224 1.53-3.224 3.445v9.22H9.893v-9.475c0-1.786-.898-3.18-3.003-3.18-1.977 0-3.223 1.467-3.223 3.444v9.221ZM27.855 31.032V7.929h3.703v23.103ZM30.07 39.487c.833.232 1.582.383 3.17.383 2.953 0 6.436-1.665 7.353-6.339l3.786-18.739h5.629l.687-3.117h-5.686l.765-3.725c.586-2.892 2.186-4.358 4.754-4.358.668 0 .48.058 1.076.17L52.427.57c-.793-.237-1.503-.379-3.049-.379a7.32 7.32 0 0 0-4.528 1.484c-1.441 1.114-2.393 2.75-2.827 4.863l-1.066 5.137h-5.034l-.411 3.12h4.823L36.859 32.12c-.383 1.965-1.5 4.315-4.708 4.315-.727 0-.463-.055-1.121-.162ZM53.342 30.905H49.64l5.074-23.309h3.701ZM71.807 16.477A7.962 7.962 0 0 0 60.97 27.904l2.425-1.78a5.005 5.005 0 0 1 3.845-8.145v1.895ZM62.618 29.472a7.962 7.962 0 0 0 10.836-11.428l-2.425 1.78a5.005 5.005 0 0 1-3.845 8.145v-1.894ZM78.092 15.493h4.044l.823 10.612 5.759-10.612 3.839.055 1.508 10.557 5.074-10.612 3.701.055-7.678 15.493H91.46l-1.783-11.106-5.895 11.106h-3.84ZM105.072 15.768h-.766v-.266h1.845v.272h-.765v2.243h-.314ZM106.614 15.502h.383l.482 1.34q.091.259.178.524h.018c.059-.176.113-.352.172-.524l.478-1.34h.383v2.515h-.298V16.63c0-.22.024-.523.04-.747h-.016l-.191.574-.475 1.304h-.208l-.481-1.302-.191-.574h-.015c.017.224.042.527.042.747v1.387h-.291Z"/></svg><div class="text-xs text-left md:text-nowrap md:w-0">© 2025 MLflow Project, a Series of LF Projects, LLC.</div></div><div class="flex flex-col flex-wrap justify-end md:text-right md:flex-row gap-x-10 lg:gap-x-20 gap-y-5 w-2/5 md:w-auto md:pt-2 max-w-fit"><div><a href=https://mlflow.org target=_blank rel="noopener noreferrer" class="text-[15px] font-medium no-underline hover:no-underline transition-opacity hover:opacity-80 text-white visited:text-white">Components</a></div><div><a href=https://mlflow.org/releases target=_blank rel="noopener noreferrer" class="text-[15px] font-medium no-underline hover:no-underline transition-opacity hover:opacity-80 text-white visited:text-white">Releases</a></div><div><a href=https://mlflow.org/blog target=_blank rel="noopener noreferrer" class="text-[15px] font-medium no-underline hover:no-underline transition-opacity hover:opacity-80 text-white visited:text-white">Blog</a></div><div><a class="text-[15px] font-medium no-underline hover:no-underline transition-opacity hover:opacity-80 text-white visited:text-white" href=/mlflow-website/docs/latest/>Docs</a></div><div><a href=https://mlflow.org/ambassadors target=_blank rel="noopener noreferrer" class="text-[15px] font-medium no-underline hover:no-underline transition-opacity hover:opacity-80 text-white visited:text-white">Ambassador Program</a></div></div></div></div></footer></div></body>