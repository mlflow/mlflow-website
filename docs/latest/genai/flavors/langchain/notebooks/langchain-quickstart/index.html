<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-genai docs-version-current docs-doc-page docs-doc-id-flavors/langchain/notebooks/langchain-quickstart-ipynb" data-has-hydrated=false><head><meta charset=UTF-8><meta name=generator content="Docusaurus v3.9.2"><title data-rh=true>Introduction to Using LangChain with MLflow | MLflow</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"/><meta data-rh=true name=twitter:card content=summary_large_image /><meta data-rh=true property=og:url content=https://mlflow.org/mlflow-website/docs/latest/genai/flavors/langchain/notebooks/langchain-quickstart/ /><meta data-rh=true property=og:locale content=en /><meta data-rh=true name=docusaurus_locale content=en /><meta data-rh=true name=docsearch:language content=en /><meta data-rh=true name=docusaurus_version content=current /><meta data-rh=true name=docusaurus_tag content=docs-genai-current /><meta data-rh=true name=docsearch:version content=current /><meta data-rh=true name=docsearch:docusaurus_tag content=docs-genai-current /><meta data-rh=true property=og:title content="Introduction to Using LangChain with MLflow | MLflow"/><meta data-rh=true name=description content="Download this notebook"/><meta data-rh=true property=og:description content="Download this notebook"/><link data-rh=true rel=icon href=/mlflow-website/docs/latest/images/favicon.ico /><link data-rh=true rel=canonical href=https://mlflow.org/mlflow-website/docs/latest/genai/flavors/langchain/notebooks/langchain-quickstart/ /><link data-rh=true rel=alternate href=https://mlflow.org/mlflow-website/docs/latest/genai/flavors/langchain/notebooks/langchain-quickstart/ hreflang=en /><link data-rh=true rel=alternate href=https://mlflow.org/mlflow-website/docs/latest/genai/flavors/langchain/notebooks/langchain-quickstart/ hreflang=x-default /><link data-rh=true rel=preconnect href=https://XKVLO8P882-dsn.algolia.net crossorigin=anonymous /><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://mlflow.org/mlflow-website/docs/latest/genai/flavors/","name":"Packaging & Deployment","position":1},{"@type":"ListItem","item":"https://mlflow.org/mlflow-website/docs/latest/genai/flavors/langchain/","name":"LangChain","position":2},{"@type":"ListItem","item":"https://mlflow.org/mlflow-website/docs/latest/genai/flavors/langchain/notebooks/langchain-quickstart","name":"LangChain Quickstart","position":3}]}</script><link rel=preconnect href=https://www.google-analytics.com><link rel=preconnect href=https://www.googletagmanager.com><script async src="https://www.googletagmanager.com/gtag/js?id=GTM-N6WMTTJ"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","GTM-N6WMTTJ",{anonymize_ip:!0}),gtag("config","AW-16857946923",{anonymize_ip:!0})</script><link rel=preconnect href=https://www.googletagmanager.com><script>window.dataLayer=window.dataLayer||[],function(e,t,a,n,r){e[n]=e[n]||[],e[n].push({"gtm.start":new Date().getTime(),event:"gtm.js"});var d=t.getElementsByTagName(a)[0],g=t.createElement(a);g.async=!0,g.src="https://www.googletagmanager.com/gtm.js?id="+r+("dataLayer"!=n?"&l="+n:""),d.parentNode.insertBefore(g,d)}(window,document,"script","dataLayer","GTM-N6WMTTJ")</script><link rel=search type=application/opensearchdescription+xml title=MLflow href=/mlflow-website/docs/latest/opensearch.xml><script src=/mlflow-website/docs/latest/js/runllm.js defer></script><link rel=stylesheet href=/mlflow-website/docs/latest/assets/css/styles.65681509.css /><script src=/mlflow-website/docs/latest/assets/js/runtime~main.a0db6d66.js defer></script><script src=/mlflow-website/docs/latest/assets/js/main.6a651fa1.js defer></script></head><body class=navigation-with-keyboard><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-N6WMTTJ" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript>


<svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/mlflow-website/docs/latest/><div class=navbar__logo><img src=/mlflow-website/docs/latest/images/logo-light.svg alt="MLflow Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"/><img src=/mlflow-website/docs/latest/images/logo-dark.svg alt="MLflow Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"/></div></a><div class="navbar__item dropdown dropdown--hoverable"><a href=# aria-haspopup=true aria-expanded=false role=button class="navbar__link docsDropdown_VGp6" data-active=genai><div style=display:flex;gap:8px;align-items:center><div class=dropdownCircle_n91F style=width:10px;height:10px;background-color:var(--genai-color-primary);border-radius:4px></div>GenAI Docs</div></a><ul class=dropdown__menu><li><a class="dropdown__link ml-docs-link" href=/mlflow-website/docs/latest/ml/><div style=display:flex;gap:8px;align-items:center><div style=width:10px;height:10px;background-color:var(--ml-color-primary);border-radius:4px></div>ML Docs</div></a><li><a aria-current=page class="dropdown__link genai-docs-link dropdown__link--active" href=/mlflow-website/docs/latest/genai/><div style=display:flex;gap:8px;align-items:center><div style=width:10px;height:10px;background-color:var(--genai-color-primary);border-radius:4px></div>GenAI Docs</div></a></ul></div><a href=https://mlflow.org/docs/latest/api_reference/index.html target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">API Reference</a><a class="navbar__item navbar__link" href=/mlflow-website/docs/latest/self-hosting/>Self-Hosting</a><a class="navbar__item navbar__link" href=/mlflow-website/docs/latest/community/>Community</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href=https://github.com/mlflow/mlflow target=_blank rel="noopener noreferrer" class="navbar__item navbar__link github-link">GitHub<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts=Meta+k><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 24 24" aria-hidden=true><circle cx=11 cy=11 r=8 stroke=currentColor fill=none stroke-width=1.4 /><path d="m21 21-4.3-4.3" stroke=currentColor fill=none stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-overview"><a class=menu__link href=/mlflow-website/docs/latest/genai/><span title=Overview class=linkLabel_WmDU>Overview</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item"><b>Getting Started</b><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-top-level-category"><a class=menu__link href=/mlflow-website/docs/latest/genai/getting-started/connect-environment/><span title="Set Up MLflow Server" class=linkLabel_WmDU>Set Up MLflow Server</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-top-level-category"><a class=menu__link href=/mlflow-website/docs/latest/genai/tracing/quickstart/><span title="Start Tracing" class=linkLabel_WmDU>Start Tracing</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-top-level-category"><a class=menu__link href=/mlflow-website/docs/latest/genai/eval-monitor/quickstart/><span title="Evaluate LLMs and Agents" class=linkLabel_WmDU>Evaluate LLMs and Agents</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-top-level-category"><a class=menu__link href=/mlflow-website/docs/latest/genai/getting-started/try-assistant/><span title="Try MLflow Assistant" class=linkLabel_WmDU>Try MLflow Assistant</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item"><b>Core Components</b><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/mlflow-website/docs/latest/genai/tracing/><span title="Tracing (Observability)" class=categoryLinkLabel_W154>Tracing (Observability)</span></a><button aria-label="Expand sidebar category 'Tracing (Observability)'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/mlflow-website/docs/latest/genai/eval-monitor/><span title="Evaluate & Monitor" class=categoryLinkLabel_W154>Evaluate & Monitor</span></a><button aria-label="Expand sidebar category 'Evaluate & Monitor'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/mlflow-website/docs/latest/genai/prompt-registry/><span title="Prompt Management" class=categoryLinkLabel_W154>Prompt Management</span></a><button aria-label="Expand sidebar category 'Prompt Management'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/mlflow-website/docs/latest/genai/governance/ai-gateway/><span title="AI Gateway" class=categoryLinkLabel_W154>AI Gateway</span></a><button aria-label="Expand sidebar category 'AI Gateway'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item"><b>More Features</b><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/mlflow-website/docs/latest/genai/version-tracking/><span title="Version Tracking" class=categoryLinkLabel_W154>Version Tracking</span></a><button aria-label="Expand sidebar category 'Version Tracking'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item sidebar-top-level-category"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href=/mlflow-website/docs/latest/genai/flavors/><span title="Packaging & Deployment" class=categoryLinkLabel_W154>Packaging & Deployment</span></a><button aria-label="Collapse sidebar category 'Packaging & Deployment'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex=0 href=/mlflow-website/docs/latest/genai/flavors/dspy/><span title=DSPy class=categoryLinkLabel_W154>DSPy</span></a><button aria-label="Expand sidebar category 'DSPy'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex=0 href=/mlflow-website/docs/latest/genai/flavors/langchain/><span title=LangChain class=categoryLinkLabel_W154>LangChain</span></a><button aria-label="Collapse sidebar category 'LangChain'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/mlflow-website/docs/latest/genai/flavors/langchain/guide/><span title="Guide to using LangChain with MLflow" class=linkLabel_WmDU>Guide to using LangChain with MLflow</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/mlflow-website/docs/latest/genai/flavors/langchain/notebooks/langchain-quickstart/><span title="LangChain Quickstart" class=linkLabel_WmDU>LangChain Quickstart</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/mlflow-website/docs/latest/genai/flavors/langchain/notebooks/langchain-retriever/><span title="Retrievers with LangChain" class=linkLabel_WmDU>Retrievers with LangChain</span></a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex=0 href=/mlflow-website/docs/latest/genai/flavors/llama-index/><span title=LlamaIndex class=categoryLinkLabel_W154>LlamaIndex</span></a><button aria-label="Expand sidebar category 'LlamaIndex'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex=0 href=/mlflow-website/docs/latest/genai/flavors/custom-pyfunc-for-llms/><span title="Custom Applications" class=categoryLinkLabel_W154>Custom Applications</span></a><button aria-label="Expand sidebar category 'Custom Applications'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/mlflow-website/docs/latest/genai/flavors/chat-model-intro/><span title="Intro to ChatModel" class=linkLabel_WmDU>Intro to ChatModel</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex=0 href=/mlflow-website/docs/latest/genai/flavors/chat-model-guide/><span title="Building with ChatModel" class=categoryLinkLabel_W154>Building with ChatModel</span></a><button aria-label="Expand sidebar category 'Building with ChatModel'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/mlflow-website/docs/latest/genai/flavors/responses-agent-intro/><span title="Building with ResponsesAgent" class=linkLabel_WmDU>Building with ResponsesAgent</span></a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/mlflow-website/docs/latest/genai/mcp/><span title=MCP class=categoryLinkLabel_W154>MCP</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/mlflow-website/docs/latest/genai/serving/><span title="Model Serving" class=categoryLinkLabel_W154>Model Serving</span></a><button aria-label="Expand sidebar category 'Model Serving'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item"><b>References</b><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/mlflow-website/docs/latest/genai/concepts/trace/><span title=Concepts class=categoryLinkLabel_W154>Concepts</span></a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-top-level-category"><a class=menu__link href=/mlflow-website/docs/latest/genai/references/request-features/><span title="Request Features" class=linkLabel_WmDU>Request Features</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-top-level-category"><a class=menu__link href=/mlflow-website/docs/latest/genai/getting-started/databricks-trial/><span title="Managed MLflow" class=linkLabel_WmDU>Managed MLflow</span></a></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><div class=breadcrumbsWrapper_xlkt><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/mlflow-website/docs/latest/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><a class=breadcrumbs__link href=/mlflow-website/docs/latest/genai/flavors/><span>Packaging & Deployment</span></a><li class=breadcrumbs__item><a class=breadcrumbs__link href=/mlflow-website/docs/latest/genai/flavors/langchain/><span>LangChain</span></a><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>LangChain Quickstart</span></ul></nav></div><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Introduction to Using LangChain with MLflow</h1></header>
<a class="button button--primary" style=margin-bottom:1rem;display:block;width:min-content href=https://raw.githubusercontent.com/mlflow/mlflow/master/docs/docs/genai/flavors/langchain/notebooks/langchain-quickstart.ipynb download="">Download this notebook</a>
<p>Welcome to this interactive tutorial designed to introduce you to <a href=https://python.langchain.com/docs/get_started/introduction target=_blank rel="noopener noreferrer" class="">LangChain</a> and its integration with MLflow. This tutorial is structured as a notebook to provide a hands-on, practical learning experience with the simplest and most core features of LangChain.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=what-you-will-learn>What You Will Learn<a href=#what-you-will-learn class=hash-link aria-label="Direct link to What You Will Learn" title="Direct link to What You Will Learn" translate=no>​</a></h3>
<ul>
<li class=""><strong>Understanding LangChain</strong>: Get to know the basics of LangChain and how it is used in developing applications powered by language models.</li>
<li class=""><strong>Chains in LangChain</strong>: Explore the concept of <code>chains</code> in LangChain, which are sequences of actions or operations orchestrated to perform complex tasks.</li>
<li class=""><strong>Integration with MLflow</strong>: Learn how LangChain integrates with MLflow, a platform for managing the machine learning lifecycle, including logging, tracking, and deploying models.</li>
<li class=""><strong>Practical Application</strong>: Apply your knowledge to build a LangChain chain that acts like a sous chef, focusing on the preparation steps of a recipe.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=background-on-langchain>Background on LangChain<a href=#background-on-langchain class=hash-link aria-label="Direct link to Background on LangChain" title="Direct link to Background on LangChain" translate=no>​</a></h3>
<p>LangChain is a Python-based framework that simplifies the development of applications using language models. It is designed to enhance context-awareness and reasoning in applications, allowing for more sophisticated and interactive functionalities.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=what-is-a-chain>What is a Chain?<a href=#what-is-a-chain class=hash-link aria-label="Direct link to What is a Chain?" title="Direct link to What is a Chain?" translate=no>​</a></h3>
<ul>
<li class=""><strong>Chain Definition</strong>: In LangChain, a <code>chain</code> refers to a series of interconnected components or steps designed to accomplish a specific task.</li>
<li class=""><strong>Chain Example</strong>: In our tutorial, we'll create a chain that simulates a sous chef's role in preparing ingredients and tools for a recipe.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=tutorial-overview>Tutorial Overview<a href=#tutorial-overview class=hash-link aria-label="Direct link to Tutorial Overview" title="Direct link to Tutorial Overview" translate=no>​</a></h3>
<p>In this tutorial, you will:</p>
<ol>
<li class=""><strong>Set Up LangChain and MLflow</strong>: Initialize and configure both LangChain and MLflow.</li>
<li class=""><strong>Create a Sous Chef Chain</strong>: Develop a LangChain chain that lists ingredients, describes preparation techniques, organizes ingredient staging, and details cooking implements preparation for a given recipe.</li>
<li class=""><strong>Log and Load the Model</strong>: Utilize MLflow to log the chain model and then load it for prediction.</li>
<li class=""><strong>Run a Prediction</strong>: Execute the chain to see how it would prepare a restaurant dish for a specific number of customers.</li>
</ol>
<p>By the end of this tutorial, you will have a solid foundation in using LangChain with MLflow and an understanding of how to construct and manage chains for practical applications.</p>
<p>Let's dive in and explore the world of LangChain and MLflow!</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=prerequisites>Prerequisites<a href=#prerequisites class=hash-link aria-label="Direct link to Prerequisites" title="Direct link to Prerequisites" translate=no>​</a></h3>
<p>In order to get started with this tutorial, we're going to need a few things first.</p>
<ol>
<li class="">An OpenAI API Account. You can <a href=https://platform.openai.com/login?launch target=_blank rel="noopener noreferrer" class="">sign up here</a> to get access in order to start programatically accessing one of the leading highly sophisticated LLM services on the planet.</li>
<li class="">An OpenAI API Key. You can access this once you've created an account by navigating <a href=https://platform.openai.com/api-keys target=_blank rel="noopener noreferrer" class="">to the API keys page</a>.</li>
<li class="">The OpenAI SDK. It's <a href=https://pypi.org/project/openai/ target=_blank rel="noopener noreferrer" class="">available on PyPI</a> here. For this tutorial, we're going to be using version 0.28.1 (the last release prior to the 1.0 release).</li>
<li class="">The LangChain package. You can <a href=https://pypi.org/project/langchain/ target=_blank rel="noopener noreferrer" class="">find it here on PyPI</a>.</li>
</ol>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=notebook-compatibility>Notebook compatibility<a href=#notebook-compatibility class=hash-link aria-label="Direct link to Notebook compatibility" title="Direct link to Notebook compatibility" translate=no>​</a></h4>
<p>With rapidly changing libraries such as <code>langchain</code>, examples can become outdated rather quickly and will no longer work. For the purposes of demonstration, here are the critical dependencies that are recommended to use to effectively run this notebook:</p>
<table><thead><tr><th style=text-align:left>Package<th style=text-align:left>Version<tbody><tr><td style=text-align:left>langchain<td style=text-align:left><strong>0.1.16</strong><tr><td style=text-align:left>lanchain-community<td style=text-align:left><strong>0.0.33</strong><tr><td style=text-align:left>langchain-openai<td style=text-align:left><strong>0.0.8</strong><tr><td style=text-align:left>openai<td style=text-align:left><strong>1.12.0</strong><tr><td style=text-align:left>tiktoken<td style=text-align:left><strong>0.6.0</strong><tr><td style=text-align:left>mlflow<td style=text-align:left><strong>2.12.1</strong></table>
<p>If you attempt to execute this notebook with different versions, it may function correctly, but it is recommended to use the precise versions above to ensure that your code executes properly.</p>
<p>To install the dependent packages simply run:</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for bash code with copy and toggle buttons"><span class=languageLabel_zr_I>bash</span></div><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">pip </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">openai</span><span class="token operator">==</span><span class="token number">1.12</span><span class="token plain">.0 </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">tiktoken</span><span class="token operator">==</span><span class="token number">0.6</span><span class="token plain">.0 </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">langchain</span><span class="token operator">==</span><span class="token number">0.1</span><span class="token plain">.16 langchain-openai</span><span class="token operator">==</span><span class="token number">0.0</span><span class="token plain">.33 langchain-community</span><span class="token operator">==</span><span class="token number">0.0</span><span class="token plain">.33 </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">mlflow</span><span class="token operator">==</span><span class="token number">2.12</span><span class="token plain">.1</span><br/></span></code></pre></div></div>
<blockquote>
<p>NOTE: This tutorial does not support openai&lt;1 and is not guaranteed to work with versions of langchain&lt;1.16.0</p>
</blockquote>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=api-key-security-overview>API Key Security Overview<a href=#api-key-security-overview class=hash-link aria-label="Direct link to API Key Security Overview" title="Direct link to API Key Security Overview" translate=no>​</a></h3>
<p>API keys, especially for SaaS Large Language Models (LLMs), are as sensitive as financial information due to their connection to billing.</p>
<p>If you're interested in learning more about an alternative MLflow solution that securely manages your access keys, <a href=https://www.mlflow.org/docs/latest/llms/deployments/index.html target=_blank rel="noopener noreferrer" class="">read about MLflow AI Gateway here</a>.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=essential-practices>Essential Practices:<a href=#essential-practices class=hash-link aria-label="Direct link to Essential Practices:" title="Direct link to Essential Practices:" translate=no>​</a></h4>
<ul>
<li class=""><strong>Confidentiality</strong>: Always keep API keys private.</li>
<li class=""><strong>Secure Storage</strong>: Prefer environment variables or secure services.</li>
<li class=""><strong>Frequent Rotation</strong>: Regularly update keys to avoid unauthorized access.</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=configuring-api-keys>Configuring API Keys<a href=#configuring-api-keys class=hash-link aria-label="Direct link to Configuring API Keys" title="Direct link to Configuring API Keys" translate=no>​</a></h4>
<p>For secure usage, set API keys as environment variables.</p>
<p><strong>macOS/Linux</strong>:
Refer to <a href=https://support.apple.com/en-gb/guide/terminal/apd382cc5fa-4f58-4449-b20a-41c53c006f8f/mac target=_blank rel="noopener noreferrer" class="">Apple's guide on using environment variables in Terminal</a> for detailed instructions.</p>
<p><strong>Windows</strong>:
Follow the steps outlined in <a href="https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_environment_variables?view=powershell-7.4" target=_blank rel="noopener noreferrer" class="">Microsoft's documentation on environment variables</a>.</p>
<div style=flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> os</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> langchain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">chains </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> LLMChain</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> langchain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">prompts </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> PromptTemplate</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> langchain_openai </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> OpenAI</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> mlflow</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">assert</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"OPENAI_API_KEY"</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"Please set the OPENAI_API_KEY environment variable."</span><br/></span></code></pre></div></div></div>
<blockquote>
<p><strong>NOTE: If you'd like to use Azure OpenAI with LangChain, you need to install <code>openai>=1.10.0</code> and <code>langchain-openai>=0.0.6</code>, as well as to specify the following credentials and parameters:</strong></p>
</blockquote>
<div style=flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token comment" style="color:rgb(98, 114, 164)"># NOTE: Only run this cell if you are using Azure interfaces with OpenAI. If you have a direct account with</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># OpenAI, ignore this cell.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> langchain_openai </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> AzureOpenAI</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> AzureOpenAIEmbeddings</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Set this to `azure`</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">"OPENAI_API_TYPE"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"azure"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># The API version you want to use: set this to `2023-05-15` for the released version.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">"OPENAI_API_VERSION"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"2023-05-15"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">assert</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"AZURE_OPENAI_ENDPOINT"</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">"Please set the AZURE_OPENAI_ENDPOINT environment variable. It is the base URL for your Azure OpenAI resource. You can find this in the Azure portal under your Azure OpenAI resource."</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">assert</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"OPENAI_API_KEY"</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">"Please set the OPENAI_API_KEY environment variable. It is the API key for your Azure OpenAI resource. You can find this in the Azure portal under your Azure OpenAI resource."</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">azure_openai_llm </span><span class="token operator">=</span><span class="token plain"> AzureOpenAI</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  deployment_name</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">"&lt;your-deployment-name>"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  model_name</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">"gpt-4o-mini"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">azure_openai_embeddings </span><span class="token operator">=</span><span class="token plain"> AzureOpenAIEmbeddings</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  azure_deployment</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">"&lt;your-deployment-name>"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br/></span></code></pre></div></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=configuring-the-openai-completions-model-in-langchain>Configuring the OpenAI Completions Model in LangChain<a href=#configuring-the-openai-completions-model-in-langchain class=hash-link aria-label="Direct link to Configuring the OpenAI Completions Model in LangChain" title="Direct link to Configuring the OpenAI Completions Model in LangChain" translate=no>​</a></h3>
<p>In this section of the tutorial, we have configured the OpenAI model with specific parameters suitable for generating language completions. We're using a Completions model, not ChatCompletions, which means each request is independent, and the entire prompt needs to be included every time to generate a response.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=understanding-the-completions-model>Understanding the Completions Model<a href=#understanding-the-completions-model class=hash-link aria-label="Direct link to Understanding the Completions Model" title="Direct link to Understanding the Completions Model" translate=no>​</a></h4>
<ul>
<li class="">
<p><strong>Completions Model</strong>: This model does not maintain contextual information across requests. It's ideal for tasks where each request is standalone and doesn't depend on past interactions. Offers flexibility for a variety of non-conversational applications.</p>
</li>
<li class="">
<p><strong>No Contextual Memory</strong>: The lack of memory of previous interactions means the model is best suited for one-off requests or scenarios where continuity of the conversation is not required.</p>
</li>
<li class="">
<p><strong>Comparisons with the ChatCompletions Model Type</strong>: Tailored for conversational AI, maintaining context across multiple exchanges for a continuous conversation. Suitable for chatbots or applications where dialogue history is crucial.</p>
</li>
</ul>
<p>In this tutorial, we use the Completions model for its simplicity and effectiveness in handling individual, independent requests, aligning with our tutorial's focus on preparation steps before cooking.</p>
<div style=flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">llm </span><span class="token operator">=</span><span class="token plain"> OpenAI</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">temperature</span><span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> max_tokens</span><span class="token operator">=</span><span class="token number">1000</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br/></span></code></pre></div></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=explanation-of-the-template-instruction-for-sous-chef-simulation>Explanation of the Template Instruction for Sous Chef Simulation<a href=#explanation-of-the-template-instruction-for-sous-chef-simulation class=hash-link aria-label="Direct link to Explanation of the Template Instruction for Sous Chef Simulation" title="Direct link to Explanation of the Template Instruction for Sous Chef Simulation" translate=no>​</a></h3>
<p>In this part of the tutorial, we have crafted a detailed prompt template that simulates the role of a fine dining sous chef. This template is designed to guide the LangChain model in preparing for a dish, focusing exclusively on the <a href=https://en.wikipedia.org/wiki/Mise_en_place target=_blank rel="noopener noreferrer" class="">mise-en-place</a> process.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=breakdown-of-the-template-instruction>Breakdown of the Template Instruction<a href=#breakdown-of-the-template-instruction class=hash-link aria-label="Direct link to Breakdown of the Template Instruction" title="Direct link to Breakdown of the Template Instruction" translate=no>​</a></h4>
<ul>
<li class="">
<p><strong>Sous Chef Roleplay</strong>: The prompt places the language model in the role of a sous chef, emphasizing meticulous preparation.</p>
</li>
<li class="">
<p><strong>Task Outline</strong>:</p>
<ol>
<li class=""><strong>List the Ingredients</strong>: Instructs the model to itemize all necessary ingredients for a given dish.</li>
<li class=""><strong>Preparation Techniques</strong>: Asks the model to describe necessary techniques for ingredient preparation, such as cutting and processing.</li>
<li class=""><strong>Ingredient Staging</strong>: Requires the model to provide detailed staging instructions for each ingredient, considering the sequence and timing of use.</li>
<li class=""><strong>Cooking Implements Preparation</strong>: Guides the model to list and prepare all cooking tools required for the dish's preparation phase.</li>
</ol>
</li>
<li class="">
<p><strong>Scope Limitation</strong>: The template is explicitly designed to stop at the preparation stage, avoiding the actual cooking process. It focuses on setting up everything needed for the chef to begin cooking.</p>
</li>
<li class="">
<p><strong>Dynamic Inputs</strong>: The template is adaptable to different recipes and customer counts, as indicated by placeholders <code>{recipe}</code> and <code>{customer_count}</code>.</p>
</li>
</ul>
<p>This template instruction is a key component of the tutorial, demonstrating how to leverage LangChain declaring instructive prompts with parametrized features geared toward single-purpose completions-style applications.</p>
<div style=flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">template_instruction </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">"Imagine you are a fine dining sous chef. Your task is to meticulously prepare for a dish, focusing on the mise-en-place process."</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">"Given a recipe, your responsibilities are: "</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">"1. List the Ingredients: Carefully itemize all ingredients required for the dish, ensuring every element is accounted for. "</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">"2. Preparation Techniques: Describe the techniques and operations needed for preparing each ingredient. This includes cutting, "</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">"processing, or any other form of preparation. Focus on the art of mise-en-place, ensuring everything is perfectly set up before cooking begins."</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">"3. Ingredient Staging: Provide detailed instructions on how to stage and arrange each ingredient. Explain where each item should be placed for "</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">"efficient access during the cooking process. Consider the timing and sequence of use for each ingredient. "</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">"4. Cooking Implements Preparation: Enumerate all the cooking tools and implements needed for each phase of the dish's preparation. "</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">"Detail any specific preparation these tools might need before the actual cooking starts and describe what pots, pans, dishes, and "</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">"other tools will be needed for the final preparation."</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">"Remember, your guidance stops at the preparation stage. Do not delve into the actual cooking process of the dish. "</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">"Your goal is to set the stage flawlessly for the chef to execute the cooking seamlessly."</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">"The recipe you are given is for: {recipe} for {customer_count} people. "</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br/></span></code></pre></div></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=constructing-the-langchain-chain>Constructing the LangChain Chain<a href=#constructing-the-langchain-chain class=hash-link aria-label="Direct link to Constructing the LangChain Chain" title="Direct link to Constructing the LangChain Chain" translate=no>​</a></h3>
<p>We start by setting up a <code>PromptTemplate</code> in LangChain, tailored to our sous chef scenario. The template is designed to dynamically accept inputs like the recipe name and customer count. Then, we initialize an <code>LLMChain</code> by combining our OpenAI language model with the prompt template, creating a chain that can simulate the sous chef's preparation process.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=logging-the-chain-in-mlflow>Logging the Chain in MLflow<a href=#logging-the-chain-in-mlflow class=hash-link aria-label="Direct link to Logging the Chain in MLflow" title="Direct link to Logging the Chain in MLflow" translate=no>​</a></h3>
<p>With the chain ready, we proceed to log it in MLflow. This is done within an MLflow run, which not only logs the chain model under a specified name but also tracks various details about the model. The logging process ensures that all aspects of the chain are recorded, allowing for efficient version control and future retrieval.</p>
<div style=flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">prompt </span><span class="token operator">=</span><span class="token plain"> PromptTemplate</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  input_variables</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">"recipe"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"customer_count"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  template</span><span class="token operator">=</span><span class="token plain">template_instruction</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">chain </span><span class="token operator">=</span><span class="token plain"> LLMChain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">llm</span><span class="token operator">=</span><span class="token plain">llm</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> prompt</span><span class="token operator">=</span><span class="token plain">prompt</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">set_experiment</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">"Cooking Assistant"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">with</span><span class="token plain"> mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">start_run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  model_info </span><span class="token operator">=</span><span class="token plain"> mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">langchain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">log_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">chain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> name</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">"langchain_model"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br/></span></code></pre></div></div></div>
<p>If we navigate to the MLflow UI, we'll see our logged LangChain model.</p>
<p><img decoding=async loading=lazy src=https://i.imgur.com/CeCeyp2.png alt="Our LangChain Model in the MLflow UI" class=img_ev3q /></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=loading-the-model-and-predicting-with-mlflow>Loading the Model and Predicting with MLflow<a href=#loading-the-model-and-predicting-with-mlflow class=hash-link aria-label="Direct link to Loading the Model and Predicting with MLflow" title="Direct link to Loading the Model and Predicting with MLflow" translate=no>​</a></h3>
<p>In this part of our tutorial, we demonstrate the practical application of the logged LangChain model using MLflow. We load the model and run a prediction for a specific dish, showcasing the model's ability to assist in culinary preparation.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=model-loading-and-execution>Model Loading and Execution<a href=#model-loading-and-execution class=hash-link aria-label="Direct link to Model Loading and Execution" title="Direct link to Model Loading and Execution" translate=no>​</a></h4>
<p>After logging our LangChain chain with MLflow, we proceed to load the model using MLflow's <code>pyfunc.load_model</code> function. This step is crucial as it brings our previously logged model into an executable state.</p>
<p>We then input a specific recipe along with the customer count into our model. In this case, we use the recipe for "boeuf bourginon" and specify that it's for 12 customers. The model, acting as a sous chef, processes this information and generates detailed preparation instructions.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=output-from-the-model>Output from the Model<a href=#output-from-the-model class=hash-link aria-label="Direct link to Output from the Model" title="Direct link to Output from the Model" translate=no>​</a></h4>
<p>The model's output provides a comprehensive guide on preparing "boeuf bourginon," covering several critical aspects:</p>
<ul>
<li class=""><strong>Ingredients List</strong>: A detailed enumeration of all necessary ingredients, quantified and tailored for the specified number of customers.</li>
<li class=""><strong>Preparation Techniques</strong>: Step-by-step instructions on how to prepare each ingredient, following the principles of mise-en-place.</li>
<li class=""><strong>Ingredient Staging</strong>: Guidance on how to organize and stage the ingredients, ensuring efficient access and use during the cooking process.</li>
<li class=""><strong>Cooking Implements Preparation</strong>: Instructions on preparing the necessary cooking tools and implements, from pots and pans to bowls and colanders.</li>
</ul>
<p>This example demonstrates the power and utility of combining LangChain and MLflow in a practical scenario. It highlights how such an integration can effectively translate complex requirements into actionable steps, aiding in tasks that require precision and careful planning.</p>
<div style=flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">loaded_model </span><span class="token operator">=</span><span class="token plain"> mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pyfunc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">load_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">model_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">model_uri</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">dish1 </span><span class="token operator">=</span><span class="token plain"> loaded_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string" style="color:rgb(255, 121, 198)">"recipe"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"boeuf bourginon"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"customer_count"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"4"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">dish1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br/></span></code></pre></div></div></div>
<pre style=margin:0;border-radius:0;background:none;font-size:0.85rem;flex-grow:1;padding:var(--padding-sm)>

1. Ingredients:
- 2 pounds beef chuck, cut into 1-inch cubes
- 6 slices of bacon, diced
- 2 tablespoons olive oil
- 1 onion, diced
- 2 carrots, diced
- 2 cloves of garlic, minced
- 1 tablespoon tomato paste
- 1 bottle of red wine
- 2 cups beef broth
- 1 bouquet garni (thyme, bay leaf, parsley)
- 1 pound pearl onions, peeled
- 1 pound mushrooms, quartered
- Salt and pepper to taste
- Chopped parsley for garnish

2. Preparation Techniques:
- Cut the beef chuck into 1-inch cubes and set aside.
- Dice the bacon and set aside.
- Peel and dice the onion and carrots.
- Mince the garlic cloves.
- Prepare the bouquet garni by tying together a few sprigs of thyme, a bay leaf, and a few sprigs of parsley with kitchen twine.
- Peel the pearl onions and quarter the mushrooms.

3. Ingredient Staging:
- Place the beef cubes in a bowl and season with salt and pepper.
- In a large Dutch oven, heat the olive oil over medium-high heat.
- Add the diced bacon and cook until crispy.
- Remove the bacon from the pot and set aside.
- In the same pot, add the seasoned beef cubes and cook until browned on all sides.
- Remove the beef from the pot and set aside.
- In the same pot, add the diced onion and carrots and cook until softened.
- Add the minced garlic and cook for an additional minute.
- Stir in the tomato paste and cook for another minute.
- Add the beef and bacon back into the pot.
- Pour in the red wine and beef broth.
- Add the bouquet garni and bring to a simmer.
- Cover the pot and let it simmer for 2 hours, stirring occasionally.
- After 2 hours, add the pearl onions and mushrooms to the pot.
- Continue to simmer for an additional hour, or until the beef is tender.
- Remove the bouquet garni and discard.
- Taste and adjust seasoning with salt and pepper if needed.
- Garnish with chopped parsley before serving.

4. Cooking Implements Preparation:
- Large Dutch oven or heavy-bottomed pot
- Kitchen twine
- Cutting board
- Chef's knife
- Wooden spoon
- Measuring cups and spoons
- Bowls for prepped ingredients
- Tongs for handling meat
- Ladle for serving
- Serving dishes for the final dish.</pre>
<div style=flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">dish2 </span><span class="token operator">=</span><span class="token plain"> loaded_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string" style="color:rgb(255, 121, 198)">"recipe"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"Okonomiyaki"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"customer_count"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"12"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">dish2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br/></span></code></pre></div></div></div>
<pre style=margin:0;border-radius:0;background:none;font-size:0.85rem;flex-grow:1;padding:var(--padding-sm)>


Ingredients:
- 2 cups all-purpose flour
- 2 teaspoons baking powder
- 1/2 teaspoon salt
- 2 eggs
- 1 1/2 cups water
- 1/2 head cabbage, thinly sliced
- 1/2 cup green onions, thinly sliced
- 1/2 cup carrots, grated
- 1/2 cup red bell pepper, thinly sliced
- 1/2 cup cooked shrimp, chopped
- 1/2 cup cooked bacon, chopped
- 1/2 cup pickled ginger, chopped
- 1/2 cup tenkasu (tempura flakes)
- 1/2 cup mayonnaise
- 1/4 cup okonomiyaki sauce
- 1/4 cup katsuobushi (dried bonito flakes)
- Vegetable oil for cooking

Preparation Techniques:
1. In a large mixing bowl, combine the flour, baking powder, and salt.
2. In a separate bowl, beat the eggs and water together.
3. Slowly pour the egg mixture into the flour mixture, stirring until well combined.
4. Set the batter aside to rest for 10 minutes.
5. Thinly slice the cabbage, green onions, and red bell pepper.
6. Grate the carrots.
7. Chop the cooked shrimp, bacon, and pickled ginger.
8. Prepare the tenkasu, mayonnaise, okonomiyaki sauce, and katsuobushi.

Ingredient Staging:
1. Place the sliced cabbage, green onions, carrots, red bell pepper, shrimp, bacon, and pickled ginger in separate bowls.
2. Arrange the tenkasu, mayonnaise, okonomiyaki sauce, and katsuobushi in small dishes.
3. Set up a large griddle or non-stick pan for cooking the okonomiyaki.

Cooking Implements Preparation:
1. Make sure the griddle or pan is clean and dry.
2. Heat the griddle or pan over medium heat.
3. Have a spatula, tongs, and a large plate ready for flipping and serving the okonomiyaki.
4. Prepare a large plate or platter for serving the finished okonomiyaki.

Remember, mise-en-place is key to a successful dish. Make sure all ingredients are prepped and ready to go before starting the cooking process. Happy cooking!</pre>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=conclusion>Conclusion<a href=#conclusion class=hash-link aria-label="Direct link to Conclusion" title="Direct link to Conclusion" translate=no>​</a></h3>
<p>In the final step of our tutorial, we execute another prediction using our LangChain model. This time, we explore the preparation for "Okonomiyaki," a Japanese dish, for 12 customers. This demonstrates the model's adaptability and versatility across various cuisines.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=additional-prediction-with-the-loaded-model>Additional Prediction with the Loaded Model<a href=#additional-prediction-with-the-loaded-model class=hash-link aria-label="Direct link to Additional Prediction with the Loaded Model" title="Direct link to Additional Prediction with the Loaded Model" translate=no>​</a></h4>
<p>The model processes the input for "Okonomiyaki" and outputs detailed preparation steps. This includes listing the ingredients, explaining the preparation techniques, guiding ingredient staging, and detailing the required cooking implements, showcasing the model's capability to handle diverse recipes with precision.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id=what-weve-learned>What We've Learned<a href=#what-weve-learned class=hash-link aria-label="Direct link to What We've Learned" title="Direct link to What We've Learned" translate=no>​</a></h4>
<ul>
<li class=""><strong>Model Versatility</strong>: The tutorial highlighted the LangChain framework for assembling component parts of a basic LLM application, chaining a specific instructional prompt to a Completions-style LLM.</li>
<li class=""><strong>MLflow's Role in Model Management</strong>: The integration of LangChain with MLflow demonstrated effective model lifecycle management, from creation and logging to prediction execution.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=closing-thoughts>Closing Thoughts<a href=#closing-thoughts class=hash-link aria-label="Direct link to Closing Thoughts" title="Direct link to Closing Thoughts" translate=no>​</a></h3>
<p>This tutorial offered an insightful journey through creating, managing, and utilizing a LangChain model with MLflow for culinary preparation. It showcased the practical applications and adaptability of LangChain in complex scenarios. We hope this experience has provided valuable knowledge and encourages you to further explore and innovate using LangChain and MLflow in your projects. Happy coding!</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=whats-next>What's next?<a href=#whats-next class=hash-link aria-label="Direct link to What's next?" title="Direct link to What's next?" translate=no>​</a></h3>
<p>To continue learning about the capabilities of MLflow and LangChain in more complex examples, we encourage you to continue your learning with <a href=https://www.mlflow.org/docs/latest/llms/langchain/index.html#advanced-tutorials target=_blank rel="noopener noreferrer" class="">the additional LangChain tutorials</a>.</div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href=https://github.com/mlflow/mlflow/edit/master/docs/docs/genai/flavors/langchain/notebooks/langchain-quickstart.ipynb target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/mlflow-website/docs/latest/genai/flavors/langchain/guide/><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>Guide to using LangChain with MLflow</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/mlflow-website/docs/latest/genai/flavors/langchain/notebooks/langchain-retriever/><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>Retrievers with LangChain</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#what-you-will-learn class="table-of-contents__link toc-highlight">What You Will Learn</a><li><a href=#background-on-langchain class="table-of-contents__link toc-highlight">Background on LangChain</a><li><a href=#what-is-a-chain class="table-of-contents__link toc-highlight">What is a Chain?</a><li><a href=#tutorial-overview class="table-of-contents__link toc-highlight">Tutorial Overview</a><li><a href=#prerequisites class="table-of-contents__link toc-highlight">Prerequisites</a><li><a href=#api-key-security-overview class="table-of-contents__link toc-highlight">API Key Security Overview</a><li><a href=#configuring-the-openai-completions-model-in-langchain class="table-of-contents__link toc-highlight">Configuring the OpenAI Completions Model in LangChain</a><li><a href=#explanation-of-the-template-instruction-for-sous-chef-simulation class="table-of-contents__link toc-highlight">Explanation of the Template Instruction for Sous Chef Simulation</a><li><a href=#constructing-the-langchain-chain class="table-of-contents__link toc-highlight">Constructing the LangChain Chain</a><li><a href=#logging-the-chain-in-mlflow class="table-of-contents__link toc-highlight">Logging the Chain in MLflow</a><li><a href=#loading-the-model-and-predicting-with-mlflow class="table-of-contents__link toc-highlight">Loading the Model and Predicting with MLflow</a><li><a href=#conclusion class="table-of-contents__link toc-highlight">Conclusion</a><li><a href=#closing-thoughts class="table-of-contents__link toc-highlight">Closing Thoughts</a><li><a href=#whats-next class="table-of-contents__link toc-highlight">What's next?</a></ul></div></div></div></div></main></div></div></div><footer class="relative pb-30 flex flex-col pt-30 bg-bottom bg-no-repeat bg-cover bg-size-[auto_360px] 2xl:bg-size-[100%_360px] bg-brand-black"><div style="position:absolute;width:100%;bottom:0;pointer-events:none;mask-composite:intersect;height:360px;background-image:repeating-linear-gradient(
        to right,
        rgba(0, 0, 0, 0.05),
        rgba(0, 0, 0, 0.25) 18px,
        transparent 2px,
        transparent 10px
      ),
      radial-gradient(
        circle at bottom center,
        oklch(0.6 0.22 30.59) 0%,
        transparent 60%
      ),
      linear-gradient(to right, color-mix(in srgb, oklch(0.6 0.22 30.59), black 10%), color-mix(in srgb, oklch(0.6 0.22 30.59), oklch(0.91 0.09 326.28) 40%));mask-image:radial-gradient(ellipse at center bottom, black 60%, transparent 80%),
      linear-gradient(to top, black 10%, transparent 40%)"></div><div class=z-1><div class="flex flex-row justify-between items-start md:items-center px-6 lg:px-20 gap-10 xs:gap-0 max-w-container"><div class="flex flex-col gap-8"><svg xmlns=http://www.w3.org/2000/svg width=109 height=40 fill=none viewBox="0 0 109 40" class="h-[36px] shrink-0"><path fill=#fff d="M0 31.032v-15.53h3.543v1.968c.893-1.594 2.84-2.425 4.593-2.425 2.042 0 3.828.926 4.658 2.745 1.216-2.043 3.034-2.745 5.043-2.745 2.81 0 5.49 1.787 5.49 5.904v10.083h-3.574v-9.478c0-1.818-.926-3.19-3-3.19-1.947 0-3.224 1.53-3.224 3.445v9.22H9.893v-9.475c0-1.786-.898-3.18-3.003-3.18-1.977 0-3.223 1.467-3.223 3.444v9.221ZM27.855 31.032V7.929h3.703v23.103ZM30.07 39.487c.833.232 1.582.383 3.17.383 2.953 0 6.436-1.665 7.353-6.339l3.786-18.739h5.629l.687-3.117h-5.686l.765-3.725c.586-2.892 2.186-4.358 4.754-4.358.668 0 .48.058 1.076.17L52.427.57c-.793-.237-1.503-.379-3.049-.379a7.32 7.32 0 0 0-4.528 1.484c-1.441 1.114-2.393 2.75-2.827 4.863l-1.066 5.137h-5.034l-.411 3.12h4.823L36.859 32.12c-.383 1.965-1.5 4.315-4.708 4.315-.727 0-.463-.055-1.121-.162ZM53.342 30.905H49.64l5.074-23.309h3.701ZM71.807 16.477A7.962 7.962 0 0 0 60.97 27.904l2.425-1.78a5.005 5.005 0 0 1 3.845-8.145v1.895ZM62.618 29.472a7.962 7.962 0 0 0 10.836-11.428l-2.425 1.78a5.005 5.005 0 0 1-3.845 8.145v-1.894ZM78.092 15.493h4.044l.823 10.612 5.759-10.612 3.839.055 1.508 10.557 5.074-10.612 3.701.055-7.678 15.493H91.46l-1.783-11.106-5.895 11.106h-3.84ZM105.072 15.768h-.766v-.266h1.845v.272h-.765v2.243h-.314ZM106.614 15.502h.383l.482 1.34q.091.259.178.524h.018c.059-.176.113-.352.172-.524l.478-1.34h.383v2.515h-.298V16.63c0-.22.024-.523.04-.747h-.016l-.191.574-.475 1.304h-.208l-.481-1.302-.191-.574h-.015c.017.224.042.527.042.747v1.387h-.291Z"/></svg><div class="text-xs text-left md:text-nowrap md:w-0">© 2025 MLflow Project, a Series of LF Projects, LLC.</div></div><div class="flex flex-col flex-wrap justify-end md:text-right md:flex-row gap-x-10 lg:gap-x-20 gap-y-5 w-2/5 md:w-auto md:pt-2 max-w-fit"><div><a href=https://mlflow.org target=_blank rel="noopener noreferrer" class="text-[15px] font-medium no-underline hover:no-underline transition-opacity hover:opacity-80 text-white visited:text-white">Components</a></div><div><a href=https://mlflow.org/releases target=_blank rel="noopener noreferrer" class="text-[15px] font-medium no-underline hover:no-underline transition-opacity hover:opacity-80 text-white visited:text-white">Releases</a></div><div><a href=https://mlflow.org/blog target=_blank rel="noopener noreferrer" class="text-[15px] font-medium no-underline hover:no-underline transition-opacity hover:opacity-80 text-white visited:text-white">Blog</a></div><div><a class="text-[15px] font-medium no-underline hover:no-underline transition-opacity hover:opacity-80 text-white visited:text-white" href=/mlflow-website/docs/latest/>Docs</a></div><div><a href=https://mlflow.org/ambassadors target=_blank rel="noopener noreferrer" class="text-[15px] font-medium no-underline hover:no-underline transition-opacity hover:opacity-80 text-white visited:text-white">Ambassador Program</a></div></div></div></div></footer></div></body>