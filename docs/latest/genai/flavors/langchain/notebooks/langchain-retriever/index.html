<!doctype html><html lang=en dir=ltr class="docs-wrapper plugin-docs plugin-id-genai docs-version-current docs-doc-page docs-doc-id-flavors/langchain/notebooks/langchain-retriever-ipynb" data-has-hydrated=false><head><meta charset=UTF-8><meta name=generator content="Docusaurus v3.9.2"><title data-rh=true>Introduction to RAG with MLflow and LangChain | MLflow</title><meta data-rh=true name=viewport content="width=device-width, initial-scale=1.0"/><meta data-rh=true name=twitter:card content=summary_large_image /><meta data-rh=true property=og:url content=https://mlflow.org/mlflow-website/docs/latest/genai/flavors/langchain/notebooks/langchain-retriever/ /><meta data-rh=true property=og:locale content=en /><meta data-rh=true name=docusaurus_locale content=en /><meta data-rh=true name=docsearch:language content=en /><meta data-rh=true name=docusaurus_version content=current /><meta data-rh=true name=docusaurus_tag content=docs-genai-current /><meta data-rh=true name=docsearch:version content=current /><meta data-rh=true name=docsearch:docusaurus_tag content=docs-genai-current /><meta data-rh=true property=og:title content="Introduction to RAG with MLflow and LangChain | MLflow"/><meta data-rh=true name=description content="Download this notebook"/><meta data-rh=true property=og:description content="Download this notebook"/><link data-rh=true rel=icon href=/mlflow-website/docs/latest/images/favicon.ico /><link data-rh=true rel=canonical href=https://mlflow.org/mlflow-website/docs/latest/genai/flavors/langchain/notebooks/langchain-retriever/ /><link data-rh=true rel=alternate href=https://mlflow.org/mlflow-website/docs/latest/genai/flavors/langchain/notebooks/langchain-retriever/ hreflang=en /><link data-rh=true rel=alternate href=https://mlflow.org/mlflow-website/docs/latest/genai/flavors/langchain/notebooks/langchain-retriever/ hreflang=x-default /><link data-rh=true rel=preconnect href=https://XKVLO8P882-dsn.algolia.net crossorigin=anonymous /><script data-rh=true type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://mlflow.org/mlflow-website/docs/latest/genai/flavors/","name":"Packaging & Deployment","position":1},{"@type":"ListItem","item":"https://mlflow.org/mlflow-website/docs/latest/genai/flavors/langchain/","name":"LangChain","position":2},{"@type":"ListItem","item":"https://mlflow.org/mlflow-website/docs/latest/genai/flavors/langchain/notebooks/langchain-retriever","name":"Retrievers with LangChain","position":3}]}</script><link rel=preconnect href=https://www.google-analytics.com><link rel=preconnect href=https://www.googletagmanager.com><script async src="https://www.googletagmanager.com/gtag/js?id=GTM-N6WMTTJ"></script><script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","GTM-N6WMTTJ",{anonymize_ip:!0}),gtag("config","AW-16857946923",{anonymize_ip:!0})</script><link rel=preconnect href=https://www.googletagmanager.com><script>window.dataLayer=window.dataLayer||[],function(e,t,a,n,r){e[n]=e[n]||[],e[n].push({"gtm.start":new Date().getTime(),event:"gtm.js"});var d=t.getElementsByTagName(a)[0],g=t.createElement(a);g.async=!0,g.src="https://www.googletagmanager.com/gtm.js?id="+r+("dataLayer"!=n?"&l="+n:""),d.parentNode.insertBefore(g,d)}(window,document,"script","dataLayer","GTM-N6WMTTJ")</script><link rel=search type=application/opensearchdescription+xml title=MLflow href=/mlflow-website/docs/latest/opensearch.xml><script src=/mlflow-website/docs/latest/js/runllm.js defer></script><link rel=stylesheet href=/mlflow-website/docs/latest/assets/css/styles.65681509.css /><script src=/mlflow-website/docs/latest/assets/js/runtime~main.a0db6d66.js defer></script><script src=/mlflow-website/docs/latest/assets/js/main.b1a0d118.js defer></script></head><body class=navigation-with-keyboard><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-N6WMTTJ" height=0 width=0 style=display:none;visibility:hidden></iframe></noscript>


<svg style="display: none;"><defs>
<symbol id=theme-svg-external-link viewBox="0 0 24 24"><path fill=currentColor d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{for(var[t,e]of new URLSearchParams(window.location.search).entries())if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id=__docusaurus><div role=region aria-label="Skip to main content"><a class=skipToContent_fXgn href=#__docusaurus_skipToContent_fallback>Skip to main content</a></div><nav aria-label=Main class="theme-layout-navbar navbar navbar--fixed-top"><div class=navbar__inner><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded=false class="navbar__toggle clean-btn" type=button><svg width=30 height=30 viewBox="0 0 30 30" aria-hidden=true><path stroke=currentColor stroke-linecap=round stroke-miterlimit=10 stroke-width=2 d="M4 7h22M4 15h22M4 23h22"/></svg></button><a class=navbar__brand href=/mlflow-website/docs/latest/><div class=navbar__logo><img src=/mlflow-website/docs/latest/images/logo-light.svg alt="MLflow Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"/><img src=/mlflow-website/docs/latest/images/logo-dark.svg alt="MLflow Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"/></div></a><div class="navbar__item dropdown dropdown--hoverable"><a href=# aria-haspopup=true aria-expanded=false role=button class="navbar__link docsDropdown_VGp6" data-active=genai><div style=display:flex;gap:8px;align-items:center><div class=dropdownCircle_n91F style=width:10px;height:10px;background-color:var(--genai-color-primary);border-radius:4px></div>GenAI Docs</div></a><ul class=dropdown__menu><li><a class="dropdown__link ml-docs-link" href=/mlflow-website/docs/latest/ml/><div style=display:flex;gap:8px;align-items:center><div style=width:10px;height:10px;background-color:var(--ml-color-primary);border-radius:4px></div>ML Docs</div></a><li><a aria-current=page class="dropdown__link genai-docs-link dropdown__link--active" href=/mlflow-website/docs/latest/genai/><div style=display:flex;gap:8px;align-items:center><div style=width:10px;height:10px;background-color:var(--genai-color-primary);border-radius:4px></div>GenAI Docs</div></a></ul></div><a href=https://mlflow.org/docs/latest/api_reference/index.html target=_blank rel="noopener noreferrer" class="navbar__item navbar__link">API Reference</a><a class="navbar__item navbar__link" href=/mlflow-website/docs/latest/self-hosting/>Self-Hosting</a><a class="navbar__item navbar__link" href=/mlflow-website/docs/latest/community/>Community</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href=https://github.com/mlflow/mlflow target=_blank rel="noopener noreferrer" class="navbar__item navbar__link github-link">GitHub<svg width=13.5 height=13.5 aria-label="(opens in new tab)" class=iconExternalLink_nPIU><use href=#theme-svg-external-link /></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type=button disabled title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill=currentColor d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill=currentColor d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"/></svg><svg viewBox="0 0 24 24" width=24 height=24 aria-hidden=true class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill=currentColor d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"/></svg></button></div><div class=navbarSearchContainer_Bca1><button type=button class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts=Meta+k><span class=DocSearch-Button-Container><svg width=20 height=20 class=DocSearch-Search-Icon viewBox="0 0 24 24" aria-hidden=true><circle cx=11 cy=11 r=8 stroke=currentColor fill=none stroke-width=1.4 /><path d="m21 21-4.3-4.3" stroke=currentColor fill=none stroke-linecap=round stroke-linejoin=round /></svg><span class=DocSearch-Button-Placeholder>Search</span></span><span class=DocSearch-Button-Keys></span></button></div></div></div><div role=presentation class=navbar-sidebar__backdrop></div></nav><div id=__docusaurus_skipToContent_fallback class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class=docsWrapper_hBAB><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type=button></button><div class=docRoot_UBD9><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class=sidebarViewport_aRkj><div class=sidebar_njMd><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-overview"><a class=menu__link href=/mlflow-website/docs/latest/genai/><span title=Overview class=linkLabel_WmDU>Overview</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item"><b>Getting Started</b><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-top-level-category"><a class=menu__link href=/mlflow-website/docs/latest/genai/getting-started/connect-environment/><span title="Set Up MLflow Server" class=linkLabel_WmDU>Set Up MLflow Server</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-top-level-category"><a class=menu__link href=/mlflow-website/docs/latest/genai/tracing/quickstart/><span title="Start Tracing" class=linkLabel_WmDU>Start Tracing</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-top-level-category"><a class=menu__link href=/mlflow-website/docs/latest/genai/eval-monitor/quickstart/><span title="Evaluate LLMs and Agents" class=linkLabel_WmDU>Evaluate LLMs and Agents</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-top-level-category"><a class=menu__link href=/mlflow-website/docs/latest/genai/getting-started/try-assistant/><span title="Try MLflow Assistant" class=linkLabel_WmDU>Try MLflow Assistant</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item"><b>Core Components</b><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/mlflow-website/docs/latest/genai/tracing/><span title="Tracing (Observability)" class=categoryLinkLabel_W154>Tracing (Observability)</span></a><button aria-label="Expand sidebar category 'Tracing (Observability)'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/mlflow-website/docs/latest/genai/eval-monitor/><span title="Evaluate & Monitor" class=categoryLinkLabel_W154>Evaluate & Monitor</span></a><button aria-label="Expand sidebar category 'Evaluate & Monitor'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/mlflow-website/docs/latest/genai/prompt-registry/><span title="Prompt Management" class=categoryLinkLabel_W154>Prompt Management</span></a><button aria-label="Expand sidebar category 'Prompt Management'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/mlflow-website/docs/latest/genai/governance/ai-gateway/><span title="AI Gateway" class=categoryLinkLabel_W154>AI Gateway</span></a><button aria-label="Expand sidebar category 'AI Gateway'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item"><b>More Features</b><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/mlflow-website/docs/latest/genai/version-tracking/><span title="Version Tracking" class=categoryLinkLabel_W154>Version Tracking</span></a><button aria-label="Expand sidebar category 'Version Tracking'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item sidebar-top-level-category"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href=/mlflow-website/docs/latest/genai/flavors/><span title="Packaging & Deployment" class=categoryLinkLabel_W154>Packaging & Deployment</span></a><button aria-label="Collapse sidebar category 'Packaging & Deployment'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex=0 href=/mlflow-website/docs/latest/genai/flavors/dspy/><span title=DSPy class=categoryLinkLabel_W154>DSPy</span></a><button aria-label="Expand sidebar category 'DSPy'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex=0 href=/mlflow-website/docs/latest/genai/flavors/langchain/><span title=LangChain class=categoryLinkLabel_W154>LangChain</span></a><button aria-label="Collapse sidebar category 'LangChain'" aria-expanded=true type=button class="clean-btn menu__caret"></button></div><ul class=menu__list><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/mlflow-website/docs/latest/genai/flavors/langchain/guide/><span title="Guide to using LangChain with MLflow" class=linkLabel_WmDU>Guide to using LangChain with MLflow</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class=menu__link tabindex=0 href=/mlflow-website/docs/latest/genai/flavors/langchain/notebooks/langchain-quickstart/><span title="LangChain Quickstart" class=linkLabel_WmDU>LangChain Quickstart</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current=page tabindex=0 href=/mlflow-website/docs/latest/genai/flavors/langchain/notebooks/langchain-retriever/><span title="Retrievers with LangChain" class=linkLabel_WmDU>Retrievers with LangChain</span></a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex=0 href=/mlflow-website/docs/latest/genai/flavors/llama-index/><span title=LlamaIndex class=categoryLinkLabel_W154>LlamaIndex</span></a><button aria-label="Expand sidebar category 'LlamaIndex'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex=0 href=/mlflow-website/docs/latest/genai/flavors/custom-pyfunc-for-llms/><span title="Custom Applications" class=categoryLinkLabel_W154>Custom Applications</span></a><button aria-label="Expand sidebar category 'Custom Applications'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/mlflow-website/docs/latest/genai/flavors/chat-model-intro/><span title="Intro to ChatModel" class=linkLabel_WmDU>Intro to ChatModel</span></a><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex=0 href=/mlflow-website/docs/latest/genai/flavors/chat-model-guide/><span title="Building with ChatModel" class=categoryLinkLabel_W154>Building with ChatModel</span></a><button aria-label="Expand sidebar category 'Building with ChatModel'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class=menu__link tabindex=0 href=/mlflow-website/docs/latest/genai/flavors/responses-agent-intro/><span title="Building with ResponsesAgent" class=linkLabel_WmDU>Building with ResponsesAgent</span></a></ul><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/mlflow-website/docs/latest/genai/mcp/><span title=MCP class=categoryLinkLabel_W154>MCP</span></a></div><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist" href=/mlflow-website/docs/latest/genai/serving/><span title="Model Serving" class=categoryLinkLabel_W154>Model Serving</span></a><button aria-label="Expand sidebar category 'Model Serving'" aria-expanded=false type=button class="clean-btn menu__caret"></button></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menuHtmlItem_M9Kj menu__list-item"><b>References</b><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class=menu__list-item-collapsible><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role=button aria-expanded=false href=/mlflow-website/docs/latest/genai/concepts/trace/><span title=Concepts class=categoryLinkLabel_W154>Concepts</span></a></div><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-top-level-category"><a class=menu__link href=/mlflow-website/docs/latest/genai/references/request-features/><span title="Request Features" class=linkLabel_WmDU>Request Features</span></a><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-top-level-category"><a class=menu__link href=/mlflow-website/docs/latest/genai/getting-started/databricks-trial/><span title="Managed MLflow" class=linkLabel_WmDU>Managed MLflow</span></a></ul></nav></div></div></aside><main class=docMainContainer_TBSr><div class="container padding-top--md padding-bottom--lg"><div class=row><div class="col docItemCol_VOVn"><div class=docItemContainer_Djhp><article><div class=breadcrumbsWrapper_xlkt><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label=Breadcrumbs><ul class=breadcrumbs><li class=breadcrumbs__item><a aria-label="Home page" class=breadcrumbs__link href=/mlflow-website/docs/latest/><svg viewBox="0 0 24 24" class=breadcrumbHomeIcon_YNFT><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill=currentColor /></svg></a><li class=breadcrumbs__item><a class=breadcrumbs__link href=/mlflow-website/docs/latest/genai/flavors/><span>Packaging & Deployment</span></a><li class=breadcrumbs__item><a class=breadcrumbs__link href=/mlflow-website/docs/latest/genai/flavors/langchain/><span>LangChain</span></a><li class="breadcrumbs__item breadcrumbs__item--active"><span class=breadcrumbs__link>Retrievers with LangChain</span></ul></nav></div><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type=button class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Introduction to RAG with MLflow and LangChain</h1></header>
<a class="button button--primary" style=margin-bottom:1rem;display:block;width:min-content href=https://raw.githubusercontent.com/mlflow/mlflow/master/docs/docs/genai/flavors/langchain/notebooks/langchain-retriever.ipynb download="">Download this notebook</a>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=tutorial-overview>Tutorial Overview<a href=#tutorial-overview class=hash-link aria-label="Direct link to Tutorial Overview" title="Direct link to Tutorial Overview" translate=no>​</a></h2>
<p>Welcome to this tutorial, where we explore the integration of Retrieval Augmented Generation (RAG) with MLflow and LangChain. Our focus is on demonstrating how to create advanced RAG systems and showcasing the unique capabilities enabled by MLflow in these applications.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=understanding-rag-and-how-to-develop-one-with-mlflow>Understanding RAG and how to develop one with MLflow<a href=#understanding-rag-and-how-to-develop-one-with-mlflow class=hash-link aria-label="Direct link to Understanding RAG and how to develop one with MLflow" title="Direct link to Understanding RAG and how to develop one with MLflow" translate=no>​</a></h3>
<p>Retrieval Augmented Generation (RAG) combines the power of language model generation with information retrieval, allowing language models to access and incorporate external data. This approach significantly enriches the model's responses with detailed and context-specific information.</p>
<p>MLflow is instrumental in this process. As an open-source platform, it facilitates the logging, tracking, and deployment of complex models, including RAG chains. With MLflow, integrating LangChain becomes more streamlined, enhancing the development, evaluation, and deployment processes of RAG models.</p>
<blockquote>
<p>NOTE: In this tutorial, we'll be using GPT-3.5 as our base language model. It's important to note that the results obtained from a RAG system will differ from those obtained by interfacing directly with GPT models. RAG's unique approach of combining external data retrieval with language model generation creates more nuanced and contextually rich responses.</p>
</blockquote>
<p><img decoding=async loading=lazy src=https://i.imgur.com/uwo1PCj.png alt="" class=img_ev3q /></p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=learning-outcomes>Learning Outcomes<a href=#learning-outcomes class=hash-link aria-label="Direct link to Learning Outcomes" title="Direct link to Learning Outcomes" translate=no>​</a></h2>
<p>By the end of this tutorial, you will learn:</p>
<ul>
<li class="">How to establish a RAG chain using LangChain and MLflow.</li>
<li class="">Techniques for scraping and processing documents to feed into a RAG system.</li>
<li class="">Best practices for deploying and using RAG models to answer complex queries.</li>
<li class="">Understanding the practical implications and differences in responses when using RAG in comparison to direct language model interactions.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=setting-up-our-retriever-dependencies>Setting up our Retriever Dependencies<a href=#setting-up-our-retriever-dependencies class=hash-link aria-label="Direct link to Setting up our Retriever Dependencies" title="Direct link to Setting up our Retriever Dependencies" translate=no>​</a></h2>
<p>In order to have a place to store our vetted data (the information that we're going to be retrieving), we're going to use a Vector Database. The framework that we're choosing to use (due to its simplicity, capabilities, and free-to-use characteristics) is FAISS, from <strong>Meta</strong>.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=faiss-installation-for-the-tutorial>FAISS Installation for the Tutorial<a href=#faiss-installation-for-the-tutorial class=hash-link aria-label="Direct link to FAISS Installation for the Tutorial" title="Direct link to FAISS Installation for the Tutorial" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=understanding-faiss>Understanding FAISS<a href=#understanding-faiss class=hash-link aria-label="Direct link to Understanding FAISS" title="Direct link to Understanding FAISS" translate=no>​</a></h3>
<p>For this tutorial, we will be utilizing <a href=https://github.com/facebookresearch/faiss/wiki target=_blank rel="noopener noreferrer" class="">FAISS</a> (Facebook AI Similarity Search, developed and maintained by the <a href=https://ai.meta.com/tools/faiss/ target=_blank rel="noopener noreferrer" class="">Meta AI research group</a>), an efficient similarity search and clustering library. It's a highly useful library that easily handles large datasets and is capable of performing operations such as nearest neighbor search, which are critical in Retrieval Augmented Generation (RAG) systems. There are numerous other vector database solutions that can perform similar functionality; we are using FAISS in this tutorial due to its simplicity, ease of use, and fantastic performance.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=notebook-compatibility>Notebook compatibility<a href=#notebook-compatibility class=hash-link aria-label="Direct link to Notebook compatibility" title="Direct link to Notebook compatibility" translate=no>​</a></h2>
<p>With rapidly changing libraries such as <code>langchain</code>, examples can become outdated rather quickly and will no longer work. For the purposes of demonstration, here are the critical dependencies that are recommended to use to effectively run this notebook:</p>
<table><thead><tr><th style=text-align:left>Package<th style=text-align:left>Version<tbody><tr><td style=text-align:left>langchain<td style=text-align:left><strong>0.1.16</strong><tr><td style=text-align:left>lanchain-community<td style=text-align:left><strong>0.0.33</strong><tr><td style=text-align:left>langchain-openai<td style=text-align:left><strong>0.0.8</strong><tr><td style=text-align:left>openai<td style=text-align:left><strong>1.12.0</strong><tr><td style=text-align:left>tiktoken<td style=text-align:left><strong>0.6.0</strong><tr><td style=text-align:left>mlflow<td style=text-align:left><strong>2.12.1</strong><tr><td style=text-align:left>faiss-cpu<td style=text-align:left><strong>1.7.4</strong></table>
<p>If you attempt to execute this notebook with different versions, it may function correctly, but it is recommended to use the precise versions above to ensure that your code executes properly.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=installing-requirements>Installing Requirements<a href=#installing-requirements class=hash-link aria-label="Direct link to Installing Requirements" title="Direct link to Installing Requirements" translate=no>​</a></h3>
<p>Before proceeding with the tutorial, ensure that you have FAISS and <a href=https://pypi.org/project/beautifulsoup4/ target=_blank rel="noopener noreferrer" class="">Beautiful Soup</a> installed via <code>pip</code>. The version specifiers for other packages are guaranteed to work with this notebook. Other versions of these packages may not function correctly due to breaking changes their APIs.</p>
<div class="language-bash codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for bash code with copy and toggle buttons"><span class=languageLabel_zr_I>bash</span></div><pre tabindex=0 class="prism-code language-bash codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">    pip </span><span class="token function" style="color:rgb(80, 250, 123)">install</span><span class="token plain"> beautifulsoup4 faiss-cpu</span><span class="token operator">==</span><span class="token number">1.7</span><span class="token plain">.4 </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">langchain</span><span class="token operator">==</span><span class="token number">0.1</span><span class="token plain">.16 langchain-community</span><span class="token operator">==</span><span class="token number">0.0</span><span class="token plain">.33 langchain-openai</span><span class="token operator">==</span><span class="token number">0.0</span><span class="token plain">.8 </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">openai</span><span class="token operator">==</span><span class="token number">1.12</span><span class="token plain">.0 </span><span class="token assign-left variable" style="color:rgb(189, 147, 249);font-style:italic">tiktoken</span><span class="token operator">==</span><span class="token number">0.6</span><span class="token plain">.0</span><br/></span></code></pre></div></div>
<blockquote>
<p>NOTE: If you'd like to run this using your GPU, you can install <code>faiss-gpu</code> instead.</p>
</blockquote>
<div style=flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> os</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> shutil</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> tempfile</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> requests</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> bs4 </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> BeautifulSoup</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> langchain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">chains </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> RetrievalQA</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> langchain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">document_loaders </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> TextLoader</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> langchain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">text_splitter </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> CharacterTextSplitter</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> langchain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">vectorstores </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> FAISS</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> langchain_openai </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> OpenAI</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> OpenAIEmbeddings</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> mlflow</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">assert</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"OPENAI_API_KEY"</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"Please set the OPENAI_API_KEY environment variable."</span><br/></span></code></pre></div></div></div>
<blockquote>
<p><strong>NOTE: If you'd like to use Azure OpenAI with LangChain, you need to install <code>openai>=1.10.0</code> and <code>langchain-openai>=0.0.6</code>, as well as to specify the following credentials and parameters:</strong></p>
</blockquote>
<div style=flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> langchain_openai </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> AzureOpenAI</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> AzureOpenAIEmbeddings</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Set this to `azure`</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">"OPENAI_API_TYPE"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"azure"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># The API version you want to use: set this to `2023-05-15` for the released version.</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string" style="color:rgb(255, 121, 198)">"OPENAI_API_VERSION"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"> </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"2023-05-15"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">assert</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"AZURE_OPENAI_ENDPOINT"</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">"Please set the AZURE_OPENAI_ENDPOINT environment variable. It is the base URL for your Azure OpenAI resource. You can find this in the Azure portal under your Azure OpenAI resource."</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">assert</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"OPENAI_API_KEY"</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">"Please set the OPENAI_API_KEY environment variable. It is the API key for your Azure OpenAI resource. You can find this in the Azure portal under your Azure OpenAI resource."</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">azure_openai_llm </span><span class="token operator">=</span><span class="token plain"> AzureOpenAI</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  deployment_name</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">"&lt;your-deployment-name>"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  model_name</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">"gpt-4o-mini"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">azure_openai_embeddings </span><span class="token operator">=</span><span class="token plain"> AzureOpenAIEmbeddings</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  azure_deployment</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">"&lt;your-deployment-name>"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br/></span></code></pre></div></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=scraping-federal-documents-for-rag-processing>Scraping Federal Documents for RAG Processing<a href=#scraping-federal-documents-for-rag-processing class=hash-link aria-label="Direct link to Scraping Federal Documents for RAG Processing" title="Direct link to Scraping Federal Documents for RAG Processing" translate=no>​</a></h2>
<p>In this section of the tutorial, we will demonstrate how to scrape content from federal document webpages for use in our RAG system. We'll be focusing on extracting transcripts from specific sections of webpages, which will then be used to feed our Retrieval Augmented Generation (RAG) model. This process is crucial for providing the RAG system with relevant external data.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=function-overview>Function Overview<a href=#function-overview class=hash-link aria-label="Direct link to Function Overview" title="Direct link to Function Overview" translate=no>​</a></h3>
<ul>
<li class="">The function <code>fetch_federal_document</code> is designed to scrape and return the transcript of specific federal documents.</li>
<li class="">It takes two arguments: <code>url</code> (the webpage URL) and <code>div_class</code> (the class of the div element containing the transcript).</li>
<li class="">The function handles web requests, parses HTML content, and extracts the desired transcript text.</li>
</ul>
<p>This step is integral to building a RAG system that relies on external, context-specific data. By effectively fetching and processing this data, we can enrich our model's responses with accurate information directly sourced from authoritative documents.</p>
<blockquote>
<p><strong>NOTE</strong>: In a real-world scenario, you would have your specific text data located on disk somewhere (either locally or on your cloud provider) and the process of loading the embedded data into a vector search database would be entirely external to this active fetching displayed below. We're simply showing the entire process here for demonstration purposes to show the entire end-to-end workflow for interfacing with a RAG model.</p>
</blockquote>
<div style=flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">fetch_federal_document</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">url</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> div_class</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">"""</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">  Scrapes the transcript of the Act Establishing Yellowstone National Park from the given URL.</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="display:inline-block;color:rgb(255, 121, 198)"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">  Args:</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">  url (str): URL of the webpage to scrape.</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="display:inline-block;color:rgb(255, 121, 198)"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">  Returns:</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">  str: The transcript text of the Act.</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">  """</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Sending a request to the URL</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  response </span><span class="token operator">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">get</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">url</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">status_code </span><span class="token operator">==</span><span class="token plain"> </span><span class="token number">200</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># Parsing the HTML content of the page</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      soup </span><span class="token operator">=</span><span class="token plain"> BeautifulSoup</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">response</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">text</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"html.parser"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      </span><span class="token comment" style="color:rgb(98, 114, 164)"># Finding the transcript section by its HTML structure</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> transcript_section </span><span class="token operator">:=</span><span class="token plain"> soup</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">find</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">"div"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> class_</span><span class="token operator">=</span><span class="token plain">div_class</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">          transcript_text </span><span class="token operator">=</span><span class="token plain"> transcript_section</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">get_text</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">separator</span><span class="token operator">=</span><span class="token plain">"</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> strip</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">          </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> transcript_text</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">          </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"Transcript section not found."</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> </span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f"Failed to retrieve the webpage. Status code: </span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">response</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string-interpolation interpolation">status_code</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">"</span><br/></span></code></pre></div></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=document-fetching-and-faiss-database-creation>Document Fetching and FAISS Database Creation<a href=#document-fetching-and-faiss-database-creation class=hash-link aria-label="Direct link to Document Fetching and FAISS Database Creation" title="Direct link to Document Fetching and FAISS Database Creation" translate=no>​</a></h2>
<p>In this next part, we focus on two key processes:</p>
<ol>
<li class="">
<p><strong>Document Fetching</strong>:</p>
<ul>
<li class="">We use <code>fetch_and_save_documents</code> to retrieve documents from specified URLs.</li>
<li class="">This function takes a list of URLs and a file path as inputs.</li>
<li class="">Each document fetched from the URLs is appended to a single file at the given path.</li>
</ul>
</li>
<li class="">
<p><strong>FAISS Database Creation</strong>:</p>
<ul>
<li class=""><code>create_faiss_database</code> is responsible for creating a FAISS database from the documents saved in the previous step.</li>
<li class="">The function leverages <code>TextLoader</code> to load the text, <code>CharacterTextSplitter</code> for document splitting, and <code>OpenAIEmbeddings</code> for generating embeddings.</li>
<li class="">The resulting FAISS database, which facilitates efficient similarity searches, is saved to a specified directory and returned for further use.</li>
</ul>
</li>
</ol>
<p>These functions streamline the process of gathering relevant documents and setting up a FAISS database, essential for implementing advanced Retrieval-Augmented Generation (RAG) applications in MLflow. By modularizing these steps, we ensure code reusability and maintainability.</p>
<div style=flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">fetch_and_save_documents</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">url_list</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> doc_path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">"""</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">  Fetches documents from given URLs and saves them to a specified file path.</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="display:inline-block;color:rgb(255, 121, 198)"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">  Args:</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">      url_list (list): List of URLs to fetch documents from.</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">      doc_path (str): Path to the file where documents will be saved.</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">  """</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> url </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> url_list</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      document </span><span class="token operator">=</span><span class="token plain"> fetch_federal_document</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">url</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"col-sm-9"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">with</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">open</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">doc_path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"a"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">file</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">          </span><span class="token builtin" style="color:rgb(189, 147, 249)">file</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">write</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">document</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">create_faiss_database</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">document_path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> database_save_directory</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> chunk_size</span><span class="token operator">=</span><span class="token number">500</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> chunk_overlap</span><span class="token operator">=</span><span class="token number">10</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">"""</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">  Creates and saves a FAISS database using documents from the specified file.</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="display:inline-block;color:rgb(255, 121, 198)"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">  Args:</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">      document_path (str): Path to the file containing documents.</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">      database_save_directory (str): Directory where the FAISS database will be saved.</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">      chunk_size (int, optional): Size of each document chunk. Default is 500.</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">      chunk_overlap (int, optional): Overlap between consecutive chunks. Default is 10.</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="display:inline-block;color:rgb(255, 121, 198)"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">  Returns:</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">      FAISS database instance.</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">  """</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Load documents from the specified file</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  document_loader </span><span class="token operator">=</span><span class="token plain"> TextLoader</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">document_path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  raw_documents </span><span class="token operator">=</span><span class="token plain"> document_loader</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">load</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Split documents into smaller chunks with specified size and overlap</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  document_splitter </span><span class="token operator">=</span><span class="token plain"> CharacterTextSplitter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">chunk_size</span><span class="token operator">=</span><span class="token plain">chunk_size</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> chunk_overlap</span><span class="token operator">=</span><span class="token plain">chunk_overlap</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  document_chunks </span><span class="token operator">=</span><span class="token plain"> document_splitter</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">split_documents</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">raw_documents</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Generate embeddings for each document chunk</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  embedding_generator </span><span class="token operator">=</span><span class="token plain"> OpenAIEmbeddings</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  faiss_database </span><span class="token operator">=</span><span class="token plain"> FAISS</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">from_documents</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">document_chunks</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> embedding_generator</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># Save the FAISS database to the specified directory</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  faiss_database</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">save_local</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">database_save_directory</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> faiss_database</span><br/></span></code></pre></div></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=setting-up-the-working-environment-and-faiss-database>Setting Up the Working Environment and FAISS Database<a href=#setting-up-the-working-environment-and-faiss-database class=hash-link aria-label="Direct link to Setting Up the Working Environment and FAISS Database" title="Direct link to Setting Up the Working Environment and FAISS Database" translate=no>​</a></h2>
<p>This section of the tutorial deals with the setup for our Retrieval-Augmented Generation (RAG) application. We'll establish the working environment and create the necessary FAISS database:</p>
<ol>
<li class="">
<p><strong>Temporary Directory Creation</strong>:</p>
<ul>
<li class="">A temporary directory is created using <code>tempfile.mkdtemp()</code>. This directory serves as a workspace for storing our documents and the FAISS database.</li>
</ul>
</li>
<li class="">
<p><strong>Document Path and FAISS Index Directory</strong>:</p>
<ul>
<li class="">Paths for storing the fetched documents and FAISS database are defined within this temporary directory.</li>
</ul>
</li>
<li class="">
<p><strong>Document Fetching</strong>:</p>
<ul>
<li class="">We have a list of URLs (<code>url_listings</code>) containing the documents we need to fetch.</li>
<li class=""><code>fetch_and_save_documents</code> function is used to retrieve and save the documents from these URLs into a single file located at <code>doc_path</code>.</li>
</ul>
</li>
<li class="">
<p><strong>FAISS Database Creation</strong>:</p>
<ul>
<li class="">The <code>create_faiss_database</code> function is then called to create a FAISS database from the saved documents, using the default <code>chunk_size</code> and <code>chunk_overlap</code> values.</li>
<li class="">This database (<code>vector_db</code>) is crucial for the RAG process, as it enables efficient similarity searches on the loaded documents.</li>
</ul>
</li>
</ol>
<p>By the end of this process, we have all documents consolidated in a single location and a FAISS database ready to be used for retrieval purposes in our MLflow-enabled RAG application.</p>
<div style=flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">temporary_directory </span><span class="token operator">=</span><span class="token plain"> tempfile</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">mkdtemp</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">doc_path </span><span class="token operator">=</span><span class="token plain"> os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">join</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">temporary_directory</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"docs.txt"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">persist_dir </span><span class="token operator">=</span><span class="token plain"> os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">join</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">temporary_directory</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"faiss_index"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">url_listings </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">"https://www.archives.gov/milestone-documents/act-establishing-yellowstone-national-park#transcript"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token string" style="color:rgb(255, 121, 198)">"https://www.archives.gov/milestone-documents/sherman-anti-trust-act#transcript"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">fetch_and_save_documents</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">url_listings</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> doc_path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">vector_db </span><span class="token operator">=</span><span class="token plain"> create_faiss_database</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">doc_path</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> persist_dir</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br/></span></code></pre></div></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=establishing-retrievalqa-chain-and-logging-with-mlflow>Establishing RetrievalQA Chain and Logging with MLflow<a href=#establishing-retrievalqa-chain-and-logging-with-mlflow class=hash-link aria-label="Direct link to Establishing RetrievalQA Chain and Logging with MLflow" title="Direct link to Establishing RetrievalQA Chain and Logging with MLflow" translate=no>​</a></h2>
<p>In this final setup phase, we focus on creating the RetrievalQA chain and integrating it with MLflow:</p>
<ol>
<li class="">
<p><strong>Initializing the RetrievalQA Chain</strong>:</p>
<ul>
<li class="">The <code>RetrievalQA</code> chain is initialized using the OpenAI language model (<code>llm</code>) and the retriever from our previously created FAISS database (<code>vector_db.as_retriever()</code>).</li>
<li class="">This chain will use the OpenAI model for generating responses and the FAISS retriever for document-based information retrieval.</li>
</ul>
</li>
<li class="">
<p><strong>Loader Function for Retrieval</strong>:</p>
<ul>
<li class="">A <code>load_retriever</code> function is defined to load the retriever from the FAISS database saved in the specified directory.</li>
<li class="">This function is crucial for reloading the retriever when the model is used later.</li>
</ul>
</li>
<li class="">
<p><strong>Logging the Model with MLflow</strong>:</p>
<ul>
<li class="">The RetrievalQA chain is logged using <code>mlflow.langchain.log_model</code>.</li>
<li class="">This process includes specifying the <code>artifact_path</code>, the <code>loader_fn</code> for the retriever, and the <code>persist_dir</code> where the FAISS database is stored.</li>
<li class="">Logging the model with MLflow ensures it is tracked and can be easily retrieved for future use.</li>
</ul>
</li>
</ol>
<p>Through these steps, we successfully integrate a complex RAG application with MLflow, showcasing its capability to handle advanced NLP tasks.</p>
<div style=flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">set_experiment</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">"Legal RAG"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">retrievalQA </span><span class="token operator">=</span><span class="token plain"> RetrievalQA</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">from_llm</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">llm</span><span class="token operator">=</span><span class="token plain">OpenAI</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> retriever</span><span class="token operator">=</span><span class="token plain">vector_db</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">as_retriever</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Log the retrievalQA chain</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">load_retriever</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">persist_directory</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  embeddings </span><span class="token operator">=</span><span class="token plain"> OpenAIEmbeddings</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  vectorstore </span><span class="token operator">=</span><span class="token plain"> FAISS</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">load_local</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      persist_directory</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      embeddings</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      allow_dangerous_deserialization</span><span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain">  </span><span class="token comment" style="color:rgb(98, 114, 164)"># This is required to load the index from MLflow</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">return</span><span class="token plain"> vectorstore</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">as_retriever</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">with</span><span class="token plain"> mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">start_run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  model_info </span><span class="token operator">=</span><span class="token plain"> mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">langchain</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">log_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      retrievalQA</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      name</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">"retrieval_qa"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      loader_fn</span><span class="token operator">=</span><span class="token plain">load_retriever</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      persist_dir</span><span class="token operator">=</span><span class="token plain">persist_dir</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br/></span></code></pre></div></div></div>
<blockquote>
<p><strong>IMPORTANT</strong>: In order to load a stored vectorstore instance such as our FAISS instance above, we need to specify within the load function the argument <code>allow_dangeous_deserialization</code> to <code>True</code> in order for the load to succeed. This is due to a safety warning that was introduced in <code>langchain</code> for loading objects that have been serialized using <code>pickle</code> or <code>cloudpickle</code>. While this issue of remote code execution is not a risk with using MLflow, as the serialization and deserialization happens entirely via API and within your environment, the argument must be set in order to prevent an Exception from being thrown at load time.</p>
</blockquote>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=our-rag-application-in-the-mlflow-ui>Our RAG application in the MLflow UI<a href=#our-rag-application-in-the-mlflow-ui class=hash-link aria-label="Direct link to Our RAG application in the MLflow UI" title="Direct link to Our RAG application in the MLflow UI" translate=no>​</a></h2>
<p><img decoding=async loading=lazy src=https://i.imgur.com/u9zdkmM.png alt="Our Model in the UI" class=img_ev3q /></p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=testing-our-rag-model>Testing our RAG Model<a href=#testing-our-rag-model class=hash-link aria-label="Direct link to Testing our RAG Model" title="Direct link to Testing our RAG Model" translate=no>​</a></h3>
<p>Now that we have the model stored in MLflow, we can load it back as a <code>pyfunc</code> and see how well it answers a few critically important questions about these acts of Congress in America.</p>
<div style=flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">loaded_model </span><span class="token operator">=</span><span class="token plain"> mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pyfunc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">load_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">model_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">model_uri</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br/></span></code></pre></div></div></div>
<div style=flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">def</span><span class="token plain"> </span><span class="token function" style="color:rgb(80, 250, 123)">print_formatted_response</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">response_list</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> max_line_length</span><span class="token operator">=</span><span class="token number">80</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">"""</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">  Formats and prints responses with a maximum line length for better readability.</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="display:inline-block;color:rgb(255, 121, 198)"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">  Args:</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">  response_list (list): A list of strings representing responses.</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">  max_line_length (int): Maximum number of characters in a line. Defaults to 80.</span><br/></span><span class=token-line style=color:#F8F8F2><span class="token triple-quoted-string string" style="color:rgb(255, 121, 198)">  """</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> response </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> response_list</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      words </span><span class="token operator">=</span><span class="token plain"> response</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">split</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      line </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">""</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> word </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> words</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">          </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">if</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">len</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">line</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> </span><span class="token builtin" style="color:rgb(189, 147, 249)">len</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">word</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"> </span><span class="token operator">+</span><span class="token plain"> </span><span class="token number">1</span><span class="token plain"> </span><span class="token operator">&lt;=</span><span class="token plain"> max_line_length</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">              line </span><span class="token operator">+=</span><span class="token plain"> word </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">" "</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">          </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">else</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">              </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">line</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">              line </span><span class="token operator">=</span><span class="token plain"> word </span><span class="token operator">+</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">" "</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">print</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">line</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br/></span></code></pre></div></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=lets-make-sure-that-this-thing-works>Let's make sure that this thing works<a href=#lets-make-sure-that-this-thing-works class=hash-link aria-label="Direct link to Let's make sure that this thing works" title="Direct link to Let's make sure that this thing works" translate=no>​</a></h2>
<p>Let's try out our Retriever model by sending it a fairly simple but purposefully vague question.</p>
<div style=flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">answer1 </span><span class="token operator">=</span><span class="token plain"> loaded_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string" style="color:rgb(255, 121, 198)">"query"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"What does the document say about trespassers?"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">print_formatted_response</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">answer1</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br/></span></code></pre></div></div></div>
<pre style=margin:0;border-radius:0;background:none;font-size:0.85rem;flex-grow:1;padding:var(--padding-sm)>
The document states that all persons who shall locate or settle upon or occupy 
the land reserved for the public park, except as provided, shall be considered 
trespassers and removed from the park.</pre>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=understanding-the-retrievalqa-response>Understanding the RetrievalQA Response<a href=#understanding-the-retrievalqa-response class=hash-link aria-label="Direct link to Understanding the RetrievalQA Response" title="Direct link to Understanding the RetrievalQA Response" translate=no>​</a></h2>
<p>With this model, our approach combines text retrieval from a database with language model generation to answer specific queries.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=how-it-works>How It Works:<a href=#how-it-works class=hash-link aria-label="Direct link to How It Works:" title="Direct link to How It Works:" translate=no>​</a></h3>
<ul>
<li class=""><strong>RetrievalQA Model</strong>: This model, a part of the LangChain suite, is designed to first retrieve relevant information from a predefined database and then use a language model to generate a response based on this information.</li>
<li class=""><strong>Database Integration</strong>: In this example, we've created a FAISS database from historical documents, such as the Act Establishing Yellowstone National Park. This database is used by the RetrievalQA model to find relevant sections of text.</li>
<li class=""><strong>Query Processing</strong>: When we execute <code>loaded_model.predict([{"query": "What does the document say about trespassers?"}])</code>, the model first searches the database for parts of the document that are most relevant to the query about trespassers.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=why-is-this-response-different>Why Is This Response Different?<a href=#why-is-this-response-different class=hash-link aria-label="Direct link to Why Is This Response Different?" title="Direct link to Why Is This Response Different?" translate=no>​</a></h3>
<ul>
<li class=""><strong>Context-Specific Answers</strong>: Unlike a direct query to GPT-3.5, which might generate an answer based on its training data without specific context, the RetrievalQA model provides a response directly derived from the specific documents in the database.</li>
<li class=""><strong>Accurate and Relevant</strong>: The response is more accurate and contextually relevant because it's based on the actual content of the specific document being queried.</li>
<li class=""><strong>No Generalization</strong>: There's less generalization or assumption in the response. The RetrievalQA model is not "guessing" based on its training; it's providing information directly sourced from the document.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=key-takeaway>Key Takeaway:<a href=#key-takeaway class=hash-link aria-label="Direct link to Key Takeaway:" title="Direct link to Key Takeaway:" translate=no>​</a></h3>
<ul>
<li class="">This methodology demonstrates how MLflow and LangChain facilitate complex RAG use cases, where direct interaction with historical or specific texts yields more precise answers than generic language model predictions.</li>
<li class="">The tutorial highlights how leveraging RAG can be particularly useful in scenarios where responses need to be grounded in specific texts or documents, showcasing a powerful blend of retrieval and generation capabilities.</li>
</ul>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=analyzing-the-bridle-path-query-response>Analyzing the Bridle-Path Query Response<a href=#analyzing-the-bridle-path-query-response class=hash-link aria-label="Direct link to Analyzing the Bridle-Path Query Response" title="Direct link to Analyzing the Bridle-Path Query Response" translate=no>​</a></h2>
<p>This section of the tutorial showcases an interesting aspect of the RetrievalQA model's capabilities, particularly in handling queries that involve both specific information retrieval and additional context generation.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=query-and-response-breakdown>Query and Response Breakdown:<a href=#query-and-response-breakdown class=hash-link aria-label="Direct link to Query and Response Breakdown:" title="Direct link to Query and Response Breakdown:" translate=no>​</a></h3>
<ul>
<li class=""><strong>Query</strong>: The user asks, "What is a bridle-path and can I use one at Yellowstone?"</li>
<li class=""><strong>Response</strong>: The model responds by explaining what a bridle-path is and confirms that bridle-paths can be used at Yellowstone based on the act.</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=understanding-the-response-dynamics>Understanding the Response Dynamics:<a href=#understanding-the-response-dynamics class=hash-link aria-label="Direct link to Understanding the Response Dynamics:" title="Direct link to Understanding the Response Dynamics:" translate=no>​</a></h3>
<ol>
<li class="">
<p><strong>Combining Document Data with LLM Context</strong>:</p>
<ul>
<li class="">The query about bridle-paths isn't directly answered in the act establishing Yellowstone.</li>
<li class="">The model uses its language understanding capabilities to provide a definition of a bridle-path.</li>
<li class="">It then merges this information with the context it retrieves from the FAISS database about the act, particularly regarding the construction of roads and bridle-paths in the park.</li>
</ul>
</li>
<li class="">
<p><strong>Enhanced Contextual Understanding</strong>:</p>
<ul>
<li class="">The RetrievalQA model demonstrates an ability to supplement direct information from the database with additional context through its language model.</li>
<li class="">This approach provides a more comprehensive answer that aligns with the user's query, showing a blend of document-specific data and general knowledge.</li>
</ul>
</li>
<li class="">
<p><strong>Why This Is Notable</strong>:</p>
<ul>
<li class="">Unlike a standard LLM response, the RetrievalQA model doesn't solely rely on its training data for general responses.</li>
<li class="">It effectively integrates specific document information with broader contextual understanding, offering a more nuanced answer.</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=key-takeaway-1>Key Takeaway:<a href=#key-takeaway-1 class=hash-link aria-label="Direct link to Key Takeaway:" title="Direct link to Key Takeaway:" translate=no>​</a></h3>
<ul>
<li class="">This example highlights how MLflow and LangChain, through the RetrievalQA model, facilitate a sophisticated response mechanism. The model not only retrieves relevant document information but also intelligently fills in gaps with its own language understanding capabilities.</li>
<li class="">Such a response mechanism is particularly useful when dealing with queries that require both specific document references and additional contextual information, showcasing the advanced capabilities of RAG in practical applications.</li>
</ul>
<div style=flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">answer2 </span><span class="token operator">=</span><span class="token plain"> loaded_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string" style="color:rgb(255, 121, 198)">"query"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"What is a bridle-path and can I use one at Yellowstone?"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">print_formatted_response</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">answer2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br/></span></code></pre></div></div></div>
<pre style=margin:0;border-radius:0;background:none;font-size:0.85rem;flex-grow:1;padding:var(--padding-sm)>
A bridle-path is a narrow path or trail designed for horseback riding. Yes, you 
can use a bridle-path at Yellowstone as it is designated for the enjoyment and 
benefit of the people visiting the park. However, it may be subject to certain 
regulations and restrictions set by the Secretary of the Interior.</pre>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=a-most-serious-question>A most serious question<a href=#a-most-serious-question class=hash-link aria-label="Direct link to A most serious question" title="Direct link to A most serious question" translate=no>​</a></h2>
<p>In this section of our tutorial, we delve into a whimsically ridiculous query and how our model tackles it with a blend of accuracy and a hint of humor.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=query-overview>Query Overview:<a href=#query-overview class=hash-link aria-label="Direct link to Query Overview:" title="Direct link to Query Overview:" translate=no>​</a></h3>
<ul>
<li class=""><strong>The Query</strong>: "Can I buy Yellowstone from the Federal Government to set up a buffalo-themed day spa?"</li>
<li class=""><strong>The Response</strong>: The model, with a straight face, responds, "No, you cannot buy Yellowstone from the Federal Government to set up a buffalo-themed day spa."</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=a-peek-into-the-models-thought-process>A Peek into the Model's Thought Process:<a href=#a-peek-into-the-models-thought-process class=hash-link aria-label="Direct link to A Peek into the Model's Thought Process:" title="Direct link to A Peek into the Model's Thought Process:" translate=no>​</a></h3>
<ol>
<li class="">
<p><strong>Direct and No-Nonsense Response</strong>:</p>
<ul>
<li class="">Despite the query's comedic undertone, the model gives a direct and clear-cut response. It's like the model is saying, "Nice try, but no, you can't do that."</li>
<li class="">This highlights the model's ability to remain factual, even when faced with a question that's clearly more humorous than serious.</li>
</ul>
</li>
<li class="">
<p><strong>Understanding Legal Boundaries</strong>:</p>
<ul>
<li class="">The response respects the legal and regulatory sanctity of national parks. It seems our model takes the protection of national treasures like Yellowstone pretty seriously!</li>
<li class="">The model's training on legal and general knowledge assists in delivering a response that's accurate, albeit the question being a facetious one.</li>
</ul>
</li>
<li class="">
<p><strong>Contrast with Traditional LLM Responses</strong>:</p>
<ul>
<li class="">A traditional LLM might have given a more generic answer. In contrast, our model, equipped with context-specific data, promptly debunks the whimsical idea of buying a national park for a spa.</li>
</ul>
</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=a-dash-of-humor-in-learning>A Dash of Humor in Learning:<a href=#a-dash-of-humor-in-learning class=hash-link aria-label="Direct link to A Dash of Humor in Learning:" title="Direct link to A Dash of Humor in Learning:" translate=no>​</a></h3>
<ul>
<li class="">The query, while absurd, serves as an amusing example of the model's capability to provide contextually relevant answers to even the most far-fetched questions.</li>
<li class="">It's a reminder that learning can be both informative and entertaining. In this case, the model plays the role of a straight-faced comedian, addressing a wildly imaginative business proposal with a firm yet comical "No."</li>
</ul>
<p>So, while you can't buy Yellowstone for your buffalo-themed spa dreams, you can certainly enjoy the park's natural beauty... just as a visitor, not as a spa owner!</p>
<div style=flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">answer3 </span><span class="token operator">=</span><span class="token plain"> loaded_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">"query"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"Can I buy Yellowstone from the Federal Government to set up a buffalo-themed day spa?"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">print_formatted_response</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">answer3</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br/></span></code></pre></div></div></div>
<pre style=margin:0;border-radius:0;background:none;font-size:0.85rem;flex-grow:1;padding:var(--padding-sm)>
No, you cannot buy Yellowstone from the Federal Government to set up a 
buffalo-themed day spa. The land near the headwaters of the Yellowstone River 
has been reserved and withdrawn from settlement, occupancy, or sale under the 
laws of the United States and dedicated and set apart as a public park for the 
benefit and enjoyment of the people. The Secretary of the Interior has control 
over the park and is responsible for making and publishing rules and 
regulations for its management. Leases for building purposes are only granted 
for small parcels of ground for the accommodation of visitors, and the proceeds 
are used for the management of the park and the construction of roads and 
bridle-paths. Additionally, the wanton destruction of fish and game within the 
park is prohibited. Furthermore, the Act to protect trade and commerce against 
unlawful restraints and monopolies (approved July 2, 1890) states that any 
contract, combination, or conspiracy in restraint of trade or commerce in any 
Territory or the District of Columbia is illegal. Thus, buying land to set up a 
buffalo-themed day spa would likely be considered a violation of this act.</pre>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=maintaining-composure-answering-another-whimsical-query>Maintaining Composure: Answering Another Whimsical Query<a href=#maintaining-composure-answering-another-whimsical-query class=hash-link aria-label="Direct link to Maintaining Composure: Answering Another Whimsical Query" title="Direct link to Maintaining Composure: Answering Another Whimsical Query" translate=no>​</a></h2>
<p>In this part of our tutorial, we explore another amusing question about leasing land in Yellowstone for a buffalo-themed day spa. Let's see how our model, with unflappable composure, responds to this quirky inquiry.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=query-and-response>Query and Response:<a href=#query-and-response class=hash-link aria-label="Direct link to Query and Response:" title="Direct link to Query and Response:" translate=no>​</a></h3>
<ul>
<li class=""><strong>The Query</strong>: "Can I lease a small parcel of land from the Federal Government for a small buffalo-themed day spa for visitors to the park?"</li>
<li class=""><strong>The Response</strong>: "No, you cannot lease a small parcel of land from the Federal Government for a small buffalo-themed day spa for visitors to the park..."</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=insights-into-the-models-response>Insights into the Model's Response:<a href=#insights-into-the-models-response class=hash-link aria-label="Direct link to Insights into the Model's Response:" title="Direct link to Insights into the Model's Response:" translate=no>​</a></h3>
<ol>
<li class="">
<p><strong>Factual and Unwavering</strong>:</p>
<ul>
<li class="">Despite the continued outlandish line of questioning, our model remains as cool as a cucumber. It patiently explains the limitations and actual purposes of leasing land in Yellowstone.</li>
<li class="">The response cites Section 2 of the act, adding legal precision to its rebuttal.</li>
</ul>
</li>
<li class="">
<p><strong>A Lawyer's Patience Tested?</strong>:</p>
<ul>
<li class="">Imagine if this question was posed to an actual lawyer. By now, they might be rubbing their temples! But our model is unfazed and continues to provide factual answers.</li>
<li class="">This showcases the model's ability to handle repetitive and unusual queries without losing its 'cool'.</li>
</ul>
</li>
</ol>
<p>In conclusion, while our model firmly closes the door on the buffalo-themed day spa dreams, it does so with informative grace, demonstrating its ability to stay on course no matter how imaginative the queries get.</p>
<div style=flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">answer4 </span><span class="token operator">=</span><span class="token plain"> loaded_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">"query"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"Can I lease a small parcel of land from the Federal Government for a small "</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">"buffalo-themed day spa for visitors to the park?"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">print_formatted_response</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">answer4</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br/></span></code></pre></div></div></div>
<pre style=margin:0;border-radius:0;background:none;font-size:0.85rem;flex-grow:1;padding:var(--padding-sm)>
No, according to the context provided, the Secretary of the Interior may grant 
leases for building purposes for terms not exceeding ten years, but only for 
the accommodation of visitors. It does not specifically mention a 
buffalo-themed day spa as a possible use for the leased land.</pre>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=another-attempt-at-the-buffalo-themed-day-spa-dream>Another Attempt at the Buffalo-Themed Day Spa Dream<a href=#another-attempt-at-the-buffalo-themed-day-spa-dream class=hash-link aria-label="Direct link to Another Attempt at the Buffalo-Themed Day Spa Dream" title="Direct link to Another Attempt at the Buffalo-Themed Day Spa Dream" translate=no>​</a></h2>
<p>Once more, we pose an imaginative question to our model, this time adding a hotel to the buffalo-themed day spa scenario. The reason for this modification is to evaluate whether the RAG application can discern a nuanced element of the intentionally vague wording of the two acts that we've loaded. Let's see the response to determine if it can resolve both bits of information!</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=quick-takeaway>Quick Takeaway:<a href=#quick-takeaway class=hash-link aria-label="Direct link to Quick Takeaway:" title="Direct link to Quick Takeaway:" translate=no>​</a></h3>
<ul>
<li class="">The model, sticking to its informative nature, clarifies the leasing aspects based on the Act's provisions.</li>
<li class="">It interestingly connects the query to another act related to trade and commerce, showing its ability to cross-reference related legal documents.</li>
<li class="">This response demonstrates the model's capacity to provide detailed, relevant information, even when faced with quirky and hypothetical scenarios.</li>
</ul>
<div style=flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">answer5 </span><span class="token operator">=</span><span class="token plain"> loaded_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">"query"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"Can I lease a small parcel of land from the Federal Government for a small "</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">"buffalo-themed day spa and hotel for visitors to stay in and relax at while visiting the park?"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">print_formatted_response</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">answer5</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br/></span></code></pre></div></div></div>
<pre style=margin:0;border-radius:0;background:none;font-size:0.85rem;flex-grow:1;padding:var(--padding-sm)>
No, it is not possible to lease land from the Federal Government for a 
commercial purpose within the designated park area. The Secretary of the 
Interior may grant leases for building purposes for terms not exceeding ten 
years, but only for small parcels of ground for the accommodation of visitors. 
Additionally, all proceeds from leases and other revenues must be used for the 
management of the park and the construction of roads and bridle-paths.</pre>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=well-what-can-i-do-then>Well, what can I do then?<a href=#well-what-can-i-do-then class=hash-link aria-label="Direct link to Well, what can I do then?" title="Direct link to Well, what can I do then?" translate=no>​</a></h2>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id=takeaway>Takeaway:<a href=#takeaway class=hash-link aria-label="Direct link to Takeaway:" title="Direct link to Takeaway:" translate=no>​</a></h3>
<ul>
<li class="">The response reassuringly confirms that one can enjoy Yellowstone's natural beauty, provided park rules and regulations are respected.</li>
<li class="">This illustrates the model's ability to provide straightforward, practical advice in response to simple, real-world questions. It clearly has the context of the original act and is able to infer what is permissible (enjoying the reserved land).</li>
</ul>
<div style=flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">answer6 </span><span class="token operator">=</span><span class="token plain"> loaded_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string" style="color:rgb(255, 121, 198)">"query"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"Can I just go to the park and peacefully enjoy the natural splendor?"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">print_formatted_response</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">answer6</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br/></span></code></pre></div></div></div>
<pre style=margin:0;border-radius:0;background:none;font-size:0.85rem;flex-grow:1;padding:var(--padding-sm)>
Yes, according to the context, the park was set apart as a public park or 
pleasuring-ground for the benefit and enjoyment of the people. However, the 
park is under the exclusive control of the Secretary of the Interior who has 
the authority to make and publish rules and regulations for the care and 
management of the park. Therefore, it is important to follow any rules or 
regulations set by the Secretary to ensure the preservation and protection of 
the park for future enjoyment.</pre>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=evaluating-the-retrievalqa-models-legal-context-integration>Evaluating the RetrievalQA Model's Legal Context Integration<a href=#evaluating-the-retrievalqa-models-legal-context-integration class=hash-link aria-label="Direct link to Evaluating the RetrievalQA Model's Legal Context Integration" title="Direct link to Evaluating the RetrievalQA Model's Legal Context Integration" translate=no>​</a></h2>
<p>This section of the tutorial showcases the RetrievalQA model's sophisticated ability to integrate and interpret context from multiple legal documents. The model is challenged with a query that requires synthesizing information from distinct sources. This test is particularly interesting for its demonstration of the model's proficiency in:</p>
<ol>
<li class="">
<p><strong>Contextual Integration</strong>: The model adeptly pulls in relevant legal details from different documents, illustrating its capacity to navigate through multiple sources of information.</p>
</li>
<li class="">
<p><strong>Legal Interpretation</strong>: It interprets the legal implications related to the query, highlighting the model's understanding of complex legal language and concepts.</p>
</li>
<li class="">
<p><strong>Cross-Document Inference</strong>: The model's ability to discern and extract the most pertinent information from a pool of multiple documents is a testament to its advanced capabilities in multi-document scenarios.</p>
</li>
</ol>
<p>This evaluation provides a clear example of the model's potential in handling intricate queries that necessitate a deep and nuanced understanding of diverse data sources.</p>
<div style=flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token plain">answer7 </span><span class="token operator">=</span><span class="token plain"> loaded_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">"query"</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">"Can I start a buffalo themed day spa outside of Yellowstone National Park and stifle any competition?"</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain" style=display:inline-block></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">print_formatted_response</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">answer7</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br/></span></code></pre></div></div></div>
<pre style=margin:0;border-radius:0;background:none;font-size:0.85rem;flex-grow:1;padding:var(--padding-sm)>
No, according to the context, any attempt to monopolize trade or commerce in 
the Yellowstone area or in any territory of the United States is considered 
illegal. Additionally, the park is under the exclusive control of the Secretary 
of the Interior, who may grant leases for building purposes but is expected to 
prevent the destruction of natural resources and the exploitation of fish and 
game for profit. Therefore, it would not be possible to start a buffalo themed 
day spa outside of Yellowstone National Park and stifle competition without 
violating the law and risking consequences from the Secretary of the Interior.</pre>
<p><strong>Cleanup: Removing Temporary Directory</strong>:</p>
<ul>
<li class="">After we're done asking our Retriever Model a bunch of silly questions, the temporary directory created earlier is cleaned up using <code>shutil.rmtree</code>.</li>
</ul>
<div style=flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style=--prism-color:#F8F8F2;--prism-background-color:#282A36><div class=codeBlockContent_bxn0><div class=codeBlockHeader_C_1e aria-label="Code block header for python code with copy and toggle buttons"><span class=languageLabel_zr_I>python</span></div><pre tabindex=0 class="prism-code language-python codeBlock_bY9V thin-scrollbar" style=color:#F8F8F2;background-color:#282A36><code class=codeBlockLines_e6Vv><span class=token-line style=color:#F8F8F2><span class="token comment" style="color:rgb(98, 114, 164)"># Clean up our temporary directory that we created with our FAISS instance</span><span class="token plain"></span><br/></span><span class=token-line style=color:#F8F8F2><span class="token plain">shutil</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">rmtree</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">temporary_directory</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br/></span></code></pre></div></div></div>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=conclusion-mastering-rag-with-mlflow>Conclusion: Mastering RAG with MLflow<a href=#conclusion-mastering-rag-with-mlflow class=hash-link aria-label="Direct link to Conclusion: Mastering RAG with MLflow" title="Direct link to Conclusion: Mastering RAG with MLflow" translate=no>​</a></h2>
<p>In this tutorial, we explored the depths of Retrieval Augmented Generation (RAG) applications, enabled and simplified by MLflow. Here's a recap of our journey and the key takeaways:</p>
<ol>
<li class="">
<p><strong>Ease of Developing RAG Applications</strong>: We learned how MLflow facilitates the development of RAG applications by streamlining the process of integrating large language models with external data sources. Our hands-on experience demonstrated the process of fetching, processing, and embedding documents into a FAISS database, all managed within the MLflow framework.</p>
</li>
<li class="">
<p><strong>Advanced Query Handling</strong>: Through our tests, we observed how the MLflow-wrapped LangChain RAG model adeptly handled complex queries, drawing from multiple documents to provide context-rich and accurate responses. This showcased the potential of RAG models in processing and understanding queries that require multi-source data integration.</p>
</li>
<li class="">
<p><strong>MLflow's Role in Deployment and Management</strong>: MLflow's robustness was evident in how it simplifies the logging, deployment, and management of complex models. Its ability to track experiments, manage artifacts, and ease the deployment process highlights its indispensability in the machine learning lifecycle.</p>
</li>
<li class="">
<p><strong>Practical Application Insights</strong>: Our queries, while humorous at times, served to illustrate the practical capabilities of RAG models. From legal interpretations to hypothetical scenarios, we saw how these models could be applied in real-world situations, providing insightful and contextually relevant responses.</p>
</li>
<li class="">
<p><strong>The Future of RAG and MLflow</strong>: This tutorial underscored the potential of combining RAG with MLflow's streamlined management capabilities. As RAG continues to evolve, MLflow stands out as a crucial tool for harnessing its power, making advanced NLP applications more accessible and efficient.</p>
</li>
</ol>
<p>In summary, our journey through this tutorial has not only equipped us with the knowledge to develop and deploy RAG applications effectively but also opened our eyes to the vast possibilities that lie ahead in the realm of advanced NLP, all made more attainable through MLflow.</p>
<h2 class="anchor anchorTargetStickyNavbar_Vzrq" id=whats-next>What's next?<a href=#whats-next class=hash-link aria-label="Direct link to What's next?" title="Direct link to What's next?" translate=no>​</a></h2>
<p>If you'd like to learn more about how MLflow and LangChain integrate, see the other <a href=https://www.mlflow.org/docs/latest/llms/langchain/index.html#advanced-tutorials target=_blank rel="noopener noreferrer" class="">advanced tutorials for MLflow's LangChain flavor</a>.</div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href=https://github.com/mlflow/mlflow/edit/master/docs/docs/genai/flavors/langchain/notebooks/langchain-retriever.ipynb target=_blank rel="noopener noreferrer" class=theme-edit-this-page><svg fill=currentColor height=20 width=20 viewBox="0 0 40 40" class=iconEdit_Z9Sw aria-hidden=true><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"/></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href=/mlflow-website/docs/latest/genai/flavors/langchain/notebooks/langchain-quickstart/><div class=pagination-nav__sublabel>Previous</div><div class=pagination-nav__label>LangChain Quickstart</div></a><a class="pagination-nav__link pagination-nav__link--next" href=/mlflow-website/docs/latest/genai/flavors/llama-index/><div class=pagination-nav__sublabel>Next</div><div class=pagination-nav__label>MLflow LlamaIndex Flavor</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href=#tutorial-overview class="table-of-contents__link toc-highlight">Tutorial Overview</a><ul><li><a href=#understanding-rag-and-how-to-develop-one-with-mlflow class="table-of-contents__link toc-highlight">Understanding RAG and how to develop one with MLflow</a></ul><li><a href=#learning-outcomes class="table-of-contents__link toc-highlight">Learning Outcomes</a><li><a href=#setting-up-our-retriever-dependencies class="table-of-contents__link toc-highlight">Setting up our Retriever Dependencies</a><li><a href=#faiss-installation-for-the-tutorial class="table-of-contents__link toc-highlight">FAISS Installation for the Tutorial</a><ul><li><a href=#understanding-faiss class="table-of-contents__link toc-highlight">Understanding FAISS</a></ul><li><a href=#notebook-compatibility class="table-of-contents__link toc-highlight">Notebook compatibility</a><ul><li><a href=#installing-requirements class="table-of-contents__link toc-highlight">Installing Requirements</a></ul><li><a href=#scraping-federal-documents-for-rag-processing class="table-of-contents__link toc-highlight">Scraping Federal Documents for RAG Processing</a><ul><li><a href=#function-overview class="table-of-contents__link toc-highlight">Function Overview</a></ul><li><a href=#document-fetching-and-faiss-database-creation class="table-of-contents__link toc-highlight">Document Fetching and FAISS Database Creation</a><li><a href=#setting-up-the-working-environment-and-faiss-database class="table-of-contents__link toc-highlight">Setting Up the Working Environment and FAISS Database</a><li><a href=#establishing-retrievalqa-chain-and-logging-with-mlflow class="table-of-contents__link toc-highlight">Establishing RetrievalQA Chain and Logging with MLflow</a><li><a href=#our-rag-application-in-the-mlflow-ui class="table-of-contents__link toc-highlight">Our RAG application in the MLflow UI</a><ul><li><a href=#testing-our-rag-model class="table-of-contents__link toc-highlight">Testing our RAG Model</a></ul><li><a href=#lets-make-sure-that-this-thing-works class="table-of-contents__link toc-highlight">Let's make sure that this thing works</a><li><a href=#understanding-the-retrievalqa-response class="table-of-contents__link toc-highlight">Understanding the RetrievalQA Response</a><ul><li><a href=#how-it-works class="table-of-contents__link toc-highlight">How It Works:</a><li><a href=#why-is-this-response-different class="table-of-contents__link toc-highlight">Why Is This Response Different?</a><li><a href=#key-takeaway class="table-of-contents__link toc-highlight">Key Takeaway:</a></ul><li><a href=#analyzing-the-bridle-path-query-response class="table-of-contents__link toc-highlight">Analyzing the Bridle-Path Query Response</a><ul><li><a href=#query-and-response-breakdown class="table-of-contents__link toc-highlight">Query and Response Breakdown:</a><li><a href=#understanding-the-response-dynamics class="table-of-contents__link toc-highlight">Understanding the Response Dynamics:</a><li><a href=#key-takeaway-1 class="table-of-contents__link toc-highlight">Key Takeaway:</a></ul><li><a href=#a-most-serious-question class="table-of-contents__link toc-highlight">A most serious question</a><ul><li><a href=#query-overview class="table-of-contents__link toc-highlight">Query Overview:</a><li><a href=#a-peek-into-the-models-thought-process class="table-of-contents__link toc-highlight">A Peek into the Model's Thought Process:</a><li><a href=#a-dash-of-humor-in-learning class="table-of-contents__link toc-highlight">A Dash of Humor in Learning:</a></ul><li><a href=#maintaining-composure-answering-another-whimsical-query class="table-of-contents__link toc-highlight">Maintaining Composure: Answering Another Whimsical Query</a><ul><li><a href=#query-and-response class="table-of-contents__link toc-highlight">Query and Response:</a><li><a href=#insights-into-the-models-response class="table-of-contents__link toc-highlight">Insights into the Model's Response:</a></ul><li><a href=#another-attempt-at-the-buffalo-themed-day-spa-dream class="table-of-contents__link toc-highlight">Another Attempt at the Buffalo-Themed Day Spa Dream</a><ul><li><a href=#quick-takeaway class="table-of-contents__link toc-highlight">Quick Takeaway:</a></ul><li><a href=#well-what-can-i-do-then class="table-of-contents__link toc-highlight">Well, what can I do then?</a><ul><li><a href=#takeaway class="table-of-contents__link toc-highlight">Takeaway:</a></ul><li><a href=#evaluating-the-retrievalqa-models-legal-context-integration class="table-of-contents__link toc-highlight">Evaluating the RetrievalQA Model's Legal Context Integration</a><li><a href=#conclusion-mastering-rag-with-mlflow class="table-of-contents__link toc-highlight">Conclusion: Mastering RAG with MLflow</a><li><a href=#whats-next class="table-of-contents__link toc-highlight">What's next?</a></ul></div></div></div></div></main></div></div></div><footer class="relative pb-30 flex flex-col pt-30 bg-bottom bg-no-repeat bg-cover bg-size-[auto_360px] 2xl:bg-size-[100%_360px] bg-brand-black"><div style="position:absolute;width:100%;bottom:0;pointer-events:none;mask-composite:intersect;height:360px;background-image:repeating-linear-gradient(
        to right,
        rgba(0, 0, 0, 0.05),
        rgba(0, 0, 0, 0.25) 18px,
        transparent 2px,
        transparent 10px
      ),
      radial-gradient(
        circle at bottom center,
        oklch(0.6 0.22 30.59) 0%,
        transparent 60%
      ),
      linear-gradient(to right, color-mix(in srgb, oklch(0.6 0.22 30.59), black 10%), color-mix(in srgb, oklch(0.6 0.22 30.59), oklch(0.91 0.09 326.28) 40%));mask-image:radial-gradient(ellipse at center bottom, black 60%, transparent 80%),
      linear-gradient(to top, black 10%, transparent 40%)"></div><div class=z-1><div class="flex flex-row justify-between items-start md:items-center px-6 lg:px-20 gap-10 xs:gap-0 max-w-container"><div class="flex flex-col gap-8"><svg xmlns=http://www.w3.org/2000/svg width=109 height=40 fill=none viewBox="0 0 109 40" class="h-[36px] shrink-0"><path fill=#fff d="M0 31.032v-15.53h3.543v1.968c.893-1.594 2.84-2.425 4.593-2.425 2.042 0 3.828.926 4.658 2.745 1.216-2.043 3.034-2.745 5.043-2.745 2.81 0 5.49 1.787 5.49 5.904v10.083h-3.574v-9.478c0-1.818-.926-3.19-3-3.19-1.947 0-3.224 1.53-3.224 3.445v9.22H9.893v-9.475c0-1.786-.898-3.18-3.003-3.18-1.977 0-3.223 1.467-3.223 3.444v9.221ZM27.855 31.032V7.929h3.703v23.103ZM30.07 39.487c.833.232 1.582.383 3.17.383 2.953 0 6.436-1.665 7.353-6.339l3.786-18.739h5.629l.687-3.117h-5.686l.765-3.725c.586-2.892 2.186-4.358 4.754-4.358.668 0 .48.058 1.076.17L52.427.57c-.793-.237-1.503-.379-3.049-.379a7.32 7.32 0 0 0-4.528 1.484c-1.441 1.114-2.393 2.75-2.827 4.863l-1.066 5.137h-5.034l-.411 3.12h4.823L36.859 32.12c-.383 1.965-1.5 4.315-4.708 4.315-.727 0-.463-.055-1.121-.162ZM53.342 30.905H49.64l5.074-23.309h3.701ZM71.807 16.477A7.962 7.962 0 0 0 60.97 27.904l2.425-1.78a5.005 5.005 0 0 1 3.845-8.145v1.895ZM62.618 29.472a7.962 7.962 0 0 0 10.836-11.428l-2.425 1.78a5.005 5.005 0 0 1-3.845 8.145v-1.894ZM78.092 15.493h4.044l.823 10.612 5.759-10.612 3.839.055 1.508 10.557 5.074-10.612 3.701.055-7.678 15.493H91.46l-1.783-11.106-5.895 11.106h-3.84ZM105.072 15.768h-.766v-.266h1.845v.272h-.765v2.243h-.314ZM106.614 15.502h.383l.482 1.34q.091.259.178.524h.018c.059-.176.113-.352.172-.524l.478-1.34h.383v2.515h-.298V16.63c0-.22.024-.523.04-.747h-.016l-.191.574-.475 1.304h-.208l-.481-1.302-.191-.574h-.015c.017.224.042.527.042.747v1.387h-.291Z"/></svg><div class="text-xs text-left md:text-nowrap md:w-0">© 2025 MLflow Project, a Series of LF Projects, LLC.</div></div><div class="flex flex-col flex-wrap justify-end md:text-right md:flex-row gap-x-10 lg:gap-x-20 gap-y-5 w-2/5 md:w-auto md:pt-2 max-w-fit"><div><a href=https://mlflow.org target=_blank rel="noopener noreferrer" class="text-[15px] font-medium no-underline hover:no-underline transition-opacity hover:opacity-80 text-white visited:text-white">Components</a></div><div><a href=https://mlflow.org/releases target=_blank rel="noopener noreferrer" class="text-[15px] font-medium no-underline hover:no-underline transition-opacity hover:opacity-80 text-white visited:text-white">Releases</a></div><div><a href=https://mlflow.org/blog target=_blank rel="noopener noreferrer" class="text-[15px] font-medium no-underline hover:no-underline transition-opacity hover:opacity-80 text-white visited:text-white">Blog</a></div><div><a class="text-[15px] font-medium no-underline hover:no-underline transition-opacity hover:opacity-80 text-white visited:text-white" href=/mlflow-website/docs/latest/>Docs</a></div><div><a href=https://mlflow.org/ambassadors target=_blank rel="noopener noreferrer" class="text-[15px] font-medium no-underline hover:no-underline transition-opacity hover:opacity-80 text-white visited:text-white">Ambassador Program</a></div></div></div></div></footer></div></body>