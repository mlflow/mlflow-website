<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-genai docs-version-current docs-doc-page docs-doc-id-flavors/openai/notebooks/openai-chat-completions-ipynb" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.9.2">
<title data-rh="true">Introduction: Advancing Communication with GPT-4 and MLflow | MLflow</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://mlflow.org/mlflow-website/docs/latest/genai/flavors/openai/notebooks/openai-chat-completions/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-genai-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-genai-current"><meta data-rh="true" property="og:title" content="Introduction: Advancing Communication with GPT-4 and MLflow | MLflow"><meta data-rh="true" name="description" content="Download this notebook"><meta data-rh="true" property="og:description" content="Download this notebook"><link data-rh="true" rel="icon" href="/mlflow-website/docs/latest/images/favicon.ico"><link data-rh="true" rel="canonical" href="https://mlflow.org/mlflow-website/docs/latest/genai/flavors/openai/notebooks/openai-chat-completions/"><link data-rh="true" rel="alternate" href="https://mlflow.org/mlflow-website/docs/latest/genai/flavors/openai/notebooks/openai-chat-completions/" hreflang="en"><link data-rh="true" rel="alternate" href="https://mlflow.org/mlflow-website/docs/latest/genai/flavors/openai/notebooks/openai-chat-completions/" hreflang="x-default"><link data-rh="true" rel="preconnect" href="https://XKVLO8P882-dsn.algolia.net" crossorigin="anonymous"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Version Tracking","item":"https://mlflow.org/mlflow-website/docs/latest/genai/version-tracking/"},{"@type":"ListItem","position":2,"name":"App Packaging & Deployment","item":"https://mlflow.org/mlflow-website/docs/latest/genai/flavors/"},{"@type":"ListItem","position":3,"name":"OpenAI","item":"https://mlflow.org/mlflow-website/docs/latest/genai/flavors/openai/"},{"@type":"ListItem","position":4,"name":"Tutorials","item":"https://mlflow.org/mlflow-website/docs/latest/genai/flavors/openai/notebooks/"},{"@type":"ListItem","position":5,"name":"Chat Completions with OpenAI","item":"https://mlflow.org/mlflow-website/docs/latest/genai/flavors/openai/notebooks/openai-chat-completions"}]}</script><link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=GTM-N6WMTTJ"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","GTM-N6WMTTJ",{anonymize_ip:!0}),gtag("config","AW-16857946923",{anonymize_ip:!0})</script>
<link rel="preconnect" href="https://www.googletagmanager.com">
<script>window.dataLayer=window.dataLayer||[]</script>
<script>!function(e,t,a,n){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var g=t.getElementsByTagName(a)[0],m=t.createElement(a);m.async=!0,m.src="https://www.googletagmanager.com/gtm.js?id=GTM-N6WMTTJ",g.parentNode.insertBefore(m,g)}(window,document,"script","dataLayer")</script>



<link rel="search" type="application/opensearchdescription+xml" title="MLflow" href="/mlflow-website/docs/latest/opensearch.xml">







<script src="/mlflow-website/docs/latest/js/runllm.js" defer="defer"></script><link rel="stylesheet" href="/mlflow-website/docs/latest/assets/css/styles.c780cf79.css">
<script src="/mlflow-website/docs/latest/assets/js/runtime~main.5763c3be.js" defer="defer"></script>
<script src="/mlflow-website/docs/latest/assets/js/main.cbf19f1f.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-N6WMTTJ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>


<svg style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",t||(window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light")),document.documentElement.setAttribute("data-theme-choice",t||"system")}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/mlflow-website/docs/latest/"><div class="navbar__logo"><img src="/mlflow-website/docs/latest/images/logo-light.svg" alt="MLflow Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/mlflow-website/docs/latest/images/logo-dark.svg" alt="MLflow Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><div class="navbar__item dropdown dropdown--hoverable"><a href="#" aria-haspopup="true" aria-expanded="false" role="button" class="navbar__link docsDropdown_VGp6" data-active="genai"><div style="display:flex;gap:8px;align-items:center"><div class="dropdownCircle_n91F" style="width:10px;height:10px;background-color:var(--genai-color-primary);border-radius:4px"></div>GenAI Docs</div></a><ul class="dropdown__menu"><li><a class="dropdown__link ml-docs-link" href="/mlflow-website/docs/latest/ml/"><div style="display:flex;gap:8px;align-items:center"><div style="width:10px;height:10px;background-color:var(--ml-color-primary);border-radius:4px"></div>ML Docs</div></a></li><li><a aria-current="page" class="dropdown__link genai-docs-link dropdown__link--active" href="/mlflow-website/docs/latest/genai/"><div style="display:flex;gap:8px;align-items:center"><div style="width:10px;height:10px;background-color:var(--genai-color-primary);border-radius:4px"></div>GenAI Docs</div></a></li></ul></div><a href="https://mlflow.org/docs/latest/api_reference/index.html" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">API Reference</a><a class="navbar__item navbar__link" href="/mlflow-website/docs/latest/self-hosting/">Self-Hosting</a><a class="navbar__item navbar__link" href="/mlflow-website/docs/latest/community/">Community</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://github.com/mlflow/mlflow" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link github-link">GitHub<svg width="13.5" height="13.5" aria-label="(opens in new tab)" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search (Meta+k)" aria-keyshortcuts="Meta+k"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 24 24" aria-hidden="true"><circle cx="11" cy="11" r="8" stroke="currentColor" fill="none" stroke-width="1.4"></circle><path d="m21 21-4.3-4.3" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"></span></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item sidebar-top-level-category"><a class="menu__link" href="/mlflow-website/docs/latest/genai/"><span title="MLflow for GenAI" class="linkLabel_WmDU">MLflow for GenAI</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/mlflow-website/docs/latest/genai/mlflow-3/"><span title="MLflow 3.0" class="categoryLinkLabel_W154">MLflow 3.0</span></a><button aria-label="Expand sidebar category &#x27;MLflow 3.0&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/mlflow-website/docs/latest/genai/getting-started/"><span title="Getting Started" class="categoryLinkLabel_W154">Getting Started</span></a><button aria-label="Expand sidebar category &#x27;Getting Started&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/mlflow-website/docs/latest/genai/tracing/"><span title="Tracing (Observability)" class="categoryLinkLabel_W154">Tracing (Observability)</span></a><button aria-label="Expand sidebar category &#x27;Tracing (Observability)&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/mlflow-website/docs/latest/genai/eval-monitor/"><span title="Evaluate &amp; Monitor" class="categoryLinkLabel_W154">Evaluate &amp; Monitor</span></a><button aria-label="Expand sidebar category &#x27;Evaluate &amp; Monitor&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/mlflow-website/docs/latest/genai/prompt-registry/"><span title="Prompt Management" class="categoryLinkLabel_W154">Prompt Management</span></a><button aria-label="Expand sidebar category &#x27;Prompt Management&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item sidebar-top-level-category"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" href="/mlflow-website/docs/latest/genai/version-tracking/"><span title="Version Tracking" class="categoryLinkLabel_W154">Version Tracking</span></a><button aria-label="Collapse sidebar category &#x27;Version Tracking&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/mlflow-website/docs/latest/genai/version-tracking/quickstart/"><span title="Quickstart" class="linkLabel_WmDU">Quickstart</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" role="button" aria-expanded="true" tabindex="0" href="/mlflow-website/docs/latest/genai/version-tracking/track-application-versions-with-mlflow/"><span title="Guides" class="categoryLinkLabel_W154">Guides</span></a></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/mlflow-website/docs/latest/genai/version-tracking/track-application-versions-with-mlflow/"><span title="Track versions of Git-based applications with MLflow" class="linkLabel_WmDU">Track versions of Git-based applications with MLflow</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/mlflow-website/docs/latest/genai/version-tracking/compare-app-versions/"><span title="Compare App Versions" class="linkLabel_WmDU">Compare App Versions</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-3 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/mlflow-website/docs/latest/genai/flavors/"><span title="App Packaging &amp; Deployment" class="categoryLinkLabel_W154">App Packaging &amp; Deployment</span></a><button aria-label="Collapse sidebar category &#x27;App Packaging &amp; Deployment&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/mlflow-website/docs/latest/genai/flavors/openai/"><span title="OpenAI" class="categoryLinkLabel_W154">OpenAI</span></a><button aria-label="Collapse sidebar category &#x27;OpenAI&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/mlflow-website/docs/latest/genai/flavors/openai/guide/"><span title="Detailed Guide" class="linkLabel_WmDU">Detailed Guide</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-5 menu__list-item"><a class="menu__link" tabindex="0" href="/mlflow-website/docs/latest/genai/flavors/openai/autologging/"><span title="Autologging" class="linkLabel_WmDU">Autologging</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-5 menu__list-item"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--active" tabindex="0" href="/mlflow-website/docs/latest/genai/flavors/openai/notebooks/"><span title="Tutorials" class="categoryLinkLabel_W154">Tutorials</span></a><button aria-label="Collapse sidebar category &#x27;Tutorials&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/mlflow-website/docs/latest/genai/flavors/openai/notebooks/openai-quickstart/"><span title="OpenAI Quickstart" class="linkLabel_WmDU">OpenAI Quickstart</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/mlflow-website/docs/latest/genai/flavors/openai/notebooks/openai-chat-completions/"><span title="Chat Completions with OpenAI" class="linkLabel_WmDU">Chat Completions with OpenAI</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/mlflow-website/docs/latest/genai/flavors/openai/notebooks/openai-code-helper/"><span title="Building a Code Assistant with OpenAI &amp; MLflow" class="linkLabel_WmDU">Building a Code Assistant with OpenAI &amp; MLflow</span></a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-6 menu__list-item"><a class="menu__link" tabindex="0" href="/mlflow-website/docs/latest/genai/flavors/openai/notebooks/openai-embeddings-generation/"><span title="Embeddings Support with OpenAI in MLflow" class="linkLabel_WmDU">Embeddings Support with OpenAI in MLflow</span></a></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/mlflow-website/docs/latest/genai/flavors/dspy/"><span title="DSPy" class="categoryLinkLabel_W154">DSPy</span></a><button aria-label="Expand sidebar category &#x27;DSPy&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/mlflow-website/docs/latest/genai/flavors/langchain/"><span title="LangChain" class="categoryLinkLabel_W154">LangChain</span></a><button aria-label="Expand sidebar category &#x27;LangChain&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/mlflow-website/docs/latest/genai/flavors/llama-index/"><span title="LlamaIndex" class="categoryLinkLabel_W154">LlamaIndex</span></a><button aria-label="Expand sidebar category &#x27;LlamaIndex&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/mlflow-website/docs/latest/genai/flavors/custom-pyfunc-for-llms/"><span title="Custom Applications" class="categoryLinkLabel_W154">Custom Applications</span></a><button aria-label="Expand sidebar category &#x27;Custom Applications&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/mlflow-website/docs/latest/genai/flavors/chat-model-intro/"><span title="Intro to ChatModel" class="linkLabel_WmDU">Intro to ChatModel</span></a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-4 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" tabindex="0" href="/mlflow-website/docs/latest/genai/flavors/chat-model-guide/"><span title="Building with ChatModel" class="categoryLinkLabel_W154">Building with ChatModel</span></a><button aria-label="Expand sidebar category &#x27;Building with ChatModel&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-4 menu__list-item"><a class="menu__link" tabindex="0" href="/mlflow-website/docs/latest/genai/flavors/responses-agent-intro/"><span title="Building with ResponsesAgent" class="linkLabel_WmDU">Building with ResponsesAgent</span></a></li></ul></li></ul></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/mlflow-website/docs/latest/genai/mcp/"><span title="MCP" class="categoryLinkLabel_W154">MCP</span></a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/mlflow-website/docs/latest/genai/serving/"><span title="Model Serving" class="categoryLinkLabel_W154">Model Serving</span></a><button aria-label="Expand sidebar category &#x27;Model Serving&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist" href="/mlflow-website/docs/latest/genai/governance/ai-gateway/"><span title="Governance" class="categoryLinkLabel_W154">Governance</span></a><button aria-label="Expand sidebar category &#x27;Governance&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed sidebar-top-level-category"><div class="menu__list-item-collapsible"><a class="categoryLink_byQd menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/mlflow-website/docs/latest/genai/concepts/trace/"><span title="Concepts" class="categoryLinkLabel_W154">Concepts</span></a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/mlflow-website/docs/latest/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/mlflow-website/docs/latest/genai/version-tracking/"><span>Version Tracking</span></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Guides</span></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/mlflow-website/docs/latest/genai/flavors/"><span>App Packaging &amp; Deployment</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/mlflow-website/docs/latest/genai/flavors/openai/"><span>OpenAI</span></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/mlflow-website/docs/latest/genai/flavors/openai/notebooks/"><span>Tutorials</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Chat Completions with OpenAI</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Introduction: Advancing Communication with GPT-4 and MLflow</h1></header>
<a class="button button--primary" style="margin-bottom:1rem;display:block;width:min-content" href="https://raw.githubusercontent.com/mlflow/mlflow/master/docs/docs/genai/flavors/openai/notebooks/openai-chat-completions.ipynb" download="">Download this notebook</a>
<p>Welcome to our advanced tutorial, where we delve into the cutting-edge capabilities of OpenAI&#x27;s GPT-4, particularly exploring its Chat Completions feature. In this session, we will combine the advanced linguistic prowess of GPT-4 with the robust experiment tracking and deployment framework of MLflow to create an innovative application: The Text Message Angel.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="tutorial-overview">Tutorial Overview<a href="#tutorial-overview" class="hash-link" aria-label="Direct link to Tutorial Overview" title="Direct link to Tutorial Overview" translate="no">​</a></h3>
<p>In this tutorial, we will:</p>
<ol>
<li class="">
<p><strong>Set Up and Validate Environment</strong>: Ensure that all necessary configurations, including the <code>OPENAI_API_KEY</code>, are in place for our experiments.</p>
</li>
<li class="">
<p><strong>Initialize MLflow Experiment</strong>: Set up an MLflow experiment named &quot;Text Message Angel&quot; to track and manage our model&#x27;s performance and outcomes.</p>
</li>
<li class="">
<p><strong>Implement Chat Completions with GPT-4</strong>: Utilize the Chat Completions task of GPT-4 to develop an application that can analyze and respond to text messages. This feature of GPT-4 allows for context-aware, conversational AI applications that can understand and generate human-like text responses.</p>
</li>
<li class="">
<p><strong>Model Deployment and Prediction</strong>: Deploy our model using MLflow&#x27;s <code>pyfunc</code> implementation and make predictions on a set of sample text messages. This will demonstrate the practical application of our model in real-world scenarios.</p>
</li>
</ol>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="the-text-message-angel-application">The Text Message Angel Application<a href="#the-text-message-angel-application" class="hash-link" aria-label="Direct link to The Text Message Angel Application" title="Direct link to The Text Message Angel Application" translate="no">​</a></h3>
<p>Our application, the Text Message Angel, aims to enhance everyday text communication. It will analyze SMS responses for tone, appropriateness, and relationship impact. The model will categorize responses as either appropriate (&quot;Good to Go!&quot;) or suggest caution (&quot;You might want to read that again before pressing send&quot;). For responses deemed inappropriate, it will also suggest alternative phrasing that maintains a friendly yet witty tone.</p>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="why-gpt-4-and-mlflow">Why GPT-4 and MLflow?<a href="#why-gpt-4-and-mlflow" class="hash-link" aria-label="Direct link to Why GPT-4 and MLflow?" title="Direct link to Why GPT-4 and MLflow?" translate="no">​</a></h3>
<ul>
<li class="">
<p><strong>GPT-4&#x27;s Advanced AI</strong>: GPT-4 represents the latest in AI language model development, offering nuanced understanding and response generation capabilities that are ideal for a text-based application like the Text Message Angel.</p>
</li>
<li class="">
<p><strong>MLflow&#x27;s Seamless Management</strong>: MLflow simplifies the process of tracking experiments, managing different model versions, and deploying AI models. Its integration with GPT-4 allows us to focus on the creative aspect of our application while efficiently handling the technicalities of model management.</p>
</li>
</ul>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="engaging-with-the-tutorial">Engaging with the Tutorial<a href="#engaging-with-the-tutorial" class="hash-link" aria-label="Direct link to Engaging with the Tutorial" title="Direct link to Engaging with the Tutorial" translate="no">​</a></h3>
<p>As we progress, we encourage you to actively engage with the code and concepts presented. This tutorial is not just about learning the functionalities but also understanding the potential of these technologies when combined creatively.</p>
<p>Let&#x27;s embark on this journey to harness the synergy of MLflow and GPT-4&#x27;s Chat Completions to enhance communication and interactions in our digital world.</p>
<div style="flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%"><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> warnings</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Disable a few less-than-useful UserWarnings from setuptools and pydantic</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">warnings</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">filterwarnings</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;ignore&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> category</span><span class="token operator">=</span><span class="token plain">UserWarning</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div></div>
<div style="flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%"><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> os</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> openai</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> pandas </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">as</span><span class="token plain"> pd</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> IPython</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">display </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> HTML</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> mlflow</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">models</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">signature </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> ModelSignature</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">from</span><span class="token plain"> mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">types</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">schema </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">import</span><span class="token plain"> ColSpec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> ParamSchema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> ParamSpec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> Schema</span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token comment" style="color:rgb(98, 114, 164)"># Run a quick validation that we have an entry for the OPEN_API_KEY within environment variables</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">assert</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;OPENAI_API_KEY&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> os</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">environ</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;OPENAI_API_KEY environment variable must be set&quot;</span><br></span></code></pre></div></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="implementing-the-text-message-angel-with-gpt-4-and-chat-completions">Implementing the Text Message Angel with GPT-4 and Chat Completions<a href="#implementing-the-text-message-angel-with-gpt-4-and-chat-completions" class="hash-link" aria-label="Direct link to Implementing the Text Message Angel with GPT-4 and Chat Completions" title="Direct link to Implementing the Text Message Angel with GPT-4 and Chat Completions" translate="no">​</a></h3>
<p>After exploring the humorous world of misheard lyrics in the introductory tutorial to the <code>openai</code> flavor, we now shift our focus to a more sophisticated application involving GPT-4 and the Chat Completions feature. This tutorial introduces the &quot;Text Message Angel&quot;, an innovative application designed to pre-screen text messages, ensuring they are appropriate and relationship-friendly, especially for those inclined towards sarcasm.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="setting-up-the-text-message-angel-experiment">Setting Up the Text Message Angel Experiment<a href="#setting-up-the-text-message-angel-experiment" class="hash-link" aria-label="Direct link to Setting Up the Text Message Angel Experiment" title="Direct link to Setting Up the Text Message Angel Experiment" translate="no">​</a></h4>
<p>We begin by setting up a new MLflow experiment titled &quot;Text Message Angel&quot;. This experiment aims to create a service that analyzes text messages and provides guidance on their appropriateness before sending. The goal is to maintain positive communication while allowing for a playful tone.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="the-role-of-gpt-4-and-chat-completions">The Role of GPT-4 and Chat Completions<a href="#the-role-of-gpt-4-and-chat-completions" class="hash-link" aria-label="Direct link to The Role of GPT-4 and Chat Completions" title="Direct link to The Role of GPT-4 and Chat Completions" translate="no">​</a></h4>
<p>GPT-4 represents a massive leap in capability compared with the previous model we used in the introductory tutorial. It brings enhanced understanding and contextual awareness, making it ideal for interpreting and responding to natural language with a high degree of accuracy and nuance. The Chat Completions feature, specifically, enables a more conversational approach, which is perfect for our text message evaluation scenario.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="crafting-the-prompt-for-text-message-evaluation">Crafting the Prompt for Text Message Evaluation<a href="#crafting-the-prompt-for-text-message-evaluation" class="hash-link" aria-label="Direct link to Crafting the Prompt for Text Message Evaluation" title="Direct link to Crafting the Prompt for Text Message Evaluation" translate="no">​</a></h4>
<p>The core of our application is a well-crafted prompt that directs GPT-4 to evaluate text messages based on specific criteria:</p>
<ul>
<li class=""><strong>Content Analysis</strong>: The model determines if a message contains inappropriate elements like humorless sarcasm, passive-aggressive tones, or anything that could harm a relationship.</li>
<li class=""><strong>Response Categorization</strong>: Based on its analysis, the model categorizes the message as either &quot;Good to Go!&quot; or advises to &quot;read that again before pressing send.&quot;</li>
<li class=""><strong>Suggested Corrections</strong>: If a message is deemed inappropriate, the model goes a step further to suggest an alternative version. This corrected message aims to preserve a fun and slightly snarky tone while ensuring it does not harm the relationship.</li>
</ul>
<p>This setup not only demonstrates the advanced capabilities of GPT-4 in understanding and generating human-like text but also highlights its potential for practical applications in everyday communication scenarios.</p>
<div style="flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%"><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">set_experiment</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Text Message Angel&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">messages </span><span class="token operator">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;role&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;user&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;content&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Determine if this is an acceptable response to a friend through SMS. &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;If the response contains humorless sarcasm, a passive aggressive tone, or could potentially &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;damage my relationship with them, please respond with &#x27;You might want to read that again before &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;pressing send.&#x27;, otherwise respond with &#x27;Good to Go!&#x27;. If the response classifies as inappropriate, &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;please suggest a corrected version following the classification that will help to keep my &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;relationship with this person intact, yet still maintains a fun and somewhat snarky tone: {text}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><br></span></code></pre></div></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="integrating-gpt-4-with-mlflow-for-the-text-message-angel">Integrating GPT-4 with MLflow for the Text Message Angel<a href="#integrating-gpt-4-with-mlflow-for-the-text-message-angel" class="hash-link" aria-label="Direct link to Integrating GPT-4 with MLflow for the Text Message Angel" title="Direct link to Integrating GPT-4 with MLflow for the Text Message Angel" translate="no">​</a></h3>
<p>In this crucial step, we&#x27;re integrating the advanced GPT-4 model with MLflow for our <code>Text Message Angel</code> application. This process involves setting up the model within an MLflow run, logging its configuration, and preparing it for practical use.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="starting-the-mlflow-run">Starting the MLflow Run<a href="#starting-the-mlflow-run" class="hash-link" aria-label="Direct link to Starting the MLflow Run" title="Direct link to Starting the MLflow Run" translate="no">​</a></h4>
<p>We initiate an MLflow run, a crucial step in tracking our model&#x27;s performance, parameters, and outputs. This run encapsulates all the details and metrics related to the GPT-4 model we are using.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="logging-the-gpt-4-model-in-mlflow">Logging the GPT-4 Model in MLflow<a href="#logging-the-gpt-4-model-in-mlflow" class="hash-link" aria-label="Direct link to Logging the GPT-4 Model in MLflow" title="Direct link to Logging the GPT-4 Model in MLflow" translate="no">​</a></h4>
<p>Within this run, we log our GPT-4 model using <code>mlflow.openai.log_model</code>. This function call is instrumental in registering our model&#x27;s specifics in MLflow&#x27;s tracking system. Here&#x27;s a breakdown of the parameters we&#x27;re logging:</p>
<ul>
<li class=""><strong>Model Selection</strong>: We specify <code>gpt-4</code>, indicating we are utilizing a far more advanced version of OpenAI&#x27;s models than the previous example.</li>
<li class=""><strong>Task Specification</strong>: The <code>openai.chat.completions</code> task is chosen, aligning with our objective of creating a conversational AI capable of analyzing and responding to text messages.</li>
<li class=""><strong>Artifact Path</strong>: We define an artifact path where MLflow will store the model-related data.</li>
<li class=""><strong>Messages</strong>: The <code>messages</code> variable, containing our pre-defined prompt and criteria for evaluating text messages, is passed to the model.</li>
<li class=""><strong>Model Signature</strong>: The signature defines the input-output schema and parameters for our model, such as <code>max_tokens</code> and <code>temperature</code>. These settings are crucial in controlling how the model generates responses.</li>
</ul>
<div style="flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%"><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">with</span><span class="token plain"> mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">start_run</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  model_info </span><span class="token operator">=</span><span class="token plain"> mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">openai</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">log_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      model</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;gpt-4&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      task</span><span class="token operator">=</span><span class="token plain">openai</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">chat</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">completions</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      name</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;model&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      messages</span><span class="token operator">=</span><span class="token plain">messages</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      signature</span><span class="token operator">=</span><span class="token plain">ModelSignature</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          inputs</span><span class="token operator">=</span><span class="token plain">Schema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">ColSpec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token builtin" style="color:rgb(189, 147, 249)">type</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;string&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> name</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          outputs</span><span class="token operator">=</span><span class="token plain">Schema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain">ColSpec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token builtin" style="color:rgb(189, 147, 249)">type</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;string&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> name</span><span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          params</span><span class="token operator">=</span><span class="token plain">ParamSchema</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                  ParamSpec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">name</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;max_tokens&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> default</span><span class="token operator">=</span><span class="token number">16</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> dtype</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;long&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">                  ParamSpec</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">name</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;temperature&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> default</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> dtype</span><span class="token operator">=</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;float&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">              </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div></div>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="loading-the-model-for-use">Loading the Model for Use<a href="#loading-the-model-for-use" class="hash-link" aria-label="Direct link to Loading the Model for Use" title="Direct link to Loading the Model for Use" translate="no">​</a></h4>
<p>After logging the model in MLflow, we load it as a generic Python function using <code>mlflow.pyfunc.load_model</code>. This step is vital as it transforms our GPT-4 model into a format that&#x27;s easily callable and usable within our application.</p>
<div style="flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%"><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">model </span><span class="token operator">=</span><span class="token plain"> mlflow</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">pyfunc</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">load_model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">model_info</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">model_uri</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="testing-the-text-message-angel">Testing the Text Message Angel<a href="#testing-the-text-message-angel" class="hash-link" aria-label="Direct link to Testing the Text Message Angel" title="Direct link to Testing the Text Message Angel" translate="no">​</a></h3>
<p>With our Text Message Angel application powered by GPT-4 and integrated within MLflow, we are now ready to put it to the test. This section involves creating a set of sample text messages, some potentially containing sarcasm or passive-aggressive tones, and others being more straightforward and friendly.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="creating-validation-data">Creating Validation Data<a href="#creating-validation-data" class="hash-link" aria-label="Direct link to Creating Validation Data" title="Direct link to Creating Validation Data" translate="no">​</a></h4>
<p>We start by creating a DataFrame named <code>validation_data</code> with a variety of text messages. These messages are designed to test the model&#x27;s ability to discern tone and suggest corrections where necessary:</p>
<ol>
<li class="">A message using humor to mask a critique of a dinner experience.</li>
<li class="">A sarcastic comment expressing reluctance to go to the movies.</li>
<li class="">A straightforward message expressing excitement for a road trip.</li>
<li class="">A simple thank-you message.</li>
<li class="">A sarcastic remark about enjoying someone&#x27;s singing.</li>
</ol>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="submitting-messages-to-the-model">Submitting Messages to the Model<a href="#submitting-messages-to-the-model" class="hash-link" aria-label="Direct link to Submitting Messages to the Model" title="Direct link to Submitting Messages to the Model" translate="no">​</a></h4>
<p>Next, we submit these messages to our Text Message Angel model for evaluation. The model will analyze each message, determining whether it&#x27;s appropriate or needs a revision. For messages that might strain a relationship, the model will suggest a more suitable version.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="displaying-the-models-responses">Displaying the Model&#x27;s Responses<a href="#displaying-the-models-responses" class="hash-link" aria-label="Direct link to Displaying the Model&#x27;s Responses" title="Direct link to Displaying the Model&#x27;s Responses" translate="no">​</a></h4>
<p>The responses from the model are then formatted for clear and attractive display. This step is crucial for assessing the model&#x27;s performance in real-time and understanding how its corrections and suggestions align with the intended tone of the messages.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="models-output">Model&#x27;s Output<a href="#models-output" class="hash-link" aria-label="Direct link to Model&#x27;s Output" title="Direct link to Model&#x27;s Output" translate="no">​</a></h4>
<p>Let&#x27;s take a look at how the Text Message Angel responded:</p>
<ol>
<li class="">Suggested a more tactful way to comment on the dinner.</li>
<li class="">Offered a humorous yet softer alternative for declining a movie invitation.</li>
<li class="">Confirmed that the road trip message is appropriate.</li>
<li class="">Validated the thank-you message as suitable.</li>
<li class="">Suggested a playful yet kinder remark about singing.</li>
</ol>
<p>These responses showcase the model&#x27;s nuanced understanding of social communication, its ability to maintain a friendly yet fun tone, and its potential in assisting users to communicate more effectively and harmoniously.</p>
<div style="flex-grow:1;min-width:0;margin-top:var(--padding-md);width:100%"><div class="codeBlock_oJcR language-python codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#F8F8F2;--prism-background-color:#282A36"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-python codeBlock_bY9V thin-scrollbar" style="color:#F8F8F2;background-color:#282A36"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#F8F8F2"><span class="token plain">validation_data </span><span class="token operator">=</span><span class="token plain"> pd</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">DataFrame</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;text&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Wow, what an interesting dinner last night! I had no idea that you could use canned &quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;cat food to make a meatloaf.&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;I&#x27;d rather book a 14th century surgical operation than go to the movies with you on Thursday.&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Can&#x27;t wait for the roadtrip this weekend! Love the playlist mixes that you choose!&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;Thanks for helping out with the move this weekend. I really appreciate it.&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">          </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;You know what part I love most when you sing? The end. It means its over.&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">      </span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">chat_completions_response </span><span class="token operator">=</span><span class="token plain"> model</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">predict</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  validation_data</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> params</span><span class="token operator">=</span><span class="token punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string" style="color:rgb(255, 121, 198)">&quot;max_tokens&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">50</span><span class="token punctuation" style="color:rgb(248, 248, 242)">,</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;temperature&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">:</span><span class="token plain"> </span><span class="token number">0.2</span><span class="token punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">formatted_output </span><span class="token operator">=</span><span class="token plain"> </span><span class="token string" style="color:rgb(255, 121, 198)">&quot;&lt;br&gt;&quot;</span><span class="token punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token plain">join</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">  </span><span class="token punctuation" style="color:rgb(248, 248, 242)">[</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">f&quot;&lt;p&gt;&lt;strong&gt;</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">{</span><span class="token string-interpolation interpolation">line</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">.</span><span class="token string-interpolation interpolation">strip</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token string-interpolation interpolation punctuation" style="color:rgb(248, 248, 242)">}</span><span class="token string-interpolation string" style="color:rgb(255, 121, 198)">&lt;/strong&gt;&lt;/p&gt;&quot;</span><span class="token plain"> </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">for</span><span class="token plain"> line </span><span class="token keyword" style="color:rgb(189, 147, 249);font-style:italic">in</span><span class="token plain"> chat_completions_response</span><span class="token punctuation" style="color:rgb(248, 248, 242)">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain"></span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#F8F8F2"><span class="token plain">display</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">HTML</span><span class="token punctuation" style="color:rgb(248, 248, 242)">(</span><span class="token plain">formatted_output</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><span class="token punctuation" style="color:rgb(248, 248, 242)">)</span><br></span></code></pre></div></div></div>
<div style="flex-grow:1;min-width:0;font-size:0.8rem;width:100%"><div><p><strong>You might want to read that again before pressing send.

Suggested response: "Wow, dinner last night was certainly unique! Who knew meatloaf could be so... adventurous?"</strong></p><br><p><strong>You might want to read that again before pressing send.

Suggested correction: "I'd rather watch a 14th century surgical operation documentary than miss out on the movies with you on Thursday. How's that for a plot twist?"</strong></p><br><p><strong>Good to Go!</strong></p><br><p><strong>Good to Go!</strong></p><br><p><strong>You might want to read that again before pressing send.

Suggested response: "You know what part I love most when you sing? The encore. It means I get to hear you again!"</strong></p></div></div>
<h3 class="anchor anchorTargetStickyNavbar_Vzrq" id="conclusion-advancing-ai-interactions-with-mlflow-and-openais-gpt-4">Conclusion: Advancing AI Interactions with MLflow and OpenAI&#x27;s GPT-4<a href="#conclusion-advancing-ai-interactions-with-mlflow-and-openais-gpt-4" class="hash-link" aria-label="Direct link to Conclusion: Advancing AI Interactions with MLflow and OpenAI&#x27;s GPT-4" title="Direct link to Conclusion: Advancing AI Interactions with MLflow and OpenAI&#x27;s GPT-4" translate="no">​</a></h3>
<p>As we reach the end of this tutorial, it&#x27;s time to reflect on the insights we&#x27;ve gained, especially the remarkable capabilities of GPT-4 in the realm of conversational AI, and how MLflow facilitates the deployment and management of these advanced models.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="key-takeaways">Key Takeaways<a href="#key-takeaways" class="hash-link" aria-label="Direct link to Key Takeaways" title="Direct link to Key Takeaways" translate="no">​</a></h4>
<ul>
<li class="">
<p><strong>Deep Dive into ChatCompletions with GPT-4</strong>: This tutorial gave us a hands-on experience with GPT-4&#x27;s ChatCompletions feature, demonstrating its ability to understand context, maintain conversation flow, and generate human-like responses. The <code>Text Message Angel</code> application exemplified how such a model can be used to improve and refine everyday communication.</p>
</li>
<li class="">
<p><strong>MLflow&#x27;s Role in Managing Advanced AI</strong>: MLflow has shown its strength not just in handling model logistics, but also in simplifying the experimentation with complex AI models like GPT-4. Its robust tracking and logging capabilities make it easier to manage and iterate over conversational AI models.</p>
</li>
<li class="">
<p><strong>Real-World Application and Potential</strong>: The <code>Text Message Angel</code> illustrated a practical application of GPT-4&#x27;s advanced capabilities, demonstrating how AI can be leveraged to enhance and safeguard interpersonal communication. It&#x27;s a glimpse into how conversational AI can be used in customer service, mental health, education, and other domains.</p>
</li>
<li class="">
<p><strong>The Evolution of AI and MLflow&#x27;s Adaptability</strong>: The tutorial highlighted how MLflow&#x27;s flexible framework is well-suited to keep pace with the rapid advancements in AI, particularly in areas like natural language processing and conversational AI.</p>
</li>
</ul>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="moving-forward-with-conversational-ai">Moving Forward with Conversational AI<a href="#moving-forward-with-conversational-ai" class="hash-link" aria-label="Direct link to Moving Forward with Conversational AI" title="Direct link to Moving Forward with Conversational AI" translate="no">​</a></h4>
<p>The combination of MLflow and OpenAI&#x27;s GPT-4 opens up exciting avenues for developing more intuitive and responsive AI-driven applications. As we continue to witness advancements in AI, MLflow&#x27;s ability to adapt and manage these complex models becomes increasingly vital.</p>
<h4 class="anchor anchorTargetStickyNavbar_Vzrq" id="embarking-on-your-ai-journey">Embarking on Your AI Journey<a href="#embarking-on-your-ai-journey" class="hash-link" aria-label="Direct link to Embarking on Your AI Journey" title="Direct link to Embarking on Your AI Journey" translate="no">​</a></h4>
<p>We encourage you to build upon the foundations laid in this tutorial to explore the vast potential of conversational AI. With MLflow and OpenAI&#x27;s GPT-4, you are well-equipped to create innovative applications that can converse, understand, and interact in more human-like ways.</p>
<p>Thank you for joining us in exploring the cutting-edge of conversational AI and model management. Your journey into developing AI-enhanced communication tools is just beginning, and we are excited to see where your creativity and skills will lead you next!</p>
<p>To continue your learning journey, see the additional <a href="https://www.mlflow.org/docs/latest/genai/flavors/openai/index.html#advanced-tutorials" target="_blank" rel="noopener noreferrer" class="">advanced tutorials for MLflow&#x27;s OpenAI flavor</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col noPrint_WFHX"><a href="https://github.com/mlflow/mlflow/edit/master/docs/docs/genai/flavors/openai/notebooks/openai-chat-completions.ipynb" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/mlflow-website/docs/latest/genai/flavors/openai/notebooks/openai-quickstart/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">OpenAI Quickstart</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/mlflow-website/docs/latest/genai/flavors/openai/notebooks/openai-code-helper/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Building a Code Assistant with OpenAI &amp; MLflow</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#tutorial-overview" class="table-of-contents__link toc-highlight">Tutorial Overview</a></li><li><a href="#the-text-message-angel-application" class="table-of-contents__link toc-highlight">The Text Message Angel Application</a></li><li><a href="#why-gpt-4-and-mlflow" class="table-of-contents__link toc-highlight">Why GPT-4 and MLflow?</a></li><li><a href="#engaging-with-the-tutorial" class="table-of-contents__link toc-highlight">Engaging with the Tutorial</a></li><li><a href="#implementing-the-text-message-angel-with-gpt-4-and-chat-completions" class="table-of-contents__link toc-highlight">Implementing the Text Message Angel with GPT-4 and Chat Completions</a></li><li><a href="#integrating-gpt-4-with-mlflow-for-the-text-message-angel" class="table-of-contents__link toc-highlight">Integrating GPT-4 with MLflow for the Text Message Angel</a></li><li><a href="#testing-the-text-message-angel" class="table-of-contents__link toc-highlight">Testing the Text Message Angel</a></li><li><a href="#conclusion-advancing-ai-interactions-with-mlflow-and-openais-gpt-4" class="table-of-contents__link toc-highlight">Conclusion: Advancing AI Interactions with MLflow and OpenAI&#39;s GPT-4</a></li></ul></div></div></div></div></main></div></div></div><footer class="relative pb-30 flex flex-col pt-30 bg-bottom bg-no-repeat bg-cover bg-size-[auto_360px] 2xl:bg-size-[100%_360px] bg-brand-black"><div style="position:absolute;width:100%;bottom:0;pointer-events:none;mask-composite:intersect;height:360px;background-image:repeating-linear-gradient(
        to right,
        rgba(0, 0, 0, 0.05),
        rgba(0, 0, 0, 0.25) 18px,
        transparent 2px,
        transparent 10px
      ),
      radial-gradient(
        circle at bottom center,
        oklch(0.6 0.22 30.59) 0%,
        transparent 60%
      ),
      linear-gradient(to right, color-mix(in srgb, oklch(0.6 0.22 30.59), black 10%), color-mix(in srgb, oklch(0.6 0.22 30.59), oklch(0.91 0.09 326.28) 40%));mask-image:radial-gradient(ellipse at center bottom, black 60%, transparent 80%),
      linear-gradient(to top, black 10%, transparent 40%)"></div><div class="z-1"><div class="flex flex-row justify-between items-start md:items-center px-6 lg:px-20 gap-10 xs:gap-0 max-w-container"><div class="flex flex-col gap-8"><svg xmlns="http://www.w3.org/2000/svg" width="109" height="40" fill="none" viewBox="0 0 109 40" class="h-[36px] shrink-0"><path fill="#fff" d="M0 31.032v-15.53h3.543v1.968c.893-1.594 2.84-2.425 4.593-2.425 2.042 0 3.828.926 4.658 2.745 1.216-2.043 3.034-2.745 5.043-2.745 2.81 0 5.49 1.787 5.49 5.904v10.083h-3.574v-9.478c0-1.818-.926-3.19-3-3.19-1.947 0-3.224 1.53-3.224 3.445v9.22H9.893v-9.475c0-1.786-.898-3.18-3.003-3.18-1.977 0-3.223 1.467-3.223 3.444v9.221ZM27.855 31.032V7.929h3.703v23.103ZM30.07 39.487c.833.232 1.582.383 3.17.383 2.953 0 6.436-1.665 7.353-6.339l3.786-18.739h5.629l.687-3.117h-5.686l.765-3.725c.586-2.892 2.186-4.358 4.754-4.358.668 0 .48.058 1.076.17L52.427.57c-.793-.237-1.503-.379-3.049-.379a7.32 7.32 0 0 0-4.528 1.484c-1.441 1.114-2.393 2.75-2.827 4.863l-1.066 5.137h-5.034l-.411 3.12h4.823L36.859 32.12c-.383 1.965-1.5 4.315-4.708 4.315-.727 0-.463-.055-1.121-.162ZM53.342 30.905H49.64l5.074-23.309h3.701ZM71.807 16.477A7.962 7.962 0 0 0 60.97 27.904l2.425-1.78a5.005 5.005 0 0 1 3.845-8.145v1.895ZM62.618 29.472a7.962 7.962 0 0 0 10.836-11.428l-2.425 1.78a5.005 5.005 0 0 1-3.845 8.145v-1.894ZM78.092 15.493h4.044l.823 10.612 5.759-10.612 3.839.055 1.508 10.557 5.074-10.612 3.701.055-7.678 15.493H91.46l-1.783-11.106-5.895 11.106h-3.84ZM105.072 15.768h-.766v-.266h1.845v.272h-.765v2.243h-.314ZM106.614 15.502h.383l.482 1.34q.091.259.178.524h.018c.059-.176.113-.352.172-.524l.478-1.34h.383v2.515h-.298V16.63c0-.22.024-.523.04-.747h-.016l-.191.574-.475 1.304h-.208l-.481-1.302-.191-.574h-.015c.017.224.042.527.042.747v1.387h-.291Z"></path></svg><div class="text-xs text-left md:text-nowrap md:w-0">© 2025 MLflow Project, a Series of LF Projects, LLC.</div></div><div class="flex flex-col flex-wrap justify-end md:text-right md:flex-row gap-x-10 lg:gap-x-20 gap-y-5 w-2/5 md:w-auto md:pt-2 max-w-fit"><div><a href="https://mlflow.org" target="_blank" rel="noopener noreferrer" class="text-[15px] font-medium no-underline hover:no-underline transition-opacity hover:opacity-80 text-white visited:text-white">Components</a></div><div><a href="https://mlflow.org/releases" target="_blank" rel="noopener noreferrer" class="text-[15px] font-medium no-underline hover:no-underline transition-opacity hover:opacity-80 text-white visited:text-white">Releases</a></div><div><a href="https://mlflow.org/blog" target="_blank" rel="noopener noreferrer" class="text-[15px] font-medium no-underline hover:no-underline transition-opacity hover:opacity-80 text-white visited:text-white">Blog</a></div><div><a class="text-[15px] font-medium no-underline hover:no-underline transition-opacity hover:opacity-80 text-white visited:text-white" href="/mlflow-website/docs/latest/">Docs</a></div><div><a href="https://mlflow.org/ambassadors" target="_blank" rel="noopener noreferrer" class="text-[15px] font-medium no-underline hover:no-underline transition-opacity hover:opacity-80 text-white visited:text-white">Ambassador Program</a></div></div></div></div></footer></div>
</body>
</html>